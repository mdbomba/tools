<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<!-- prior comment allows JS to execute on IE when saved as a local file, "MOTW" -->
<html lang="en">
  <head>
    <title>Chef InSpec Results</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style type="text/css">
    /* Must inline all CSS files, this is a single-file output that may be airgapped */
    body {
  margin: 20px 10% 20px 10%;
  padding: 0;
  background: #fff;
}
h1, h2, h3, h4, h5 {
  font-family: "Lucida Grande", Helvetica, sans-serif;
}
h1, h2 {
  padding: 10px;
  text-align: center
}
table.info th, table.info th {
  padding: 2px;
}
table.info th {
  text-align: right;
}
.hidden {
  display: none;
}
pre code {
  background-color: #eee;
  border: 1px solid #999;
  display: block;
  padding: 20px;
}

.profile, .control, .profile-metadata {
  border: 1px solid #ccc;
  padding: 10px;
  margin: 5px auto;
}

.resource-title {
  margin-left: 2.5%;
}

.control-title code,
.resource-title code {
  font-size: larger;
}
.control-metadata .status div,
.result-metadata .status div {
  color: white;
  font-weight: bold;
  width: fit-content;
  padding: 0px 2px;
}

.control-metadata .status-passed div,
.result-metadata .status-passed div  {
  background-color: darkgreen;
}
.control-metadata .status-failed div,
.result-metadata .status-failed div {
  background-color: red;
}
.control-metadata .status-skipped div,
.result-metadata .status-skipped div  {
  background-color: grey;
}
.control-metadata .status-error div,
.result-metadata .status-error div  {
  background-color: rgb(63, 15, 183);
}
.control-metadata .status-not_applicable div,
.result-metadata .status-not_applicable div  {
  background-color: rgb(135, 206, 250);
}
.control-metadata .status-not_reviewed div,
.result-metadata .status-not_reviewed div  {
  background-color: rgb(255, 194, 0);
}
.result-metadata,
.control-metadata {
  margin: 0 0 0 5%;
}

.selector-panel {
  position: fixed;
  z-index: 100;
  background-color: #ccc;
  padding: 10px;
  top: 0;
  margin-left: -10%;
  border-bottom-right-radius: 10px;
}

@media print {
  .selector-panel {
     visibility: hidden;
  }
}

.inspec-summary {
  border: 1px solid #ccc;
  padding: 10px;
  margin: 5px auto;
  width: fit-content
}

.inspec-summary h4 {
  margin-bottom: 0px;
}

.inspec-summary #platform, .inspec-summary #statistics {
  display: inline;
}

#statistics .date td {
  width: 100px
}

#inspec-version {
  display: block;
  text-align: center;
  font-style: italic;
}

    </style>
    <script type="text/javascript">
    // <![CDATA[
    /* Must inline all JavaScript files, this is a single-file output that may be airgapped */
    
/* CSS primitives */
function addCssClass(id, cls) {
  document.getElementById(id).className += (" " + cls);
}

function removeCssClass(id, cls) {
  var el = document.getElementById(id);
  var classes = el.className.replace(cls,'');
  el.className = classes;
}

function handleShowSource(evt) {
  var slugged_id = evt.srcElement.id.replace("show-code-", "")
  addCssClass(evt.srcElement.id, "hidden")
  removeCssClass("hide-code-" + slugged_id, "hidden")
  removeCssClass("source-code-" + slugged_id, "hidden")
}

function handleHideSource(evt) {
  var slugged_id = evt.srcElement.id.replace("hide-code-", "")
  addCssClass(evt.srcElement.id, "hidden")
  addCssClass("source-code-" + slugged_id, "hidden")
  removeCssClass("show-code-" + slugged_id, "hidden")
}

function handleSelectorChange(evt) {
  var should_show = evt.srcElement.checked
  var which_group = evt.srcElement.id.replace("-checkbox","")
  var controls = document.getElementsByClassName("control-status-" + which_group)
  var i;
  if (should_show) {
    for (i = 0; i < controls.length; i++) {
      removeCssClass(controls[i].id, "hidden")
    }
  } else {
    for (i = 0; i < controls.length; i++) {
      addCssClass(controls[i].id, "hidden")
    }
  }
}

function handleChildProfileChange(evt) {
  var should_show = evt.srcElement.checked
  var child_profiles = document.getElementsByClassName("child-profile")
  var i;
  if (should_show) {
    for (i = 0; i < child_profiles.length; i++) {
      removeCssClass(child_profiles[i].id, "hidden")
    }
  } else {
    for (i = 0; i < child_profiles.length; i++) {
      addCssClass(child_profiles[i].id, "hidden")
    }
  }
}

/* Main entry point */
function  pageLoaded() {
  var i;

  // wire up show source links
  var show_links = document.getElementsByClassName("show-source-code");
  for (i = 0; i < show_links.length; i++) {
    show_links[i].onclick = handleShowSource;
  }
  // wire up hide source links
  var hide_links = document.getElementsByClassName("hide-source-code");
  for (i = 0; i < hide_links.length; i++) {
    hide_links[i].onclick = handleHideSource;
  }
  // wire up selector checkboxes
  var selectors = document.getElementsByClassName("selector-checkbox");
  for (i = 0; i < selectors.length; i++) {
    selectors[i].onchange = handleSelectorChange;
  }
  // wire up child profile checkbox
  document.getElementById("child-profile-checkbox").onchange = handleChildProfileChange;
}

    // ]]>
    </script>
  </head>
  <body onload="pageLoaded()">
    <div class="selector-panel">
  <p id="selector-instructions">Display controls that are:</p>
  <input class="selector-checkbox" id="passed-checkbox" type="checkbox" checked="checked"/><label for="passed-checkbox">Passed</label>
  <input class="selector-checkbox" id="failed-checkbox" type="checkbox" checked="checked"/><label for="failed-checkbox">Failed</label>
  
    <input class="selector-checkbox" id="skipped-checkbox" type="checkbox" checked="checked"/><label for="skipped-checkbox">Skipped</label>
  
  <p id="selector-instructions">Display profiles that are:</p>
  <input class="profile-selector-checkbox" id="child-profile-checkbox" type="checkbox" /><label for="child-profile-checkbox">Dependent Profiles</label>
</div>

    <div class="inspec-report">
    <h1>Chef InSpec Report</h1>
    
      <div class="profile " id="profile-stig-canonicalubuntu20.04lts-cationly">
  
  <h2 class="profile_title">Profile Canonical Ubuntu 20.04 LTS Security Technical Implementation Guide CAT I Only (stig-canonicalubuntu20.04lts-cationly)</h2>

  <table class="profile-metadata info" id="profile-metadata-stig-canonicalubuntu20.04lts-cationly">
  <caption>Profile Information Table</caption>
    <tr class="profile-version"><th>Version:</th><td>1.2.0-1</td></tr>
    
    <tr class="profile-summary"><th>Summary:</th><td>Canonical Ubuntu 20.04 LTS Security Technical Implementation Guide CAT I Only translated from SCAP</td></tr>
    
    
    
  </table>

  
    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238200r653775_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238200r653775_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238200r653775_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must allow users to directly initiate a session lock for all connection types.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not want to log out because of the temporary nature of the absence.

The session lock is implemented at the point where session activity can be determined. Rather than be forced to wait for a period of time to expire before the user session can be locked, the Ubuntu operating systems need to provide users with the ability to manually invoke a session lock so users may secure their session if they need to temporarily vacate the immediate physical vicinity.

Satisfies: SRG-OS-000030-GPOS-00011, SRG-OS-000031-GPOS-00012

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000060</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AC-11 (1)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238200r653775_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238200r653775_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238200r653775_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238200r653775_rule" do
  title "The Ubuntu operating system must allow users to directly initiate a session lock for all connection types."
  desc  "
    Vulnerability Discussion: A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not want to log out because of the temporary nature of the absence.
    
    The session lock is implemented at the point where session activity can be determined. Rather than be forced to wait for a period of time to expire before the user session can be locked, the Ubuntu operating systems need to provide users with the ability to manually invoke a session lock so users may secure their session if they need to temporarily vacate the immediate physical vicinity.
    
    Satisfies: SRG-OS-000030-GPOS-00011, SRG-OS-000031-GPOS-00012
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000058"
  tag nist: ["NIST SP 800-53", "3", "AC-11 a"]
  tag nist: ["NIST SP 800-53A", "1", "AC-11"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-11 a"]
  tag cci: "CCI-000060"
  tag nist: ["NIST SP 800-53", "3", "AC-11 (1)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-11 (1).1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-11 (1)"]
  describe package("vlock") do
    it { should be_installed }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-System_Package_vlock">
  <h4 class="resource-title">Resource <code>System Package vlock</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to be installed</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected that `System Package vlock` is installed</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.025561496 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238202r653781_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238202r653781_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238202r653781_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must enforce 24 hours/1 day as the minimum password lifetime. Passwords for new users must have a 24 hours/1 day minimum password lifetime restriction.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Enforcing a minimum password lifetime helps to prevent repeated password changes to defeat the password reuse or history enforcement requirement. If users are allowed to immediately and continually change their password, then the password could be repeatedly changed in a short period of time to defeat the organization's policy regarding password reuse.

Documentable: false</td></tr> 
    <tr class="impact impact-low"><th>Impact:</th><td>0.1</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000198</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-5 (1) (d)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238202r653781_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238202r653781_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238202r653781_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238202r653781_rule" do
  title "The Ubuntu operating system must enforce 24 hours/1 day as the minimum password lifetime. Passwords for new users must have a 24 hours/1 day minimum password lifetime restriction."
  desc  "
    Vulnerability Discussion: Enforcing a minimum password lifetime helps to prevent repeated password changes to defeat the password reuse or history enforcement requirement. If users are allowed to immediately and continually change their password, then the password could be repeatedly changed in a short period of time to defeat the organization's policy regarding password reuse.
    
    Documentable: false
    
  "
  impact 0.1
  tag cci: "CCI-000198"
  tag nist: ["NIST SP 800-53", "3", "IA-5 (1) (d)"]
  tag nist: ["NIST SP 800-53A", "1", "IA-5 (1).1 (v)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-5 (1) (d)"]
  describe file("/etc/login.defs") do
    its("content") { should match(/^\s*PASS_MIN_DAYS\s+(\d*)/) }
  end
  file("/etc/login.defs").content.to_s.scan(/^\s*PASS_MIN_DAYS\s+(\d*)/).flatten.each do |entry|
    describe entry do
      it { should cmp >= 1 }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_login_defs">
  <h4 class="resource-title">Resource <code>File /etc/login.defs</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*PASS_MIN_DAYS\s+(\d*)/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00045882 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-0">
  <h4 class="resource-title">Resource <code>0</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to cmp >= 1</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>
expected it to be >= 1
     got: 0

(compared using `cmp` matcher)
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.0003622 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238203r653784_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238203r653784_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238203r653784_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must enforce a 60-day maximum password lifetime restriction. Passwords for new users must have a 60-day maximum password lifetime restriction.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.

Documentable: false</td></tr> 
    <tr class="impact impact-low"><th>Impact:</th><td>0.1</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000199</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-5 (1) (d)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238203r653784_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238203r653784_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238203r653784_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238203r653784_rule" do
  title "The Ubuntu operating system must enforce a 60-day maximum password lifetime restriction. Passwords for new users must have a 60-day maximum password lifetime restriction."
  desc  "
    Vulnerability Discussion: Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.
    
    Documentable: false
    
  "
  impact 0.1
  tag cci: "CCI-000199"
  tag nist: ["NIST SP 800-53", "3", "IA-5 (1) (d)"]
  tag nist: ["NIST SP 800-53A", "1", "IA-5 (1).1 (v)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-5 (1) (d)"]
  describe file("/etc/login.defs") do
    its("content") { should match(/^\s*PASS_MAX_DAYS\s+(\d*)/) }
  end
  file("/etc/login.defs").content.to_s.scan(/^\s*PASS_MAX_DAYS\s+(\d*)/).flatten.each do |entry|
    describe entry do
      it { should cmp > 0 }
    end
  end
  file("/etc/login.defs").content.to_s.scan(/^\s*PASS_MAX_DAYS\s+(\d*)/).flatten.each do |entry|
    describe entry do
      it { should cmp <= 60 }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_login_defs">
  <h4 class="resource-title">Resource <code>File /etc/login.defs</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*PASS_MAX_DAYS\s+(\d*)/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000322008 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-99999">
  <h4 class="resource-title">Resource <code>99999</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to cmp > 0</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000257934 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-99999">
  <h4 class="resource-title">Resource <code>99999</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to cmp <= 60</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>
expected it to be <= 60
     got: 99999

(compared using `cmp` matcher)
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000310247 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-passed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238208r653799_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238208r653799_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238208r653799_rule">
  <caption>Control Table</caption>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must require users to reauthenticate for privilege escalation or when changing roles.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without reauthentication, users may access resources or perform tasks for which they do not have authorization.

When operating systems provide the capability to escalate a functional capability, it is critical the user reauthenticate.

Satisfies: SRG-OS-000373-GPOS-00156, SRG-OS-000373-GPOS-00157

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-002038</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-11"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238208r653799_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238208r653799_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238208r653799_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238208r653799_rule" do
  title "The Ubuntu operating system must require users to reauthenticate for privilege escalation or when changing roles."
  desc  "
    Vulnerability Discussion: Without reauthentication, users may access resources or perform tasks for which they do not have authorization.
    
    When operating systems provide the capability to escalate a functional capability, it is critical the user reauthenticate.
    
    Satisfies: SRG-OS-000373-GPOS-00156, SRG-OS-000373-GPOS-00157
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-002038"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-11"]
  describe file("/etc/sudoers") do
    its("content") { should_not match(/(?i)nopasswd/) }
  end
  describe file("/etc/sudoers") do
    its("content") { should_not match(/(?i)!authenticate/) }
  end
  files = command("find /etc/sudoers.d -type f -regex .\\*/.\\*").stdout.split
  describe files.delete_if { |f| command("file #{f} | cut -d: -f2").stdout =~ /binary|executable|archive/ || file(f).content !~ /(?i)nopasswd/ } do
    it { should be_empty }
  end
  files = command("find /etc/sudoers.d -type f -regex .\\*/.\\*").stdout.split
  describe files.delete_if { |f| command("file #{f} | cut -d: -f2").stdout =~ /binary|executable|archive/ || file(f).content !~ /(?i)!authenticate/ } do
    it { should be_empty }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_sudoers">
  <h4 class="resource-title">Resource <code>File /etc/sudoers</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /(?i)nopasswd/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.063708005 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sudoers">
  <h4 class="resource-title">Resource <code>File /etc/sudoers</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /(?i)!authenticate/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000297988 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-__">
  <h4 class="resource-title">Resource <code>[]</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to be empty</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.039464526 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-__">
  <h4 class="resource-title">Resource <code>[]</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to be empty</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.007022967 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238209r653802_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238209r653802_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238209r653802_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system default filesystem permissions must be defined in such a way that all authenticated users can read and modify only their own files.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Setting the most restrictive default permissions ensures that when new accounts are created they do not have unnecessary access.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000366</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "CM-6 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238209r653802_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238209r653802_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238209r653802_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238209r653802_rule" do
  title "The Ubuntu operating system default filesystem permissions must be defined in such a way that all authenticated users can read and modify only their own files."
  desc  "
    Vulnerability Discussion: Setting the most restrictive default permissions ensures that when new accounts are created they do not have unnecessary access.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000366"
  tag nist: ["NIST SP 800-53", "3", "CM-6 b"]
  tag nist: ["NIST SP 800-53A", "1", "CM-6.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "CM-6 b"]
  describe file("/etc/login.defs") do
    its("content") { should match(/^\s*UMASK\s+(\d*)/) }
  end
  file("/etc/login.defs").content.to_s.scan(/^\s*UMASK\s+(\d*)/).flatten.each do |entry|
    describe entry do
      it { should eq "077" }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_login_defs">
  <h4 class="resource-title">Resource <code>File /etc/login.defs</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*UMASK\s+(\d*)/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000405512 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-022">
  <h4 class="resource-title">Resource <code>022</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to eq "077"</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>
expected: "077"
     got: "022"

(compared using ==)
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.003525805 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238210r653805_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238210r653805_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238210r653805_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must implement smart card logins for multifactor authentication for local and network access to privileged and non-privileged accounts.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without the use of multifactor authentication, the ease of access to privileged functions is greatly increased.

Multifactor authentication requires using two or more factors to achieve authentication.

Factors include:
1) something a user knows (e.g., password/PIN);
2) something a user has (e.g., cryptographic identification device, token); and
3) something a user is (e.g., biometric).

A privileged account is defined as an information system account with authorizations of a privileged user.

Network access is defined as access to an information system by a user (or a process acting on behalf of a user) communicating through a network (e.g., local area network, wide area network, or the internet).

The DoD CAC with DoD-approved PKI is an example of multifactor authentication.

Satisfies: SRG-OS-000105-GPOS-00052, SRG-OS-000106-GPOS-00053, SRG-OS-000107-GPOS-00054, SRG-OS-000108-GPOS-00055

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000768</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-2 (4)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238210r653805_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238210r653805_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238210r653805_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238210r653805_rule" do
  title "The Ubuntu operating system must implement smart card logins for multifactor authentication for local and network access to privileged and non-privileged accounts."
  desc  "
    Vulnerability Discussion: Without the use of multifactor authentication, the ease of access to privileged functions is greatly increased.
    
    Multifactor authentication requires using two or more factors to achieve authentication.
    
    Factors include:
    1) something a user knows (e.g., password/PIN);
    2) something a user has (e.g., cryptographic identification device, token); and
    3) something a user is (e.g., biometric).
    
    A privileged account is defined as an information system account with authorizations of a privileged user.
    
    Network access is defined as access to an information system by a user (or a process acting on behalf of a user) communicating through a network (e.g., local area network, wide area network, or the internet).
    
    The DoD CAC with DoD-approved PKI is an example of multifactor authentication.
    
    Satisfies: SRG-OS-000105-GPOS-00052, SRG-OS-000106-GPOS-00053, SRG-OS-000107-GPOS-00054, SRG-OS-000108-GPOS-00055
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000765"
  tag nist: ["NIST SP 800-53", "3", "IA-2 (1)"]
  tag nist: ["NIST SP 800-53A", "1", "IA-2 (1).1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-2 (1)"]
  tag cci: "CCI-000766"
  tag nist: ["NIST SP 800-53", "3", "IA-2 (2)"]
  tag nist: ["NIST SP 800-53A", "1", "IA-2 (2).1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-2 (2)"]
  tag cci: "CCI-000767"
  tag nist: ["NIST SP 800-53", "3", "IA-2 (3)"]
  tag nist: ["NIST SP 800-53A", "1", "IA-2 (3).1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-2 (3)"]
  tag cci: "CCI-000768"
  tag nist: ["NIST SP 800-53", "3", "IA-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "IA-2 (4).1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-2 (4)"]
  describe file("/etc/ssh/sshd_config") do
    its("content") { should match(/^\s*PubkeyAuthentication[ \t]+(\w+)\s*(?:#.*|$)/) }
  end
  file("/etc/ssh/sshd_config").content.to_s.scan(/^\s*PubkeyAuthentication[ \t]+(\w+)\s*(?:#.*|$)/).flatten.each do |entry|
    describe entry do
      it { should eq "yes" }
    end
  end
  describe package("libpam-pkcs11") do
    it { should be_installed }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_ssh_sshd_config">
  <h4 class="resource-title">Resource <code>File /etc/ssh/sshd_config</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*PubkeyAuthentication[ \t]+(\w+)\s*(?:#.*|$)/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "#\t$OpenBSD: sshd_config,v 1.103 2018/04/09 20:41:22 tj Exp $\n\n# This is the sshd server system-wi...oncvs\n#\tX11Forwarding no\n#\tAllowTcpForwarding no\n#\tPermitTTY no\n#\tForceCommand cvs server\n" to match /^\s*PubkeyAuthentication[ \t]+(\w+)\s*(?:#.*|$)/
Diff:
@@ -1,2 +1,124 @@
-/^\s*PubkeyAuthentication[ \t]+(\w+)\s*(?:#.*|$)/
+#	$OpenBSD: sshd_config,v 1.103 2018/04/09 20:41:22 tj Exp $
+
+# This is the sshd server system-wide configuration file.  See
+# sshd_config(5) for more information.
+
+# This sshd was compiled with PATH=/usr/bin:/bin:/usr/sbin:/sbin
+
+# The strategy used for options in the default sshd_config shipped with
+# OpenSSH is to specify options with their default value where
+# possible, but leave them commented.  Uncommented options override the
+# default value.
+
+Include /etc/ssh/sshd_config.d/*.conf
+
+#Port 22
+#AddressFamily any
+#ListenAddress 0.0.0.0
+#ListenAddress ::
+
+#HostKey /etc/ssh/ssh_host_rsa_key
+#HostKey /etc/ssh/ssh_host_ecdsa_key
+#HostKey /etc/ssh/ssh_host_ed25519_key
+
+# Ciphers and keying
+#RekeyLimit default none
+
+# Logging
+#SyslogFacility AUTH
+#LogLevel INFO
+
+# Authentication:
+
+#LoginGraceTime 2m
+#PermitRootLogin prohibit-password
+#StrictModes yes
+#MaxAuthTries 6
+#MaxSessions 10
+
+#PubkeyAuthentication yes
+
+# Expect .ssh/authorized_keys2 to be disregarded by default in future.
+#AuthorizedKeysFile	.ssh/authorized_keys .ssh/authorized_keys2
+
+#AuthorizedPrincipalsFile none
+
+#AuthorizedKeysCommand none
+#AuthorizedKeysCommandUser nobody
+
+# For this to work you will also need host keys in /etc/ssh/ssh_known_hosts
+#HostbasedAuthentication no
+# Change to yes if you don't trust ~/.ssh/known_hosts for
+# HostbasedAuthentication
+#IgnoreUserKnownHosts no
+# Don't read the user's ~/.rhosts and ~/.shosts files
+#IgnoreRhosts yes
+
+# To disable tunneled clear text passwords, change to no here!
+#PasswordAuthentication yes
+#PermitEmptyPasswords no
+
+# Change to yes to enable challenge-response passwords (beware issues with
+# some PAM modules and threads)
+ChallengeResponseAuthentication no
+
+# Kerberos options
+#KerberosAuthentication no
+#KerberosOrLocalPasswd yes
+#KerberosTicketCleanup yes
+#KerberosGetAFSToken no
+
+# GSSAPI options
+#GSSAPIAuthentication no
+#GSSAPICleanupCredentials yes
+#GSSAPIStrictAcceptorCheck yes
+#GSSAPIKeyExchange no
+
+# Set this to 'yes' to enable PAM authentication, account processing,
+# and session processing. If this is enabled, PAM authentication will
+# be allowed through the ChallengeResponseAuthentication and
+# PasswordAuthentication.  Depending on your PAM configuration,
+# PAM authentication via ChallengeResponseAuthentication may bypass
+# the setting of "PermitRootLogin without-password".
+# If you just want the PAM account and session checks to run without
+# PAM authentication, then enable this but set PasswordAuthentication
+# and ChallengeResponseAuthentication to 'no'.
+UsePAM yes
+
+#AllowAgentForwarding yes
+#AllowTcpForwarding yes
+#GatewayPorts no
+X11Forwarding yes
+#X11DisplayOffset 10
+#X11UseLocalhost yes
+#PermitTTY yes
+PrintMotd no
+#PrintLastLog yes
+#TCPKeepAlive yes
+#PermitUserEnvironment no
+#Compression delayed
+#ClientAliveInterval 0
+#ClientAliveCountMax 3
+#UseDNS no
+#PidFile /var/run/sshd.pid
+#MaxStartups 10:30:100
+#PermitTunnel no
+#ChrootDirectory none
+#VersionAddendum none
+
+# no default banner path
+#Banner none
+
+# Allow client to pass locale environment variables
+AcceptEnv LANG LC_*
+
+# override default of no subsystems
+Subsystem	sftp	/usr/lib/openssh/sftp-server
+
+# Example of overriding settings on a per-user basis
+#Match User anoncvs
+#	X11Forwarding no
+#	AllowTcpForwarding no
+#	PermitTTY no
+#	ForceCommand cvs server
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.002331317 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-System_Package_libpam_pkcs11">
  <h4 class="resource-title">Resource <code>System Package libpam-pkcs11</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to be installed</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected that `System Package libpam-pkcs11` is installed</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.026292623 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-passed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238211r653808_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238211r653808_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238211r653808_rule">
  <caption>Control Table</caption>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must use strong authenticators in establishing nonlocal maintenance and diagnostic sessions.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Nonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network. Local maintenance and diagnostic activities are those activities carried out by individuals physically present at the information system or information system component and not communicating across a network connection. Typically, strong authentication requires authenticators that are resistant to replay attacks and employ multifactor authentication. Strong authenticators include, for example, PKI where certificates are stored on a token protected by a password, passphrase, or biometric.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000877</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "MA-4 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238211r653808_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238211r653808_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238211r653808_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238211r653808_rule" do
  title "The Ubuntu operating system must use strong authenticators in establishing nonlocal maintenance and diagnostic sessions."
  desc  "
    Vulnerability Discussion: Nonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network. Local maintenance and diagnostic activities are those activities carried out by individuals physically present at the information system or information system component and not communicating across a network connection. Typically, strong authentication requires authenticators that are resistant to replay attacks and employ multifactor authentication. Strong authenticators include, for example, PKI where certificates are stored on a token protected by a password, passphrase, or biometric.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000877"
  tag nist: ["NIST SP 800-53", "3", "MA-4 c"]
  tag nist: ["NIST SP 800-53A", "1", "MA-4.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "MA-4 c"]
  describe file("/etc/ssh/sshd_config") do
    its("content") { should match(/^\s*UsePAM\s+(\w*)/) }
  end
  file("/etc/ssh/sshd_config").content.to_s.scan(/^\s*UsePAM\s+(\w*)/).flatten.each do |entry|
    describe entry do
      it { should eq "yes" }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_ssh_sshd_config">
  <h4 class="resource-title">Resource <code>File /etc/ssh/sshd_config</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*UsePAM\s+(\w*)/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000344331 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-yes">
  <h4 class="resource-title">Resource <code>yes</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to eq "yes"</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000201045 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238212r653811_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238212r653811_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238212r653811_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must immediately terminate all network connections associated with SSH traffic after a period of inactivity.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Automatic session termination addresses the termination of user-initiated logical sessions in contrast to the termination of network connections that are associated with communications sessions (i.e., network disconnect). A logical session (for local, network, and remote access) is initiated whenever a user (or process acting on behalf of a user) accesses an organizational information system. Such user sessions can be terminated (and thus terminate user access) without terminating network sessions.

Session termination terminates all processes associated with a user's logical session except those processes that are specifically created by the user (i.e., session owner) to continue after the session is terminated.

Conditions or trigger events requiring automatic session termination can include, for example, organization-defined periods of user inactivity, targeted responses to certain types of incidents, and time-of-day restrictions on information system use.

This capability is typically reserved for specific Ubuntu operating system functionality where the system owner, data owner, or organization requires additional assurance.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000879</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "MA-4 e"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238212r653811_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238212r653811_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238212r653811_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238212r653811_rule" do
  title "The Ubuntu operating system must immediately terminate all network connections associated with SSH traffic after a period of inactivity."
  desc  "
    Vulnerability Discussion: Automatic session termination addresses the termination of user-initiated logical sessions in contrast to the termination of network connections that are associated with communications sessions (i.e., network disconnect). A logical session (for local, network, and remote access) is initiated whenever a user (or process acting on behalf of a user) accesses an organizational information system. Such user sessions can be terminated (and thus terminate user access) without terminating network sessions.
    
    Session termination terminates all processes associated with a user's logical session except those processes that are specifically created by the user (i.e., session owner) to continue after the session is terminated.
    
    Conditions or trigger events requiring automatic session termination can include, for example, organization-defined periods of user inactivity, targeted responses to certain types of incidents, and time-of-day restrictions on information system use.
    
    This capability is typically reserved for specific Ubuntu operating system functionality where the system owner, data owner, or organization requires additional assurance.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000879"
  tag nist: ["NIST SP 800-53", "3", "MA-4 e"]
  tag nist: ["NIST SP 800-53A", "1", "MA-4.1 (vi)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "MA-4 e"]
  describe file("/etc/ssh/sshd_config") do
    its("content") { should match(/^\s*ClientAliveCountMax\s+(\d*)/) }
  end
  file("/etc/ssh/sshd_config").content.to_s.scan(/^\s*ClientAliveCountMax\s+(\d*)/).flatten.each do |entry|
    describe entry do
      it { should cmp == 1 }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_ssh_sshd_config">
  <h4 class="resource-title">Resource <code>File /etc/ssh/sshd_config</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*ClientAliveCountMax\s+(\d*)/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "#\t$OpenBSD: sshd_config,v 1.103 2018/04/09 20:41:22 tj Exp $\n\n# This is the sshd server system-wi...oncvs\n#\tX11Forwarding no\n#\tAllowTcpForwarding no\n#\tPermitTTY no\n#\tForceCommand cvs server\n" to match /^\s*ClientAliveCountMax\s+(\d*)/
Diff:
@@ -1,2 +1,124 @@
-/^\s*ClientAliveCountMax\s+(\d*)/
+#	$OpenBSD: sshd_config,v 1.103 2018/04/09 20:41:22 tj Exp $
+
+# This is the sshd server system-wide configuration file.  See
+# sshd_config(5) for more information.
+
+# This sshd was compiled with PATH=/usr/bin:/bin:/usr/sbin:/sbin
+
+# The strategy used for options in the default sshd_config shipped with
+# OpenSSH is to specify options with their default value where
+# possible, but leave them commented.  Uncommented options override the
+# default value.
+
+Include /etc/ssh/sshd_config.d/*.conf
+
+#Port 22
+#AddressFamily any
+#ListenAddress 0.0.0.0
+#ListenAddress ::
+
+#HostKey /etc/ssh/ssh_host_rsa_key
+#HostKey /etc/ssh/ssh_host_ecdsa_key
+#HostKey /etc/ssh/ssh_host_ed25519_key
+
+# Ciphers and keying
+#RekeyLimit default none
+
+# Logging
+#SyslogFacility AUTH
+#LogLevel INFO
+
+# Authentication:
+
+#LoginGraceTime 2m
+#PermitRootLogin prohibit-password
+#StrictModes yes
+#MaxAuthTries 6
+#MaxSessions 10
+
+#PubkeyAuthentication yes
+
+# Expect .ssh/authorized_keys2 to be disregarded by default in future.
+#AuthorizedKeysFile	.ssh/authorized_keys .ssh/authorized_keys2
+
+#AuthorizedPrincipalsFile none
+
+#AuthorizedKeysCommand none
+#AuthorizedKeysCommandUser nobody
+
+# For this to work you will also need host keys in /etc/ssh/ssh_known_hosts
+#HostbasedAuthentication no
+# Change to yes if you don't trust ~/.ssh/known_hosts for
+# HostbasedAuthentication
+#IgnoreUserKnownHosts no
+# Don't read the user's ~/.rhosts and ~/.shosts files
+#IgnoreRhosts yes
+
+# To disable tunneled clear text passwords, change to no here!
+#PasswordAuthentication yes
+#PermitEmptyPasswords no
+
+# Change to yes to enable challenge-response passwords (beware issues with
+# some PAM modules and threads)
+ChallengeResponseAuthentication no
+
+# Kerberos options
+#KerberosAuthentication no
+#KerberosOrLocalPasswd yes
+#KerberosTicketCleanup yes
+#KerberosGetAFSToken no
+
+# GSSAPI options
+#GSSAPIAuthentication no
+#GSSAPICleanupCredentials yes
+#GSSAPIStrictAcceptorCheck yes
+#GSSAPIKeyExchange no
+
+# Set this to 'yes' to enable PAM authentication, account processing,
+# and session processing. If this is enabled, PAM authentication will
+# be allowed through the ChallengeResponseAuthentication and
+# PasswordAuthentication.  Depending on your PAM configuration,
+# PAM authentication via ChallengeResponseAuthentication may bypass
+# the setting of "PermitRootLogin without-password".
+# If you just want the PAM account and session checks to run without
+# PAM authentication, then enable this but set PasswordAuthentication
+# and ChallengeResponseAuthentication to 'no'.
+UsePAM yes
+
+#AllowAgentForwarding yes
+#AllowTcpForwarding yes
+#GatewayPorts no
+X11Forwarding yes
+#X11DisplayOffset 10
+#X11UseLocalhost yes
+#PermitTTY yes
+PrintMotd no
+#PrintLastLog yes
+#TCPKeepAlive yes
+#PermitUserEnvironment no
+#Compression delayed
+#ClientAliveInterval 0
+#ClientAliveCountMax 3
+#UseDNS no
+#PidFile /var/run/sshd.pid
+#MaxStartups 10:30:100
+#PermitTunnel no
+#ChrootDirectory none
+#VersionAddendum none
+
+# no default banner path
+#Banner none
+
+# Allow client to pass locale environment variables
+AcceptEnv LANG LC_*
+
+# override default of no subsystems
+Subsystem	sftp	/usr/lib/openssh/sftp-server
+
+# Example of overriding settings on a per-user basis
+#Match User anoncvs
+#	X11Forwarding no
+#	AllowTcpForwarding no
+#	PermitTTY no
+#	ForceCommand cvs server
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00238526 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238213r653814_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238213r653814_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238213r653814_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must immediately terminate all network connections associated with SSH traffic at the end of the session or after 10 minutes of inactivity.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element.

Terminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, and de-allocating networking assignments at the application level if multiple application sessions are using a single operating system-level network connection. This does not mean that the operating system terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001133</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "SC-10"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238213r653814_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238213r653814_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238213r653814_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238213r653814_rule" do
  title "The Ubuntu operating system must immediately terminate all network connections associated with SSH traffic at the end of the session or after 10 minutes of inactivity."
  desc  "
    Vulnerability Discussion: Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element.
    
    Terminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, and de-allocating networking assignments at the application level if multiple application sessions are using a single operating system-level network connection. This does not mean that the operating system terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001133"
  tag nist: ["NIST SP 800-53", "3", "SC-10"]
  tag nist: ["NIST SP 800-53A", "1", "SC-10.1 (ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "SC-10"]
  describe file("/etc/ssh/sshd_config") do
    its("content") { should match(/^\s*ClientAliveInterval[ \t]+(\d+)\s*(?:#.*|$)/) }
  end
  file("/etc/ssh/sshd_config").content.to_s.scan(/^\s*ClientAliveInterval[ \t]+(\d+)\s*(?:#.*|$)/).flatten.each do |entry|
    describe entry do
      it { should cmp <= 600 }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_ssh_sshd_config">
  <h4 class="resource-title">Resource <code>File /etc/ssh/sshd_config</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*ClientAliveInterval[ \t]+(\d+)\s*(?:#.*|$)/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "#\t$OpenBSD: sshd_config,v 1.103 2018/04/09 20:41:22 tj Exp $\n\n# This is the sshd server system-wi...oncvs\n#\tX11Forwarding no\n#\tAllowTcpForwarding no\n#\tPermitTTY no\n#\tForceCommand cvs server\n" to match /^\s*ClientAliveInterval[ \t]+(\d+)\s*(?:#.*|$)/
Diff:
@@ -1,2 +1,124 @@
-/^\s*ClientAliveInterval[ \t]+(\d+)\s*(?:#.*|$)/
+#	$OpenBSD: sshd_config,v 1.103 2018/04/09 20:41:22 tj Exp $
+
+# This is the sshd server system-wide configuration file.  See
+# sshd_config(5) for more information.
+
+# This sshd was compiled with PATH=/usr/bin:/bin:/usr/sbin:/sbin
+
+# The strategy used for options in the default sshd_config shipped with
+# OpenSSH is to specify options with their default value where
+# possible, but leave them commented.  Uncommented options override the
+# default value.
+
+Include /etc/ssh/sshd_config.d/*.conf
+
+#Port 22
+#AddressFamily any
+#ListenAddress 0.0.0.0
+#ListenAddress ::
+
+#HostKey /etc/ssh/ssh_host_rsa_key
+#HostKey /etc/ssh/ssh_host_ecdsa_key
+#HostKey /etc/ssh/ssh_host_ed25519_key
+
+# Ciphers and keying
+#RekeyLimit default none
+
+# Logging
+#SyslogFacility AUTH
+#LogLevel INFO
+
+# Authentication:
+
+#LoginGraceTime 2m
+#PermitRootLogin prohibit-password
+#StrictModes yes
+#MaxAuthTries 6
+#MaxSessions 10
+
+#PubkeyAuthentication yes
+
+# Expect .ssh/authorized_keys2 to be disregarded by default in future.
+#AuthorizedKeysFile	.ssh/authorized_keys .ssh/authorized_keys2
+
+#AuthorizedPrincipalsFile none
+
+#AuthorizedKeysCommand none
+#AuthorizedKeysCommandUser nobody
+
+# For this to work you will also need host keys in /etc/ssh/ssh_known_hosts
+#HostbasedAuthentication no
+# Change to yes if you don't trust ~/.ssh/known_hosts for
+# HostbasedAuthentication
+#IgnoreUserKnownHosts no
+# Don't read the user's ~/.rhosts and ~/.shosts files
+#IgnoreRhosts yes
+
+# To disable tunneled clear text passwords, change to no here!
+#PasswordAuthentication yes
+#PermitEmptyPasswords no
+
+# Change to yes to enable challenge-response passwords (beware issues with
+# some PAM modules and threads)
+ChallengeResponseAuthentication no
+
+# Kerberos options
+#KerberosAuthentication no
+#KerberosOrLocalPasswd yes
+#KerberosTicketCleanup yes
+#KerberosGetAFSToken no
+
+# GSSAPI options
+#GSSAPIAuthentication no
+#GSSAPICleanupCredentials yes
+#GSSAPIStrictAcceptorCheck yes
+#GSSAPIKeyExchange no
+
+# Set this to 'yes' to enable PAM authentication, account processing,
+# and session processing. If this is enabled, PAM authentication will
+# be allowed through the ChallengeResponseAuthentication and
+# PasswordAuthentication.  Depending on your PAM configuration,
+# PAM authentication via ChallengeResponseAuthentication may bypass
+# the setting of "PermitRootLogin without-password".
+# If you just want the PAM account and session checks to run without
+# PAM authentication, then enable this but set PasswordAuthentication
+# and ChallengeResponseAuthentication to 'no'.
+UsePAM yes
+
+#AllowAgentForwarding yes
+#AllowTcpForwarding yes
+#GatewayPorts no
+X11Forwarding yes
+#X11DisplayOffset 10
+#X11UseLocalhost yes
+#PermitTTY yes
+PrintMotd no
+#PrintLastLog yes
+#TCPKeepAlive yes
+#PermitUserEnvironment no
+#Compression delayed
+#ClientAliveInterval 0
+#ClientAliveCountMax 3
+#UseDNS no
+#PidFile /var/run/sshd.pid
+#MaxStartups 10:30:100
+#PermitTunnel no
+#ChrootDirectory none
+#VersionAddendum none
+
+# no default banner path
+#Banner none
+
+# Allow client to pass locale environment variables
+AcceptEnv LANG LC_*
+
+# override default of no subsystems
+Subsystem	sftp	/usr/lib/openssh/sftp-server
+
+# Example of overriding settings on a per-user basis
+#Match User anoncvs
+#	X11Forwarding no
+#	AllowTcpForwarding no
+#	PermitTTY no
+#	ForceCommand cvs server
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.002614621 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238216r654316_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238216r654316_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238216r654316_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must configure the SSH daemon to use Message Authentication Codes (MACs) employing FIPS 140-2 approved cryptographic hashes to prevent the unauthorized disclosure of information and/or detect changes to information during transmission.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without cryptographic integrity protections, information can be altered by unauthorized users without detection.

Remote access (e.g., RDP) is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. Nonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network.

Local maintenance and diagnostic activities are those activities carried out by individuals physically present at the information system or information system component and not communicating across a network connection.

Encrypting information for transmission protects information from unauthorized disclosure and modification. Cryptographic mechanisms implemented to protect information integrity include, for example, cryptographic hash functions which have common application in digital signatures, checksums, and message authentication codes.

Satisfies: SRG-OS-000424-GPOS-00188, SRG-OS-000250-GPOS-00093, SRG-OS-000393-GPOS-00173

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-002890</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "MA-4 (6)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238216r654316_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238216r654316_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238216r654316_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238216r654316_rule" do
  title "The Ubuntu operating system must configure the SSH daemon to use Message Authentication Codes (MACs) employing FIPS 140-2 approved cryptographic hashes to prevent the unauthorized disclosure of information and/or detect changes to information during transmission."
  desc  "
    Vulnerability Discussion: Without cryptographic integrity protections, information can be altered by unauthorized users without detection.
    
    Remote access (e.g., RDP) is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. Nonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network.
    
    Local maintenance and diagnostic activities are those activities carried out by individuals physically present at the information system or information system component and not communicating across a network connection.
    
    Encrypting information for transmission protects information from unauthorized disclosure and modification. Cryptographic mechanisms implemented to protect information integrity include, for example, cryptographic hash functions which have common application in digital signatures, checksums, and message authentication codes.
    
    Satisfies: SRG-OS-000424-GPOS-00188, SRG-OS-000250-GPOS-00093, SRG-OS-000393-GPOS-00173
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001453"
  tag nist: ["NIST SP 800-53", "3", "AC-17 (2)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-17 (2).1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-17 (2)"]
  tag cci: "CCI-002421"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "SC-8 (1)"]
  tag cci: "CCI-002890"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "MA-4 (6)"]
  describe file("/etc/ssh/sshd_config") do
    its("content") { should match(/^\s*(?i)MACs(?-i)[ \t]+\"?([\w,-]+)\"?[\s]*(?:|(?:#.*))?$/) }
  end
  file("/etc/ssh/sshd_config").content.to_s.scan(/^\s*(?i)MACs(?-i)[ \t]+\"?([\w,-]+)\"?[\s]*(?:|(?:#.*))?$/).flatten.each do |entry|
    describe entry do
      it { should match(/^(hmac-sha2-512)|(hmac-sha2-512,hmac-sha2-256)|(hmac-sha2-256)$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_ssh_sshd_config">
  <h4 class="resource-title">Resource <code>File /etc/ssh/sshd_config</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*(?i)MACs(?-i)[ \t]+\"?([\w,-]+)\"?[\s]*(?:|(?:#.*))?$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "#\t$OpenBSD: sshd_config,v 1.103 2018/04/09 20:41:22 tj Exp $\n\n# This is the sshd server system-wi...oncvs\n#\tX11Forwarding no\n#\tAllowTcpForwarding no\n#\tPermitTTY no\n#\tForceCommand cvs server\n" to match /^\s*(?i)MACs(?-i)[ \t]+\"?([\w,-]+)\"?[\s]*(?:|(?:#.*))?$/
Diff:
@@ -1,2 +1,124 @@
-/^\s*(?i)MACs(?-i)[ \t]+\"?([\w,-]+)\"?[\s]*(?:|(?:#.*))?$/
+#	$OpenBSD: sshd_config,v 1.103 2018/04/09 20:41:22 tj Exp $
+
+# This is the sshd server system-wide configuration file.  See
+# sshd_config(5) for more information.
+
+# This sshd was compiled with PATH=/usr/bin:/bin:/usr/sbin:/sbin
+
+# The strategy used for options in the default sshd_config shipped with
+# OpenSSH is to specify options with their default value where
+# possible, but leave them commented.  Uncommented options override the
+# default value.
+
+Include /etc/ssh/sshd_config.d/*.conf
+
+#Port 22
+#AddressFamily any
+#ListenAddress 0.0.0.0
+#ListenAddress ::
+
+#HostKey /etc/ssh/ssh_host_rsa_key
+#HostKey /etc/ssh/ssh_host_ecdsa_key
+#HostKey /etc/ssh/ssh_host_ed25519_key
+
+# Ciphers and keying
+#RekeyLimit default none
+
+# Logging
+#SyslogFacility AUTH
+#LogLevel INFO
+
+# Authentication:
+
+#LoginGraceTime 2m
+#PermitRootLogin prohibit-password
+#StrictModes yes
+#MaxAuthTries 6
+#MaxSessions 10
+
+#PubkeyAuthentication yes
+
+# Expect .ssh/authorized_keys2 to be disregarded by default in future.
+#AuthorizedKeysFile	.ssh/authorized_keys .ssh/authorized_keys2
+
+#AuthorizedPrincipalsFile none
+
+#AuthorizedKeysCommand none
+#AuthorizedKeysCommandUser nobody
+
+# For this to work you will also need host keys in /etc/ssh/ssh_known_hosts
+#HostbasedAuthentication no
+# Change to yes if you don't trust ~/.ssh/known_hosts for
+# HostbasedAuthentication
+#IgnoreUserKnownHosts no
+# Don't read the user's ~/.rhosts and ~/.shosts files
+#IgnoreRhosts yes
+
+# To disable tunneled clear text passwords, change to no here!
+#PasswordAuthentication yes
+#PermitEmptyPasswords no
+
+# Change to yes to enable challenge-response passwords (beware issues with
+# some PAM modules and threads)
+ChallengeResponseAuthentication no
+
+# Kerberos options
+#KerberosAuthentication no
+#KerberosOrLocalPasswd yes
+#KerberosTicketCleanup yes
+#KerberosGetAFSToken no
+
+# GSSAPI options
+#GSSAPIAuthentication no
+#GSSAPICleanupCredentials yes
+#GSSAPIStrictAcceptorCheck yes
+#GSSAPIKeyExchange no
+
+# Set this to 'yes' to enable PAM authentication, account processing,
+# and session processing. If this is enabled, PAM authentication will
+# be allowed through the ChallengeResponseAuthentication and
+# PasswordAuthentication.  Depending on your PAM configuration,
+# PAM authentication via ChallengeResponseAuthentication may bypass
+# the setting of "PermitRootLogin without-password".
+# If you just want the PAM account and session checks to run without
+# PAM authentication, then enable this but set PasswordAuthentication
+# and ChallengeResponseAuthentication to 'no'.
+UsePAM yes
+
+#AllowAgentForwarding yes
+#AllowTcpForwarding yes
+#GatewayPorts no
+X11Forwarding yes
+#X11DisplayOffset 10
+#X11UseLocalhost yes
+#PermitTTY yes
+PrintMotd no
+#PrintLastLog yes
+#TCPKeepAlive yes
+#PermitUserEnvironment no
+#Compression delayed
+#ClientAliveInterval 0
+#ClientAliveCountMax 3
+#UseDNS no
+#PidFile /var/run/sshd.pid
+#MaxStartups 10:30:100
+#PermitTunnel no
+#ChrootDirectory none
+#VersionAddendum none
+
+# no default banner path
+#Banner none
+
+# Allow client to pass locale environment variables
+AcceptEnv LANG LC_*
+
+# override default of no subsystems
+Subsystem	sftp	/usr/lib/openssh/sftp-server
+
+# Example of overriding settings on a per-user basis
+#Match User anoncvs
+#	X11Forwarding no
+#	AllowTcpForwarding no
+#	PermitTTY no
+#	ForceCommand cvs server
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.002203881 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238217r653826_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238217r653826_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238217r653826_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must configure the SSH daemon to use FIPS 140-2 approved ciphers to prevent the unauthorized disclosure of information and/or detect changes to information during transmission.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without cryptographic integrity protections, information can be altered by unauthorized users without detection.

Remote access (e.g., RDP) is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.

Nonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network.

Local maintenance and diagnostic activities are those activities carried out by individuals physically present at the information system or information system component and not communicating across a network connection.

Encrypting information for transmission protects information from unauthorized disclosure and modification. Cryptographic mechanisms implemented to protect information integrity include, for example, cryptographic hash functions which have common application in digital signatures, checksums, and message authentication codes.

By specifying a cipher list with the order of ciphers being in a "strongest to weakest" orientation, the system will automatically attempt to use the strongest cipher for securing SSH connections.

Satisfies: SRG-OS-000424-GPOS-00188, SRG-OS-000033-GPOS-00014, SRG-OS-000394-GPOS-00174

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-003123</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "MA-4 (6)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238217r653826_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238217r653826_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238217r653826_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238217r653826_rule" do
  title "The Ubuntu operating system must configure the SSH daemon to use FIPS 140-2 approved ciphers to prevent the unauthorized disclosure of information and/or detect changes to information during transmission."
  desc  "
    Vulnerability Discussion: Without cryptographic integrity protections, information can be altered by unauthorized users without detection.
    
    Remote access (e.g., RDP) is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.
    
    Nonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network.
    
    Local maintenance and diagnostic activities are those activities carried out by individuals physically present at the information system or information system component and not communicating across a network connection.
    
    Encrypting information for transmission protects information from unauthorized disclosure and modification. Cryptographic mechanisms implemented to protect information integrity include, for example, cryptographic hash functions which have common application in digital signatures, checksums, and message authentication codes.
    
    By specifying a cipher list with the order of ciphers being in a \"strongest to weakest\" orientation, the system will automatically attempt to use the strongest cipher for securing SSH connections.
    
    Satisfies: SRG-OS-000424-GPOS-00188, SRG-OS-000033-GPOS-00014, SRG-OS-000394-GPOS-00174
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000068"
  tag nist: ["NIST SP 800-53", "3", "AC-17 (2)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-17 (2).1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-17 (2)"]
  tag cci: "CCI-002421"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "SC-8 (1)"]
  tag cci: "CCI-003123"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "MA-4 (6)"]
  describe file("/etc/ssh/sshd_config") do
    its("content") { should match(/^\s*(?i)Ciphers(?-i)[ \t]+\"?([\w,-]+)\"?[\s]*(?:|(?:#.*))?$/) }
  end
  file("/etc/ssh/sshd_config").content.to_s.scan(/^\s*(?i)Ciphers(?-i)[ \t]+\"?([\w,-]+)\"?[\s]*(?:|(?:#.*))?$/).flatten.each do |entry|
    describe entry do
      it { should match(/^(?:(aes256-ctr,aes192-ctr,aes128-ctr)|(aes256-ctr,aes192-ctr)|(aes256-ctr,aes128-ctr)|(aes192-ctr,aes128-ctr)|(aes256-ctr)|(aes192-ctr)|(aes128-ctr))$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_ssh_sshd_config">
  <h4 class="resource-title">Resource <code>File /etc/ssh/sshd_config</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*(?i)Ciphers(?-i)[ \t]+\"?([\w,-]+)\"?[\s]*(?:|(?:#.*))?$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "#\t$OpenBSD: sshd_config,v 1.103 2018/04/09 20:41:22 tj Exp $\n\n# This is the sshd server system-wi...oncvs\n#\tX11Forwarding no\n#\tAllowTcpForwarding no\n#\tPermitTTY no\n#\tForceCommand cvs server\n" to match /^\s*(?i)Ciphers(?-i)[ \t]+\"?([\w,-]+)\"?[\s]*(?:|(?:#.*))?$/
Diff:
@@ -1,2 +1,124 @@
-/^\s*(?i)Ciphers(?-i)[ \t]+\"?([\w,-]+)\"?[\s]*(?:|(?:#.*))?$/
+#	$OpenBSD: sshd_config,v 1.103 2018/04/09 20:41:22 tj Exp $
+
+# This is the sshd server system-wide configuration file.  See
+# sshd_config(5) for more information.
+
+# This sshd was compiled with PATH=/usr/bin:/bin:/usr/sbin:/sbin
+
+# The strategy used for options in the default sshd_config shipped with
+# OpenSSH is to specify options with their default value where
+# possible, but leave them commented.  Uncommented options override the
+# default value.
+
+Include /etc/ssh/sshd_config.d/*.conf
+
+#Port 22
+#AddressFamily any
+#ListenAddress 0.0.0.0
+#ListenAddress ::
+
+#HostKey /etc/ssh/ssh_host_rsa_key
+#HostKey /etc/ssh/ssh_host_ecdsa_key
+#HostKey /etc/ssh/ssh_host_ed25519_key
+
+# Ciphers and keying
+#RekeyLimit default none
+
+# Logging
+#SyslogFacility AUTH
+#LogLevel INFO
+
+# Authentication:
+
+#LoginGraceTime 2m
+#PermitRootLogin prohibit-password
+#StrictModes yes
+#MaxAuthTries 6
+#MaxSessions 10
+
+#PubkeyAuthentication yes
+
+# Expect .ssh/authorized_keys2 to be disregarded by default in future.
+#AuthorizedKeysFile	.ssh/authorized_keys .ssh/authorized_keys2
+
+#AuthorizedPrincipalsFile none
+
+#AuthorizedKeysCommand none
+#AuthorizedKeysCommandUser nobody
+
+# For this to work you will also need host keys in /etc/ssh/ssh_known_hosts
+#HostbasedAuthentication no
+# Change to yes if you don't trust ~/.ssh/known_hosts for
+# HostbasedAuthentication
+#IgnoreUserKnownHosts no
+# Don't read the user's ~/.rhosts and ~/.shosts files
+#IgnoreRhosts yes
+
+# To disable tunneled clear text passwords, change to no here!
+#PasswordAuthentication yes
+#PermitEmptyPasswords no
+
+# Change to yes to enable challenge-response passwords (beware issues with
+# some PAM modules and threads)
+ChallengeResponseAuthentication no
+
+# Kerberos options
+#KerberosAuthentication no
+#KerberosOrLocalPasswd yes
+#KerberosTicketCleanup yes
+#KerberosGetAFSToken no
+
+# GSSAPI options
+#GSSAPIAuthentication no
+#GSSAPICleanupCredentials yes
+#GSSAPIStrictAcceptorCheck yes
+#GSSAPIKeyExchange no
+
+# Set this to 'yes' to enable PAM authentication, account processing,
+# and session processing. If this is enabled, PAM authentication will
+# be allowed through the ChallengeResponseAuthentication and
+# PasswordAuthentication.  Depending on your PAM configuration,
+# PAM authentication via ChallengeResponseAuthentication may bypass
+# the setting of "PermitRootLogin without-password".
+# If you just want the PAM account and session checks to run without
+# PAM authentication, then enable this but set PasswordAuthentication
+# and ChallengeResponseAuthentication to 'no'.
+UsePAM yes
+
+#AllowAgentForwarding yes
+#AllowTcpForwarding yes
+#GatewayPorts no
+X11Forwarding yes
+#X11DisplayOffset 10
+#X11UseLocalhost yes
+#PermitTTY yes
+PrintMotd no
+#PrintLastLog yes
+#TCPKeepAlive yes
+#PermitUserEnvironment no
+#Compression delayed
+#ClientAliveInterval 0
+#ClientAliveCountMax 3
+#UseDNS no
+#PidFile /var/run/sshd.pid
+#MaxStartups 10:30:100
+#PermitTunnel no
+#ChrootDirectory none
+#VersionAddendum none
+
+# no default banner path
+#Banner none
+
+# Allow client to pass locale environment variables
+AcceptEnv LANG LC_*
+
+# override default of no subsystems
+Subsystem	sftp	/usr/lib/openssh/sftp-server
+
+# Example of overriding settings on a per-user basis
+#Match User anoncvs
+#	X11Forwarding no
+#	AllowTcpForwarding no
+#	PermitTTY no
+#	ForceCommand cvs server
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.002243731 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238220r653835_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238220r653835_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238220r653835_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system SSH daemon must prevent remote hosts from connecting to the proxy display.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: When X11 forwarding is enabled, there may be additional exposure to the server and client displays if the sshd proxy display is configured to listen on the wildcard address.  By default, sshd binds the forwarding server to the loopback address and sets the hostname part of the DISPLAY environment variable to localhost. This prevents remote hosts from connecting to the proxy display.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000366</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "CM-6 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238220r653835_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238220r653835_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238220r653835_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238220r653835_rule" do
  title "The Ubuntu operating system SSH daemon must prevent remote hosts from connecting to the proxy display."
  desc  "
    Vulnerability Discussion: When X11 forwarding is enabled, there may be additional exposure to the server and client displays if the sshd proxy display is configured to listen on the wildcard address.  By default, sshd binds the forwarding server to the loopback address and sets the hostname part of the DISPLAY environment variable to localhost. This prevents remote hosts from connecting to the proxy display.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000366"
  tag nist: ["NIST SP 800-53", "3", "CM-6 b"]
  tag nist: ["NIST SP 800-53A", "1", "CM-6.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "CM-6 b"]
  describe file("/etc/ssh/sshd_config") do
    its("content") { should match(/^\s*(?i)X11UseLocalhost(?-i)\s+"?(\S+?)"?\s*(?:#.*|$)/) }
  end
  file("/etc/ssh/sshd_config").content.to_s.scan(/^\s*(?i)X11UseLocalhost(?-i)\s+"?(\S+?)"?\s*(?:#.*|$)/).flatten.each do |entry|
    describe entry do
      it { should eq "yes" }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_ssh_sshd_config">
  <h4 class="resource-title">Resource <code>File /etc/ssh/sshd_config</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*(?i)X11UseLocalhost(?-i)\s+"?(\S+?)"?\s*(?:#.*|$)/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "#\t$OpenBSD: sshd_config,v 1.103 2018/04/09 20:41:22 tj Exp $\n\n# This is the sshd server system-wi...oncvs\n#\tX11Forwarding no\n#\tAllowTcpForwarding no\n#\tPermitTTY no\n#\tForceCommand cvs server\n" to match /^\s*(?i)X11UseLocalhost(?-i)\s+"?(\S+?)"?\s*(?:#.*|$)/
Diff:
@@ -1,2 +1,124 @@
-/^\s*(?i)X11UseLocalhost(?-i)\s+"?(\S+?)"?\s*(?:#.*|$)/
+#	$OpenBSD: sshd_config,v 1.103 2018/04/09 20:41:22 tj Exp $
+
+# This is the sshd server system-wide configuration file.  See
+# sshd_config(5) for more information.
+
+# This sshd was compiled with PATH=/usr/bin:/bin:/usr/sbin:/sbin
+
+# The strategy used for options in the default sshd_config shipped with
+# OpenSSH is to specify options with their default value where
+# possible, but leave them commented.  Uncommented options override the
+# default value.
+
+Include /etc/ssh/sshd_config.d/*.conf
+
+#Port 22
+#AddressFamily any
+#ListenAddress 0.0.0.0
+#ListenAddress ::
+
+#HostKey /etc/ssh/ssh_host_rsa_key
+#HostKey /etc/ssh/ssh_host_ecdsa_key
+#HostKey /etc/ssh/ssh_host_ed25519_key
+
+# Ciphers and keying
+#RekeyLimit default none
+
+# Logging
+#SyslogFacility AUTH
+#LogLevel INFO
+
+# Authentication:
+
+#LoginGraceTime 2m
+#PermitRootLogin prohibit-password
+#StrictModes yes
+#MaxAuthTries 6
+#MaxSessions 10
+
+#PubkeyAuthentication yes
+
+# Expect .ssh/authorized_keys2 to be disregarded by default in future.
+#AuthorizedKeysFile	.ssh/authorized_keys .ssh/authorized_keys2
+
+#AuthorizedPrincipalsFile none
+
+#AuthorizedKeysCommand none
+#AuthorizedKeysCommandUser nobody
+
+# For this to work you will also need host keys in /etc/ssh/ssh_known_hosts
+#HostbasedAuthentication no
+# Change to yes if you don't trust ~/.ssh/known_hosts for
+# HostbasedAuthentication
+#IgnoreUserKnownHosts no
+# Don't read the user's ~/.rhosts and ~/.shosts files
+#IgnoreRhosts yes
+
+# To disable tunneled clear text passwords, change to no here!
+#PasswordAuthentication yes
+#PermitEmptyPasswords no
+
+# Change to yes to enable challenge-response passwords (beware issues with
+# some PAM modules and threads)
+ChallengeResponseAuthentication no
+
+# Kerberos options
+#KerberosAuthentication no
+#KerberosOrLocalPasswd yes
+#KerberosTicketCleanup yes
+#KerberosGetAFSToken no
+
+# GSSAPI options
+#GSSAPIAuthentication no
+#GSSAPICleanupCredentials yes
+#GSSAPIStrictAcceptorCheck yes
+#GSSAPIKeyExchange no
+
+# Set this to 'yes' to enable PAM authentication, account processing,
+# and session processing. If this is enabled, PAM authentication will
+# be allowed through the ChallengeResponseAuthentication and
+# PasswordAuthentication.  Depending on your PAM configuration,
+# PAM authentication via ChallengeResponseAuthentication may bypass
+# the setting of "PermitRootLogin without-password".
+# If you just want the PAM account and session checks to run without
+# PAM authentication, then enable this but set PasswordAuthentication
+# and ChallengeResponseAuthentication to 'no'.
+UsePAM yes
+
+#AllowAgentForwarding yes
+#AllowTcpForwarding yes
+#GatewayPorts no
+X11Forwarding yes
+#X11DisplayOffset 10
+#X11UseLocalhost yes
+#PermitTTY yes
+PrintMotd no
+#PrintLastLog yes
+#TCPKeepAlive yes
+#PermitUserEnvironment no
+#Compression delayed
+#ClientAliveInterval 0
+#ClientAliveCountMax 3
+#UseDNS no
+#PidFile /var/run/sshd.pid
+#MaxStartups 10:30:100
+#PermitTunnel no
+#ChrootDirectory none
+#VersionAddendum none
+
+# no default banner path
+#Banner none
+
+# Allow client to pass locale environment variables
+AcceptEnv LANG LC_*
+
+# override default of no subsystems
+Subsystem	sftp	/usr/lib/openssh/sftp-server
+
+# Example of overriding settings on a per-user basis
+#Match User anoncvs
+#	X11Forwarding no
+#	AllowTcpForwarding no
+#	PermitTTY no
+#	ForceCommand cvs server
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.002944022 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238221r653838_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238221r653838_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238221r653838_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must enforce password complexity by requiring that at least one upper-case character be used.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.

Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.

Documentable: false</td></tr> 
    <tr class="impact impact-low"><th>Impact:</th><td>0.1</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000192</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-5 (1) (a)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238221r653838_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238221r653838_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238221r653838_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238221r653838_rule" do
  title "The Ubuntu operating system must enforce password complexity by requiring that at least one upper-case character be used."
  desc  "
    Vulnerability Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.
    
    Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.
    
    Documentable: false
    
  "
  impact 0.1
  tag cci: "CCI-000192"
  tag nist: ["NIST SP 800-53", "3", "IA-5 (1) (a)"]
  tag nist: ["NIST SP 800-53A", "1", "IA-5 (1).1 (v)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-5 (1) (a)"]
  describe file("/etc/security/pwquality.conf") do
    its("content") { should match(/^\s*ucredit\s*=\s*(-?\d*)\s*(?:#.*)?$/) }
  end
  file("/etc/security/pwquality.conf").content.to_s.scan(/^\s*ucredit\s*=\s*(-?\d*)\s*(?:#.*)?$/).flatten.each do |entry|
    describe entry do
      it { should cmp < 0 }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_security_pwquality_conf">
  <h4 class="resource-title">Resource <code>File /etc/security/pwquality.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*ucredit\s*=\s*(-?\d*)\s*(?:#.*)?$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*ucredit\s*=\s*(-?\d*)\s*(?:#.*)?$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000292046 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238222r653841_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238222r653841_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238222r653841_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must enforce password complexity by requiring that at least one lower-case character be used.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.

Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.

Documentable: false</td></tr> 
    <tr class="impact impact-low"><th>Impact:</th><td>0.1</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000193</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-5 (1) (a)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238222r653841_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238222r653841_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238222r653841_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238222r653841_rule" do
  title "The Ubuntu operating system must enforce password complexity by requiring that at least one lower-case character be used."
  desc  "
    Vulnerability Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.
    
    Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.
    
    Documentable: false
    
  "
  impact 0.1
  tag cci: "CCI-000193"
  tag nist: ["NIST SP 800-53", "3", "IA-5 (1) (a)"]
  tag nist: ["NIST SP 800-53A", "1", "IA-5 (1).1 (v)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-5 (1) (a)"]
  describe file("/etc/security/pwquality.conf") do
    its("content") { should match(/^\s*lcredit[\s]*=[\s]*(-?\d+)(?:[\s]|$)/) }
  end
  file("/etc/security/pwquality.conf").content.to_s.scan(/^\s*lcredit[\s]*=[\s]*(-?\d+)(?:[\s]|$)/).flatten.each do |entry|
    describe entry do
      it { should cmp <= -1 }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_security_pwquality_conf">
  <h4 class="resource-title">Resource <code>File /etc/security/pwquality.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*lcredit[\s]*=[\s]*(-?\d+)(?:[\s]|$)/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*lcredit[\s]*=[\s]*(-?\d+)(?:[\s]|$)/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000219859 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238223r653844_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238223r653844_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238223r653844_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must enforce password complexity by requiring that at least one numeric character be used.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.

Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.

Documentable: false</td></tr> 
    <tr class="impact impact-low"><th>Impact:</th><td>0.1</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000194</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-5 (1) (a)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238223r653844_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238223r653844_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238223r653844_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238223r653844_rule" do
  title "The Ubuntu operating system must enforce password complexity by requiring that at least one numeric character be used."
  desc  "
    Vulnerability Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.
    
    Password complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.
    
    Documentable: false
    
  "
  impact 0.1
  tag cci: "CCI-000194"
  tag nist: ["NIST SP 800-53", "3", "IA-5 (1) (a)"]
  tag nist: ["NIST SP 800-53A", "1", "IA-5 (1).1 (v)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-5 (1) (a)"]
  describe file("/etc/security/pwquality.conf") do
    its("content") { should match(/^\s*dcredit[\s]*=[\s]*(-?\d+)(?:[\s]|$)/) }
  end
  file("/etc/security/pwquality.conf").content.to_s.scan(/^\s*dcredit[\s]*=[\s]*(-?\d+)(?:[\s]|$)/).flatten.each do |entry|
    describe entry do
      it { should cmp <= -1 }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_security_pwquality_conf">
  <h4 class="resource-title">Resource <code>File /etc/security/pwquality.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*dcredit[\s]*=[\s]*(-?\d+)(?:[\s]|$)/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*dcredit[\s]*=[\s]*(-?\d+)(?:[\s]|$)/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000198838 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238224r653847_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238224r653847_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238224r653847_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must require the change of at least 8 characters when passwords are changed.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.

The number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.

If the password length is an odd number then number of changed characters must be rounded up.  For example, a password length of 15 characters must require the change of at least 8 characters.

Documentable: false</td></tr> 
    <tr class="impact impact-low"><th>Impact:</th><td>0.1</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000195</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-5 (1) (b)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238224r653847_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238224r653847_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238224r653847_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238224r653847_rule" do
  title "The Ubuntu operating system must require the change of at least 8 characters when passwords are changed."
  desc  "
    Vulnerability Discussion: If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.
    
    The number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.
    
    If the password length is an odd number then number of changed characters must be rounded up.  For example, a password length of 15 characters must require the change of at least 8 characters.
    
    Documentable: false
    
  "
  impact 0.1
  tag cci: "CCI-000195"
  tag nist: ["NIST SP 800-53", "3", "IA-5 (1) (b)"]
  tag nist: ["NIST SP 800-53A", "1", "IA-5 (1).1 (v)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-5 (1) (b)"]
  describe file("/etc/security/pwquality.conf") do
    its("content") { should match(/^\s*difok[\s]*=[\s]*(-?\d+)(?:[\s]|$)/) }
  end
  file("/etc/security/pwquality.conf").content.to_s.scan(/^\s*difok[\s]*=[\s]*(-?\d+)(?:[\s]|$)/).flatten.each do |entry|
    describe entry do
      it { should cmp >= 8 }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_security_pwquality_conf">
  <h4 class="resource-title">Resource <code>File /etc/security/pwquality.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*difok[\s]*=[\s]*(-?\d+)(?:[\s]|$)/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*difok[\s]*=[\s]*(-?\d+)(?:[\s]|$)/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000189937 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238225r653850_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238225r653850_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238225r653850_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must enforce a minimum 15-character password length.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.

Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000205</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-5 (1) (a)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238225r653850_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238225r653850_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238225r653850_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238225r653850_rule" do
  title "The Ubuntu operating system must enforce a minimum 15-character password length."
  desc  "
    Vulnerability Discussion: The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.
    
    Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000205"
  tag nist: ["NIST SP 800-53", "3", "IA-5 (1) (a)"]
  tag nist: ["NIST SP 800-53A", "1", "IA-5 (1).1 (i)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-5 (1) (a)"]
  describe file("/etc/security/pwquality.conf") do
    its("content") { should match(/^\s*minlen[\s]*=[\s]*(-?\d+)(?:[\s]|$)/) }
  end
  file("/etc/security/pwquality.conf").content.to_s.scan(/^\s*minlen[\s]*=[\s]*(-?\d+)(?:[\s]|$)/).flatten.each do |entry|
    describe entry do
      it { should cmp >= 15 }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_security_pwquality_conf">
  <h4 class="resource-title">Resource <code>File /etc/security/pwquality.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*minlen[\s]*=[\s]*(-?\d+)(?:[\s]|$)/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*minlen[\s]*=[\s]*(-?\d+)(?:[\s]|$)/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000181392 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238226r653853_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238226r653853_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238226r653853_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must enforce password complexity by requiring that at least one special character be used.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity or strength is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.

Password complexity is one factor in determining how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.

Special characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.

Documentable: false</td></tr> 
    <tr class="impact impact-low"><th>Impact:</th><td>0.1</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001619</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-5 (1) (a)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238226r653853_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238226r653853_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238226r653853_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238226r653853_rule" do
  title "The Ubuntu operating system must enforce password complexity by requiring that at least one special character be used."
  desc  "
    Vulnerability Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity or strength is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.
    
    Password complexity is one factor in determining how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.
    
    Special characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.
    
    Documentable: false
    
  "
  impact 0.1
  tag cci: "CCI-001619"
  tag nist: ["NIST SP 800-53", "3", "IA-5 (1) (a)"]
  tag nist: ["NIST SP 800-53A", "1", "IA-5 (1).1 (v)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-5 (1) (a)"]
  describe file("/etc/security/pwquality.conf") do
    its("content") { should match(/^\s*ocredit[\s]*=[\s]*(-?\d+)(?:[\s]|$)/) }
  end
  file("/etc/security/pwquality.conf").content.to_s.scan(/^\s*ocredit[\s]*=[\s]*(-?\d+)(?:[\s]|$)/).flatten.each do |entry|
    describe entry do
      it { should cmp <= -1 }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_security_pwquality_conf">
  <h4 class="resource-title">Resource <code>File /etc/security/pwquality.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*ocredit[\s]*=[\s]*(-?\d+)(?:[\s]|$)/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*ocredit[\s]*=[\s]*(-?\d+)(?:[\s]|$)/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000399931 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238227r653856_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238227r653856_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238227r653856_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must prevent the use of dictionary words for passwords.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: If the Ubuntu operating system allows the user to select passwords based on dictionary words, then this increases the chances of password compromise by increasing the opportunity for successful guesses and brute-force attacks.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000366</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "CM-6 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238227r653856_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238227r653856_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238227r653856_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238227r653856_rule" do
  title "The Ubuntu operating system must prevent the use of dictionary words for passwords."
  desc  "
    Vulnerability Discussion: If the Ubuntu operating system allows the user to select passwords based on dictionary words, then this increases the chances of password compromise by increasing the opportunity for successful guesses and brute-force attacks.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000366"
  tag nist: ["NIST SP 800-53", "3", "CM-6 b"]
  tag nist: ["NIST SP 800-53A", "1", "CM-6.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "CM-6 b"]
  describe file("/etc/security/pwquality.conf") do
    its("content") { should match(/^\s*dictcheck[\s]*=[\s]*(-?\d+)(?:[\s]|$)/) }
  end
  file("/etc/security/pwquality.conf").content.to_s.scan(/^\s*dictcheck[\s]*=[\s]*(-?\d+)(?:[\s]|$)/).flatten.each do |entry|
    describe entry do
      it { should cmp == 1 }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_security_pwquality_conf">
  <h4 class="resource-title">Resource <code>File /etc/security/pwquality.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*dictcheck[\s]*=[\s]*(-?\d+)(?:[\s]|$)/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*dictcheck[\s]*=[\s]*(-?\d+)(?:[\s]|$)/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000215005 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238228r653859_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238228r653859_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238228r653859_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must be configured so that when passwords are changed or new passwords are established, pwquality must be used.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. "pwquality" enforces complex password construction configuration and has the ability to limit brute-force attacks on the system.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000366</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "CM-6 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238228r653859_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238228r653859_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238228r653859_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238228r653859_rule" do
  title "The Ubuntu operating system must be configured so that when passwords are changed or new passwords are established, pwquality must be used."
  desc  "
    Vulnerability Discussion: Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \"pwquality\" enforces complex password construction configuration and has the ability to limit brute-force attacks on the system.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000366"
  tag nist: ["NIST SP 800-53", "3", "CM-6 b"]
  tag nist: ["NIST SP 800-53A", "1", "CM-6.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "CM-6 b"]
  describe package("libpam-pwquality") do
    it { should be_installed }
  end
  describe file("/etc/security/pwquality.conf") do
    its("content") { should match(/^\s*enforcing[\s]*=[\s]*(\d+)(?:[\s]|$)/) }
  end
  file("/etc/security/pwquality.conf").content.to_s.scan(/^\s*enforcing[\s]*=[\s]*(\d+)(?:[\s]|$)/).flatten.each do |entry|
    describe entry do
      it { should cmp == 1 }
    end
  end
  describe file("/etc/pam.d/common-password") do
    its("content") { should match(/^\s*\w+[\s]+requisite[\s]+pam_pwquality\.so[\s]+(?:|.+\s+)retry=([\d]+)(?:[\s]|$)/) }
  end
  file("/etc/pam.d/common-password").content.to_s.scan(/^\s*\w+[\s]+requisite[\s]+pam_pwquality\.so[\s]+(?:|.+\s+)retry=([\d]+)(?:[\s]|$)/).flatten.each do |entry|
    describe entry do
      it { should cmp <= 3 }
    end
  end
  file("/etc/pam.d/common-password").content.to_s.scan(/^\s*\w+[\s]+requisite[\s]+pam_pwquality\.so[\s]+(?:|.+\s+)retry=([\d]+)(?:[\s]|$)/).flatten.each do |entry|
    describe entry do
      it { should cmp > 0 }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-System_Package_libpam_pwquality">
  <h4 class="resource-title">Resource <code>System Package libpam-pwquality</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to be installed</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected that `System Package libpam-pwquality` is installed</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.02937957 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_security_pwquality_conf">
  <h4 class="resource-title">Resource <code>File /etc/security/pwquality.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*enforcing[\s]*=[\s]*(\d+)(?:[\s]|$)/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*enforcing[\s]*=[\s]*(\d+)(?:[\s]|$)/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000414178 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_pam_d_common_password">
  <h4 class="resource-title">Resource <code>File /etc/pam.d/common-password</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*\w+[\s]+requisite[\s]+pam_pwquality\.so[\s]+(?:|.+\s+)retry=([\d]+)(?:[\s]|$)/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "#\n# /etc/pam.d/common-password - password-related modules common to all services\n#\n# This file is...and here are more per-package modules (the \"Additional\" block)\n# end of pam-auth-update config\n" to match /^\s*\w+[\s]+requisite[\s]+pam_pwquality\.so[\s]+(?:|.+\s+)retry=([\d]+)(?:[\s]|$)/
Diff:
@@ -1,2 +1,34 @@
-/^\s*\w+[\s]+requisite[\s]+pam_pwquality\.so[\s]+(?:|.+\s+)retry=([\d]+)(?:[\s]|$)/
+#
+# /etc/pam.d/common-password - password-related modules common to all services
+#
+# This file is included from other service-specific PAM config files,
+# and should contain a list of modules that define the services to be
+# used to change user passwords.  The default is pam_unix.
+
+# Explanation of pam_unix options:
+#
+# The "sha512" option enables salted SHA512 passwords.  Without this option,
+# the default is Unix crypt.  Prior releases used the option "md5".
+#
+# The "obscure" option replaces the old `OBSCURE_CHECKS_ENAB' option in
+# login.defs.
+#
+# See the pam_unix manpage for other options.
+
+# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.
+# To take advantage of this, it is recommended that you configure any
+# local modules either before or after the default block, and use
+# pam-auth-update to manage selection of other modules.  See
+# pam-auth-update(8) for details.
+
+# here are the per-package modules (the "Primary" block)
+password	[success=1 default=ignore]	pam_unix.so obscure sha512
+# here's the fallback if no module succeeds
+password	requisite			pam_deny.so
+# prime the stack with a positive return value if there isn't one already;
+# this avoids us returning an error just because nothing sets a success code
+# since the modules above will each just jump around
+password	required			pam_permit.so
+# and here are more per-package modules (the "Additional" block)
+# end of pam-auth-update config
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.001188062 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238229r653862_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238229r653862_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238229r653862_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system, for PKI-based authentication, must validate certificates by constructing a certification path (which includes status information) to an accepted trust anchor.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without path validation, an informed trust decision by the relying party cannot be made when presented with any certificate not already explicitly trusted.

A trust anchor is an authoritative entity represented via a public key and associated data. It is used in the context of public key infrastructures, X.509 digital certificates, and DNSSEC.

When there is a chain of trust, usually the top entity to be trusted becomes the trust anchor; it can be, for example, a Certification Authority (CA). A certification path starts with the subject certificate and proceeds through a number of intermediate certificates up to a trusted root certificate, typically issued by a trusted CA.

This requirement verifies that a certification path to an accepted trust anchor is used for certificate validation and that the path includes status information. Path validation is necessary for a relying party to make an informed trust decision when presented with any certificate not already explicitly trusted. Status information for certification paths includes certificate revocation lists or online certificate status protocol responses. Validation of the certificate status information is out of scope for this requirement.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000185</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-5 (2) (a)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238229r653862_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238229r653862_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238229r653862_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238229r653862_rule" do
  title "The Ubuntu operating system, for PKI-based authentication, must validate certificates by constructing a certification path (which includes status information) to an accepted trust anchor."
  desc  "
    Vulnerability Discussion: Without path validation, an informed trust decision by the relying party cannot be made when presented with any certificate not already explicitly trusted.
    
    A trust anchor is an authoritative entity represented via a public key and associated data. It is used in the context of public key infrastructures, X.509 digital certificates, and DNSSEC.
    
    When there is a chain of trust, usually the top entity to be trusted becomes the trust anchor; it can be, for example, a Certification Authority (CA). A certification path starts with the subject certificate and proceeds through a number of intermediate certificates up to a trusted root certificate, typically issued by a trusted CA.
    
    This requirement verifies that a certification path to an accepted trust anchor is used for certificate validation and that the path includes status information. Path validation is necessary for a relying party to make an informed trust decision when presented with any certificate not already explicitly trusted. Status information for certification paths includes certificate revocation lists or online certificate status protocol responses. Validation of the certificate status information is out of scope for this requirement.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000185"
  tag nist: ["NIST SP 800-53", "3", "IA-5 (2)"]
  tag nist: ["NIST SP 800-53A", "1", "IA-5 (2).1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-5 (2) (a)"]
  describe file("/etc/pam_pkcs11/pam_pkcs11.conf") do
    its("content") { should match(/^\s*cert_policy\s*=\s*([\w\,"' ]+);\s*$/) }
  end
  file("/etc/pam_pkcs11/pam_pkcs11.conf").content.to_s.scan(/^\s*cert_policy\s*=\s*([\w\,"' ]+);\s*$/).flatten.each do |entry|
    describe entry do
      it { should match(/ca/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_pam_pkcs11_pam_pkcs11_conf">
  <h4 class="resource-title">Resource <code>File /etc/pam_pkcs11/pam_pkcs11.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*cert_policy\s*=\s*([\w\,"' ]+);\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*cert_policy\s*=\s*([\w\,"' ]+);\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000290101 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238230r653865_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238230r653865_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238230r653865_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must implement multifactor authentication for remote access to privileged accounts in such a way that one of the factors is provided by a device separate from the system gaining access.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Using an authentication device, such as a CAC or token that is separate from the information system, ensures that even if the information system is compromised, that compromise will not affect credentials stored on the authentication device.

Multifactor solutions that require devices separate from information systems gaining access include, for example, hardware tokens providing time-based or challenge-response authenticators and smart cards such as the U.S. Government Personal Identity Verification card and the DoD Common Access Card.

A privileged account is defined as an information system account with authorizations of a privileged user.

Remote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.

This requirement only applies to components where this is specific to the function of the device or has the concept of an organizational user (e.g., VPN, proxy capability). This does not apply to authentication for the purpose of configuring the device itself (management).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001948</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-2 (11)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238230r653865_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238230r653865_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238230r653865_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238230r653865_rule" do
  title "The Ubuntu operating system must implement multifactor authentication for remote access to privileged accounts in such a way that one of the factors is provided by a device separate from the system gaining access."
  desc  "
    Vulnerability Discussion: Using an authentication device, such as a CAC or token that is separate from the information system, ensures that even if the information system is compromised, that compromise will not affect credentials stored on the authentication device.
    
    Multifactor solutions that require devices separate from information systems gaining access include, for example, hardware tokens providing time-based or challenge-response authenticators and smart cards such as the U.S. Government Personal Identity Verification card and the DoD Common Access Card.
    
    A privileged account is defined as an information system account with authorizations of a privileged user.
    
    Remote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.
    
    This requirement only applies to components where this is specific to the function of the device or has the concept of an organizational user (e.g., VPN, proxy capability). This does not apply to authentication for the purpose of configuring the device itself (management).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001948"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-2 (11)"]
  describe package("libpam-pkcs11") do
    it { should be_installed }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-System_Package_libpam_pkcs11">
  <h4 class="resource-title">Resource <code>System Package libpam-pkcs11</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to be installed</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected that `System Package libpam-pkcs11` is installed</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000443628 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238231r653868_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238231r653868_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238231r653868_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must accept Personal Identity Verification (PIV) credentials.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: The use of PIV credentials facilitates standardization and reduces the risk of unauthorized access.

DoD has mandated the use of the CAC to support identity management and personal authentication for systems covered under Homeland Security Presidential Directive (HSPD) 12, as well as making the CAC a primary component of layered protection for national security systems.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001953</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-2 (12)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238231r653868_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238231r653868_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238231r653868_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238231r653868_rule" do
  title "The Ubuntu operating system must accept Personal Identity Verification (PIV) credentials."
  desc  "
    Vulnerability Discussion: The use of PIV credentials facilitates standardization and reduces the risk of unauthorized access.
    
    DoD has mandated the use of the CAC to support identity management and personal authentication for systems covered under Homeland Security Presidential Directive (HSPD) 12, as well as making the CAC a primary component of layered protection for national security systems.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001953"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-2 (12)"]
  describe package("opensc-pkcs11") do
    it { should be_installed }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-System_Package_opensc_pkcs11">
  <h4 class="resource-title">Resource <code>System Package opensc-pkcs11</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to be installed</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected that `System Package opensc-pkcs11` is installed</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.063100425 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238232r653871_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238232r653871_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238232r653871_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must electronically verify Personal Identity Verification (PIV) credentials.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: The use of PIV credentials facilitates standardization and reduces the risk of unauthorized access.

DoD has mandated the use of the CAC to support identity management and personal authentication for systems covered under Homeland Security Presidential Directive (HSPD) 12, as well as making the CAC a primary component of layered protection for national security systems.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001954</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-2 (12)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238232r653871_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238232r653871_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238232r653871_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238232r653871_rule" do
  title "The Ubuntu operating system must electronically verify Personal Identity Verification (PIV) credentials."
  desc  "
    Vulnerability Discussion: The use of PIV credentials facilitates standardization and reduces the risk of unauthorized access.
    
    DoD has mandated the use of the CAC to support identity management and personal authentication for systems covered under Homeland Security Presidential Directive (HSPD) 12, as well as making the CAC a primary component of layered protection for national security systems.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001954"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-2 (12)"]
  describe file("/etc/pam_pkcs11/pam_pkcs11.conf") do
    its("content") { should match(/^\s*cert_policy\s*=\s*([\w\,"' ]+);\s*$/) }
  end
  file("/etc/pam_pkcs11/pam_pkcs11.conf").content.to_s.scan(/^\s*cert_policy\s*=\s*([\w\,"' ]+);\s*$/).flatten.each do |entry|
    describe entry do
      it { should match(/ocsp_on/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_pam_pkcs11_pam_pkcs11_conf">
  <h4 class="resource-title">Resource <code>File /etc/pam_pkcs11/pam_pkcs11.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*cert_policy\s*=\s*([\w\,"' ]+);\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*cert_policy\s*=\s*([\w\,"' ]+);\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000772455 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238233r653874_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238233r653874_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238233r653874_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system for PKI-based authentication, must implement a local cache of revocation data in case of the inability to access revocation information via the network.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without configuring a local cache of revocation data, there is the potential to allow access to users who are no longer authorized (users with revoked certificates).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001991</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-5 (2) (d)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238233r653874_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238233r653874_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238233r653874_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238233r653874_rule" do
  title "The Ubuntu operating system for PKI-based authentication, must implement a local cache of revocation data in case of the inability to access revocation information via the network."
  desc  "
    Vulnerability Discussion: Without configuring a local cache of revocation data, there is the potential to allow access to users who are no longer authorized (users with revoked certificates).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001991"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-5 (2) (d)"]
  describe file("/etc/pam_pkcs11/pam_pkcs11.conf") do
    its("content") { should match(/^\s*cert_policy\s*=\s*([\w\,"' ]+);\s*$/) }
  end
  file("/etc/pam_pkcs11/pam_pkcs11.conf").content.to_s.scan(/^\s*cert_policy\s*=\s*([\w\,"' ]+);\s*$/).flatten.each do |entry|
    describe entry do
      it { should match(/(crl_offline|crl_auto)/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_pam_pkcs11_pam_pkcs11_conf">
  <h4 class="resource-title">Resource <code>File /etc/pam_pkcs11/pam_pkcs11.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*cert_policy\s*=\s*([\w\,"' ]+);\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*cert_policy\s*=\s*([\w\,"' ]+);\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000753625 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238235r802383_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238235r802383_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238235r802383_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must automatically lock an account until the locked account is released by an administrator when three unsuccessful logon attempts have been made.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced. Limits are imposed by locking the account.

Satisfies: SRG-OS-000329-GPOS-00128, SRG-OS-000021-GPOS-00005

Documentable: false</td></tr> 
    <tr class="impact impact-low"><th>Impact:</th><td>0.1</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-002238</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AC-7 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238235r802383_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238235r802383_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238235r802383_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238235r802383_rule" do
  title "The Ubuntu operating system must automatically lock an account until the locked account is released by an administrator when three unsuccessful logon attempts have been made."
  desc  "
    Vulnerability Discussion: By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced. Limits are imposed by locking the account.
    
    Satisfies: SRG-OS-000329-GPOS-00128, SRG-OS-000021-GPOS-00005
    
    Documentable: false
    
  "
  impact 0.1
  tag cci: "CCI-000044"
  tag nist: ["NIST SP 800-53", "3", "AC-7 a"]
  tag nist: ["NIST SP 800-53A", "1", "AC-7.1 (ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-7 a"]
  tag cci: "CCI-002238"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-7 b"]
  describe file("/etc/pam.d/common-auth") do
    its("content") { should match(/^\s*auth\s+\[default=die\]\s+pam_faillock\.so\s+authfail\s*$/) }
  end
  describe file("/etc/pam.d/common-auth") do
    its("content") { should match(/^\s*auth\s+sufficient\s+pam_faillock\.so\s+authsucc\s*$/) }
  end
  describe file("/etc/security/faillock.conf") do
    its("content") { should match(/^\s*audit\s*$/) }
  end
  describe file("/etc/security/faillock.conf") do
    its("content") { should match(/^\s*silent\s*$/) }
  end
  describe file("/etc/security/faillock.conf") do
    its("content") { should match(/^\s*deny\s*=\s*([0-9]+)+\s*$/) }
  end
  file("/etc/security/faillock.conf").content.to_s.scan(/^\s*deny\s*=\s*([0-9]+)+\s*$/).flatten.each do |entry|
    describe entry do
      it { should cmp <= 3 }
    end
  end
  describe file("/etc/security/faillock.conf") do
    its("content") { should match(/^\s*fail_interval\s*=\s*([0-9]+)+\s*$/) }
  end
  file("/etc/security/faillock.conf").content.to_s.scan(/^\s*fail_interval\s*=\s*([0-9]+)+\s*$/).flatten.each do |entry|
    describe entry do
      it { should cmp <= 900 }
    end
  end
  describe file("/etc/security/faillock.conf") do
    its("content") { should match(/^\s*unlock_time\s*=\s*([0-9]+)+\s*$/) }
  end
  file("/etc/security/faillock.conf").content.to_s.scan(/^\s*unlock_time\s*=\s*([0-9]+)+\s*$/).flatten.each do |entry|
    describe entry do
      it { should cmp == 0 }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_pam_d_common_auth">
  <h4 class="resource-title">Resource <code>File /etc/pam.d/common-auth</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*auth\s+\[default=die\]\s+pam_faillock\.so\s+authfail\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "#\n# /etc/pam.d/common-auth - authentication settings common to all services\n#\n# This file is incl...ules (the \"Additional\" block)\nauth\toptional\t\t\tpam_cap.so \n# end of pam-auth-update config\n" to match /^\s*auth\s+\[default=die\]\s+pam_faillock\.so\s+authfail\s*$/
Diff:
@@ -1,2 +1,27 @@
-/^\s*auth\s+\[default=die\]\s+pam_faillock\.so\s+authfail\s*$/
+#
+# /etc/pam.d/common-auth - authentication settings common to all services
+#
+# This file is included from other service-specific PAM config files,
+# and should contain a list of the authentication modules that define
+# the central authentication scheme for use on the system
+# (e.g., /etc/shadow, LDAP, Kerberos, etc.).  The default is to use the
+# traditional Unix authentication mechanisms.
+#
+# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.
+# To take advantage of this, it is recommended that you configure any
+# local modules either before or after the default block, and use
+# pam-auth-update to manage selection of other modules.  See
+# pam-auth-update(8) for details.
+
+# here are the per-package modules (the "Primary" block)
+auth	[success=1 default=ignore]	pam_unix.so nullok
+# here's the fallback if no module succeeds
+auth	requisite			pam_deny.so
+# prime the stack with a positive return value if there isn't one already;
+# this avoids us returning an error just because nothing sets a success code
+# since the modules above will each just jump around
+auth	required			pam_permit.so
+# and here are more per-package modules (the "Additional" block)
+auth	optional			pam_cap.so 
+# end of pam-auth-update config
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00104793 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_pam_d_common_auth">
  <h4 class="resource-title">Resource <code>File /etc/pam.d/common-auth</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*auth\s+sufficient\s+pam_faillock\.so\s+authsucc\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "#\n# /etc/pam.d/common-auth - authentication settings common to all services\n#\n# This file is incl...ules (the \"Additional\" block)\nauth\toptional\t\t\tpam_cap.so \n# end of pam-auth-update config\n" to match /^\s*auth\s+sufficient\s+pam_faillock\.so\s+authsucc\s*$/
Diff:
@@ -1,2 +1,27 @@
-/^\s*auth\s+sufficient\s+pam_faillock\.so\s+authsucc\s*$/
+#
+# /etc/pam.d/common-auth - authentication settings common to all services
+#
+# This file is included from other service-specific PAM config files,
+# and should contain a list of the authentication modules that define
+# the central authentication scheme for use on the system
+# (e.g., /etc/shadow, LDAP, Kerberos, etc.).  The default is to use the
+# traditional Unix authentication mechanisms.
+#
+# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.
+# To take advantage of this, it is recommended that you configure any
+# local modules either before or after the default block, and use
+# pam-auth-update to manage selection of other modules.  See
+# pam-auth-update(8) for details.
+
+# here are the per-package modules (the "Primary" block)
+auth	[success=1 default=ignore]	pam_unix.so nullok
+# here's the fallback if no module succeeds
+auth	requisite			pam_deny.so
+# prime the stack with a positive return value if there isn't one already;
+# this avoids us returning an error just because nothing sets a success code
+# since the modules above will each just jump around
+auth	required			pam_permit.so
+# and here are more per-package modules (the "Additional" block)
+auth	optional			pam_cap.so 
+# end of pam-auth-update config
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000938687 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_security_faillock_conf">
  <h4 class="resource-title">Resource <code>File /etc/security/faillock.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*audit\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "# Configuration for locking the user after multiple failed\n# authentication attempts.\n#\n# The dir...me` will apply to them.\n# By default, the option is not set.\n# admin_group = <admin_group_name>\n" to match /^\s*audit\s*$/
Diff:
@@ -1,2 +1,63 @@
-/^\s*audit\s*$/
+# Configuration for locking the user after multiple failed
+# authentication attempts.
+#
+# The directory where the user files with the failure records are kept.
+# The default is /var/run/faillock.
+# dir = /var/run/faillock
+#
+# Will log the user name into the system log if the user is not found.
+# Enabled if option is present.
+# audit
+#
+# Don't print informative messages.
+# Enabled if option is present.
+# silent
+#
+# Don't log informative messages via syslog.
+# Enabled if option is present.
+# no_log_info
+#
+# Only track failed user authentications attempts for local users
+# in /etc/passwd and ignore centralized (AD, IdM, LDAP, etc.) users.
+# The `faillock` command will also no longer track user failed
+# authentication attempts. Enabling this option will prevent a
+# double-lockout scenario where a user is locked out locally and
+# in the centralized mechanism.
+# Enabled if option is present.
+# local_users_only
+#
+# Deny access if the number of consecutive authentication failures
+# for this user during the recent interval exceeds n tries.
+# The default is 3.
+# deny = 3
+#
+# The length of the interval during which the consecutive
+# authentication failures must happen for the user account
+# lock out is <replaceable>n</replaceable> seconds.
+# The default is 900 (15 minutes).
+# fail_interval = 900
+#
+# The access will be re-enabled after n seconds after the lock out.
+# The value 0 has the same meaning as value `never` - the access
+# will not be re-enabled without resetting the faillock
+# entries by the `faillock` command.
+# The default is 600 (10 minutes).
+# unlock_time = 600
+#
+# Root account can become locked as well as regular accounts.
+# Enabled if option is present.
+# even_deny_root
+#
+# This option implies the `even_deny_root` option.
+# Allow access after n seconds to root account after the
+# account is locked. In case the option is not specified
+# the value is the same as of the `unlock_time` option.
+# root_unlock_time = 900
+#
+# If a group name is specified with this option, members
+# of the group will be handled by this module the same as
+# the root account (the options `even_deny_root>` and
+# `root_unlock_time` will apply to them.
+# By default, the option is not set.
+# admin_group = <admin_group_name>
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.001283534 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_security_faillock_conf">
  <h4 class="resource-title">Resource <code>File /etc/security/faillock.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*silent\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "# Configuration for locking the user after multiple failed\n# authentication attempts.\n#\n# The dir...me` will apply to them.\n# By default, the option is not set.\n# admin_group = <admin_group_name>\n" to match /^\s*silent\s*$/
Diff:
@@ -1,2 +1,63 @@
-/^\s*silent\s*$/
+# Configuration for locking the user after multiple failed
+# authentication attempts.
+#
+# The directory where the user files with the failure records are kept.
+# The default is /var/run/faillock.
+# dir = /var/run/faillock
+#
+# Will log the user name into the system log if the user is not found.
+# Enabled if option is present.
+# audit
+#
+# Don't print informative messages.
+# Enabled if option is present.
+# silent
+#
+# Don't log informative messages via syslog.
+# Enabled if option is present.
+# no_log_info
+#
+# Only track failed user authentications attempts for local users
+# in /etc/passwd and ignore centralized (AD, IdM, LDAP, etc.) users.
+# The `faillock` command will also no longer track user failed
+# authentication attempts. Enabling this option will prevent a
+# double-lockout scenario where a user is locked out locally and
+# in the centralized mechanism.
+# Enabled if option is present.
+# local_users_only
+#
+# Deny access if the number of consecutive authentication failures
+# for this user during the recent interval exceeds n tries.
+# The default is 3.
+# deny = 3
+#
+# The length of the interval during which the consecutive
+# authentication failures must happen for the user account
+# lock out is <replaceable>n</replaceable> seconds.
+# The default is 900 (15 minutes).
+# fail_interval = 900
+#
+# The access will be re-enabled after n seconds after the lock out.
+# The value 0 has the same meaning as value `never` - the access
+# will not be re-enabled without resetting the faillock
+# entries by the `faillock` command.
+# The default is 600 (10 minutes).
+# unlock_time = 600
+#
+# Root account can become locked as well as regular accounts.
+# Enabled if option is present.
+# even_deny_root
+#
+# This option implies the `even_deny_root` option.
+# Allow access after n seconds to root account after the
+# account is locked. In case the option is not specified
+# the value is the same as of the `unlock_time` option.
+# root_unlock_time = 900
+#
+# If a group name is specified with this option, members
+# of the group will be handled by this module the same as
+# the root account (the options `even_deny_root>` and
+# `root_unlock_time` will apply to them.
+# By default, the option is not set.
+# admin_group = <admin_group_name>
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.001474454 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_security_faillock_conf">
  <h4 class="resource-title">Resource <code>File /etc/security/faillock.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*deny\s*=\s*([0-9]+)+\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "# Configuration for locking the user after multiple failed\n# authentication attempts.\n#\n# The dir...me` will apply to them.\n# By default, the option is not set.\n# admin_group = <admin_group_name>\n" to match /^\s*deny\s*=\s*([0-9]+)+\s*$/
Diff:
@@ -1,2 +1,63 @@
-/^\s*deny\s*=\s*([0-9]+)+\s*$/
+# Configuration for locking the user after multiple failed
+# authentication attempts.
+#
+# The directory where the user files with the failure records are kept.
+# The default is /var/run/faillock.
+# dir = /var/run/faillock
+#
+# Will log the user name into the system log if the user is not found.
+# Enabled if option is present.
+# audit
+#
+# Don't print informative messages.
+# Enabled if option is present.
+# silent
+#
+# Don't log informative messages via syslog.
+# Enabled if option is present.
+# no_log_info
+#
+# Only track failed user authentications attempts for local users
+# in /etc/passwd and ignore centralized (AD, IdM, LDAP, etc.) users.
+# The `faillock` command will also no longer track user failed
+# authentication attempts. Enabling this option will prevent a
+# double-lockout scenario where a user is locked out locally and
+# in the centralized mechanism.
+# Enabled if option is present.
+# local_users_only
+#
+# Deny access if the number of consecutive authentication failures
+# for this user during the recent interval exceeds n tries.
+# The default is 3.
+# deny = 3
+#
+# The length of the interval during which the consecutive
+# authentication failures must happen for the user account
+# lock out is <replaceable>n</replaceable> seconds.
+# The default is 900 (15 minutes).
+# fail_interval = 900
+#
+# The access will be re-enabled after n seconds after the lock out.
+# The value 0 has the same meaning as value `never` - the access
+# will not be re-enabled without resetting the faillock
+# entries by the `faillock` command.
+# The default is 600 (10 minutes).
+# unlock_time = 600
+#
+# Root account can become locked as well as regular accounts.
+# Enabled if option is present.
+# even_deny_root
+#
+# This option implies the `even_deny_root` option.
+# Allow access after n seconds to root account after the
+# account is locked. In case the option is not specified
+# the value is the same as of the `unlock_time` option.
+# root_unlock_time = 900
+#
+# If a group name is specified with this option, members
+# of the group will be handled by this module the same as
+# the root account (the options `even_deny_root>` and
+# `root_unlock_time` will apply to them.
+# By default, the option is not set.
+# admin_group = <admin_group_name>
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00155584 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_security_faillock_conf">
  <h4 class="resource-title">Resource <code>File /etc/security/faillock.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*fail_interval\s*=\s*([0-9]+)+\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "# Configuration for locking the user after multiple failed\n# authentication attempts.\n#\n# The dir...me` will apply to them.\n# By default, the option is not set.\n# admin_group = <admin_group_name>\n" to match /^\s*fail_interval\s*=\s*([0-9]+)+\s*$/
Diff:
@@ -1,2 +1,63 @@
-/^\s*fail_interval\s*=\s*([0-9]+)+\s*$/
+# Configuration for locking the user after multiple failed
+# authentication attempts.
+#
+# The directory where the user files with the failure records are kept.
+# The default is /var/run/faillock.
+# dir = /var/run/faillock
+#
+# Will log the user name into the system log if the user is not found.
+# Enabled if option is present.
+# audit
+#
+# Don't print informative messages.
+# Enabled if option is present.
+# silent
+#
+# Don't log informative messages via syslog.
+# Enabled if option is present.
+# no_log_info
+#
+# Only track failed user authentications attempts for local users
+# in /etc/passwd and ignore centralized (AD, IdM, LDAP, etc.) users.
+# The `faillock` command will also no longer track user failed
+# authentication attempts. Enabling this option will prevent a
+# double-lockout scenario where a user is locked out locally and
+# in the centralized mechanism.
+# Enabled if option is present.
+# local_users_only
+#
+# Deny access if the number of consecutive authentication failures
+# for this user during the recent interval exceeds n tries.
+# The default is 3.
+# deny = 3
+#
+# The length of the interval during which the consecutive
+# authentication failures must happen for the user account
+# lock out is <replaceable>n</replaceable> seconds.
+# The default is 900 (15 minutes).
+# fail_interval = 900
+#
+# The access will be re-enabled after n seconds after the lock out.
+# The value 0 has the same meaning as value `never` - the access
+# will not be re-enabled without resetting the faillock
+# entries by the `faillock` command.
+# The default is 600 (10 minutes).
+# unlock_time = 600
+#
+# Root account can become locked as well as regular accounts.
+# Enabled if option is present.
+# even_deny_root
+#
+# This option implies the `even_deny_root` option.
+# Allow access after n seconds to root account after the
+# account is locked. In case the option is not specified
+# the value is the same as of the `unlock_time` option.
+# root_unlock_time = 900
+#
+# If a group name is specified with this option, members
+# of the group will be handled by this module the same as
+# the root account (the options `even_deny_root>` and
+# `root_unlock_time` will apply to them.
+# By default, the option is not set.
+# admin_group = <admin_group_name>
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.001527442 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_security_faillock_conf">
  <h4 class="resource-title">Resource <code>File /etc/security/faillock.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*unlock_time\s*=\s*([0-9]+)+\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "# Configuration for locking the user after multiple failed\n# authentication attempts.\n#\n# The dir...me` will apply to them.\n# By default, the option is not set.\n# admin_group = <admin_group_name>\n" to match /^\s*unlock_time\s*=\s*([0-9]+)+\s*$/
Diff:
@@ -1,2 +1,63 @@
-/^\s*unlock_time\s*=\s*([0-9]+)+\s*$/
+# Configuration for locking the user after multiple failed
+# authentication attempts.
+#
+# The directory where the user files with the failure records are kept.
+# The default is /var/run/faillock.
+# dir = /var/run/faillock
+#
+# Will log the user name into the system log if the user is not found.
+# Enabled if option is present.
+# audit
+#
+# Don't print informative messages.
+# Enabled if option is present.
+# silent
+#
+# Don't log informative messages via syslog.
+# Enabled if option is present.
+# no_log_info
+#
+# Only track failed user authentications attempts for local users
+# in /etc/passwd and ignore centralized (AD, IdM, LDAP, etc.) users.
+# The `faillock` command will also no longer track user failed
+# authentication attempts. Enabling this option will prevent a
+# double-lockout scenario where a user is locked out locally and
+# in the centralized mechanism.
+# Enabled if option is present.
+# local_users_only
+#
+# Deny access if the number of consecutive authentication failures
+# for this user during the recent interval exceeds n tries.
+# The default is 3.
+# deny = 3
+#
+# The length of the interval during which the consecutive
+# authentication failures must happen for the user account
+# lock out is <replaceable>n</replaceable> seconds.
+# The default is 900 (15 minutes).
+# fail_interval = 900
+#
+# The access will be re-enabled after n seconds after the lock out.
+# The value 0 has the same meaning as value `never` - the access
+# will not be re-enabled without resetting the faillock
+# entries by the `faillock` command.
+# The default is 600 (10 minutes).
+# unlock_time = 600
+#
+# Root account can become locked as well as regular accounts.
+# Enabled if option is present.
+# even_deny_root
+#
+# This option implies the `even_deny_root` option.
+# Allow access after n seconds to root account after the
+# account is locked. In case the option is not specified
+# the value is the same as of the `unlock_time` option.
+# root_unlock_time = 900
+#
+# If a group name is specified with this option, members
+# of the group will be handled by this module the same as
+# the root account (the options `even_deny_root>` and
+# `root_unlock_time` will apply to them.
+# By default, the option is not set.
+# admin_group = <admin_group_name>
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.001207044 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238237r653886_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238237r653886_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238237r653886_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must enforce a delay of at least 4 seconds between logon prompts following a failed logon attempt.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Limiting the number of logon attempts over a certain time interval reduces the chances that an unauthorized user may gain access to an account.

Documentable: false</td></tr> 
    <tr class="impact impact-low"><th>Impact:</th><td>0.1</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000366</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "CM-6 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238237r653886_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238237r653886_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238237r653886_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238237r653886_rule" do
  title "The Ubuntu operating system must enforce a delay of at least 4 seconds between logon prompts following a failed logon attempt."
  desc  "
    Vulnerability Discussion: Limiting the number of logon attempts over a certain time interval reduces the chances that an unauthorized user may gain access to an account.
    
    Documentable: false
    
  "
  impact 0.1
  tag cci: "CCI-000366"
  tag nist: ["NIST SP 800-53", "3", "CM-6 b"]
  tag nist: ["NIST SP 800-53A", "1", "CM-6.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "CM-6 b"]
  describe file("/etc/pam.d/common-auth") do
    its("content") { should match(/^\s*auth\s+required\s+pam_faildelay\.so\s+delay=(\d+)\s*(?:#.*)?$/) }
  end
  file("/etc/pam.d/common-auth").content.to_s.scan(/^\s*auth\s+required\s+pam_faildelay\.so\s+delay=(\d+)\s*(?:#.*)?$/).flatten.each do |entry|
    describe entry do
      it { should cmp >= 4000000 }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_pam_d_common_auth">
  <h4 class="resource-title">Resource <code>File /etc/pam.d/common-auth</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*auth\s+required\s+pam_faildelay\.so\s+delay=(\d+)\s*(?:#.*)?$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "#\n# /etc/pam.d/common-auth - authentication settings common to all services\n#\n# This file is incl...ules (the \"Additional\" block)\nauth\toptional\t\t\tpam_cap.so \n# end of pam-auth-update config\n" to match /^\s*auth\s+required\s+pam_faildelay\.so\s+delay=(\d+)\s*(?:#.*)?$/
Diff:
@@ -1,2 +1,27 @@
-/^\s*auth\s+required\s+pam_faildelay\.so\s+delay=(\d+)\s*(?:#.*)?$/
+#
+# /etc/pam.d/common-auth - authentication settings common to all services
+#
+# This file is included from other service-specific PAM config files,
+# and should contain a list of the authentication modules that define
+# the central authentication scheme for use on the system
+# (e.g., /etc/shadow, LDAP, Kerberos, etc.).  The default is to use the
+# traditional Unix authentication mechanisms.
+#
+# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.
+# To take advantage of this, it is recommended that you configure any
+# local modules either before or after the default block, and use
+# pam-auth-update to manage selection of other modules.  See
+# pam-auth-update(8) for details.
+
+# here are the per-package modules (the "Primary" block)
+auth	[success=1 default=ignore]	pam_unix.so nullok
+# here's the fallback if no module succeeds
+auth	requisite			pam_deny.so
+# prime the stack with a positive return value if there isn't one already;
+# this avoids us returning an error just because nothing sets a success code
+# since the modules above will each just jump around
+auth	required			pam_permit.so
+# and here are more per-package modules (the "Additional" block)
+auth	optional			pam_cap.so 
+# end of pam-auth-update config
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.001215661 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238238r653889_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238238r653889_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238238r653889_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/passwd.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.

To address access requirements, many operating systems may be integrated with enterprise level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.

Satisfies: SRG-OS-000004-GPOS-00004, SRG-OS-000239-GPOS-00089, SRG-OS-000240-GPOS-00090, SRG-OS-000241-GPOS-00091, SRG-OS-000303-GPOS-00120, SRG-OS-000458-GPOS-00203, SRG-OS-000463-GPOS-00207, SRG-OS-000476-GPOS-00221

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-002130</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238238r653889_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238238r653889_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238238r653889_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238238r653889_rule" do
  title "The Ubuntu operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/passwd."
  desc  "
    Vulnerability Discussion: Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.
    
    To address access requirements, many operating systems may be integrated with enterprise level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.
    
    Satisfies: SRG-OS-000004-GPOS-00004, SRG-OS-000239-GPOS-00089, SRG-OS-000240-GPOS-00090, SRG-OS-000241-GPOS-00091, SRG-OS-000303-GPOS-00120, SRG-OS-000458-GPOS-00203, SRG-OS-000463-GPOS-00207, SRG-OS-000476-GPOS-00221
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000018"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  tag cci: "CCI-001403"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-001404"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-001405"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-002130"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  describe.one do
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-w\s+\/etc\/passwd(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/etc\/passwd\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-w\s+\/etc\/passwd(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-w\s+\/etc\/passwd(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000284945 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/etc\/passwd\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/etc\/passwd\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000424499 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238239r653892_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238239r653892_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238239r653892_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/group.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.

To address access requirements, many operating systems may be integrated with enterprise level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.

Satisfies: SRG-OS-000004-GPOS-00004, SRG-OS-000239-GPOS-00089, SRG-OS-000240-GPOS-00090, SRG-OS-000241-GPOS-00091, SRG-OS-000303-GPOS-00120, SRG-OS-000458-GPOS-00203, SRG-OS-000476-GPOS-00221

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-002130</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238239r653892_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238239r653892_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238239r653892_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238239r653892_rule" do
  title "The Ubuntu operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/group."
  desc  "
    Vulnerability Discussion: Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.
    
    To address access requirements, many operating systems may be integrated with enterprise level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.
    
    Satisfies: SRG-OS-000004-GPOS-00004, SRG-OS-000239-GPOS-00089, SRG-OS-000240-GPOS-00090, SRG-OS-000241-GPOS-00091, SRG-OS-000303-GPOS-00120, SRG-OS-000458-GPOS-00203, SRG-OS-000476-GPOS-00221
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000018"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  tag cci: "CCI-001403"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-001404"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-001405"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-002130"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  describe.one do
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-w\s+\/etc\/group(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/etc\/group\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-w\s+\/etc\/group(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-w\s+\/etc\/group(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000273524 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/etc\/group\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/etc\/group\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000216618 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238240r653895_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238240r653895_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238240r653895_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/shadow.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.

To address access requirements, many operating systems may be integrated with enterprise level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.

Satisfies: SRG-OS-000004-GPOS-00004, SRG-OS-000239-GPOS-00089, SRG-OS-000240-GPOS-00090, SRG-OS-000241-GPOS-00091, SRG-OS-000303-GPOS-00120, SRG-OS-000458-GPOS-00203, SRG-OS-000476-GPOS-00221

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-002130</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238240r653895_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238240r653895_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238240r653895_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238240r653895_rule" do
  title "The Ubuntu operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/shadow."
  desc  "
    Vulnerability Discussion: Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.
    
    To address access requirements, many operating systems may be integrated with enterprise level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.
    
    Satisfies: SRG-OS-000004-GPOS-00004, SRG-OS-000239-GPOS-00089, SRG-OS-000240-GPOS-00090, SRG-OS-000241-GPOS-00091, SRG-OS-000303-GPOS-00120, SRG-OS-000458-GPOS-00203, SRG-OS-000476-GPOS-00221
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000018"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  tag cci: "CCI-001403"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-001404"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-001405"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-002130"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  describe.one do
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-w\s+\/etc\/shadow(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/etc\/shadow\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-w\s+\/etc\/shadow(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-w\s+\/etc\/shadow(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000568382 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/etc\/shadow\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/etc\/shadow\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000226125 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238241r653898_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238241r653898_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238241r653898_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/gshadow.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.

To address access requirements, many operating systems may be integrated with enterprise level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.

Satisfies: SRG-OS-000004-GPOS-00004, SRG-OS-000239-GPOS-00089, SRG-OS-000240-GPOS-00090, SRG-OS-000241-GPOS-00091, SRG-OS-000303-GPOS-00120, SRG-OS-000458-GPOS-00203, SRG-OS-000476-GPOS-00221

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-002130</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238241r653898_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238241r653898_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238241r653898_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238241r653898_rule" do
  title "The Ubuntu operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/gshadow."
  desc  "
    Vulnerability Discussion: Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.
    
    To address access requirements, many operating systems may be integrated with enterprise level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.
    
    Satisfies: SRG-OS-000004-GPOS-00004, SRG-OS-000239-GPOS-00089, SRG-OS-000240-GPOS-00090, SRG-OS-000241-GPOS-00091, SRG-OS-000303-GPOS-00120, SRG-OS-000458-GPOS-00203, SRG-OS-000476-GPOS-00221
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  tag cci: "CCI-001403"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-001404"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-001405"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-002130"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  describe.one do
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-w\s+\/etc\/gshadow(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/etc\/gshadow\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-w\s+\/etc\/gshadow(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-w\s+\/etc\/gshadow(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000516671 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/etc\/gshadow\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/etc\/gshadow\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00027605 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238242r653901_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238242r653901_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238242r653901_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/opasswd.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.

To address access requirements, many operating systems may be integrated with enterprise level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.

Satisfies: SRG-OS-000004-GPOS-00004, SRG-OS-000239-GPOS-00089, SRG-OS-000240-GPOS-00090, SRG-OS-000241-GPOS-00091, SRG-OS-000303-GPOS-00120, SRG-OS-000458-GPOS-00203, SRG-OS-000476-GPOS-00221

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-002130</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238242r653901_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238242r653901_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238242r653901_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238242r653901_rule" do
  title "The Ubuntu operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/opasswd."
  desc  "
    Vulnerability Discussion: Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.
    
    To address access requirements, many operating systems may be integrated with enterprise level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.
    
    Satisfies: SRG-OS-000004-GPOS-00004, SRG-OS-000239-GPOS-00089, SRG-OS-000240-GPOS-00090, SRG-OS-000241-GPOS-00091, SRG-OS-000303-GPOS-00120, SRG-OS-000458-GPOS-00203, SRG-OS-000476-GPOS-00221
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000018"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  tag cci: "CCI-001403"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-001404"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-001405"
  tag nist: ["NIST SP 800-53", "3", "AC-2 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AC-2 (4).1 (i and ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  tag cci: "CCI-002130"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-2 (4)"]
  describe.one do
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-w\s+\/etc\/security\/opasswd(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/etc\/security\/opasswd\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-w\s+\/etc\/security\/opasswd(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-w\s+\/etc\/security\/opasswd(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00022745 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/etc\/security\/opasswd\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/etc\/security\/opasswd\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000211279 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238244r653907_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238244r653907_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238244r653907_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must shut down by default upon audit failure (unless availability is an overriding concern).</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: It is critical that when the operating system is at risk of failing to process audit logs as required, it takes action to mitigate the failure. Audit processing failures include: software/hardware errors; failures in the audit capturing mechanisms; and audit storage capacity being reached or exceeded. Responses to audit failure depend upon the nature of the failure mode.

When availability is an overriding concern, other approved actions in response to an audit failure are as follows:

1) If the failure was caused by the lack of audit record storage capacity, the operating system must continue generating audit records if possible (automatically restarting the audit service if necessary), overwriting the oldest audit records in a first-in-first-out manner.

2) If audit records are sent to a centralized collection server and communication with this server is lost or the server fails, the operating system must queue audit records locally until communication is restored or until the audit records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local audit data with the collection server.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000140</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-5 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238244r653907_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238244r653907_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238244r653907_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238244r653907_rule" do
  title "The Ubuntu operating system must shut down by default upon audit failure (unless availability is an overriding concern)."
  desc  "
    Vulnerability Discussion: It is critical that when the operating system is at risk of failing to process audit logs as required, it takes action to mitigate the failure. Audit processing failures include: software/hardware errors; failures in the audit capturing mechanisms; and audit storage capacity being reached or exceeded. Responses to audit failure depend upon the nature of the failure mode.
    
    When availability is an overriding concern, other approved actions in response to an audit failure are as follows:
    
    1) If the failure was caused by the lack of audit record storage capacity, the operating system must continue generating audit records if possible (automatically restarting the audit service if necessary), overwriting the oldest audit records in a first-in-first-out manner.
    
    2) If audit records are sent to a centralized collection server and communication with this server is lost or the server fails, the operating system must queue audit records locally until communication is restored or until the audit records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local audit data with the collection server.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000140"
  tag nist: ["NIST SP 800-53", "3", "AU-5 b"]
  tag nist: ["NIST SP 800-53A", "1", "AU-5.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-5 b"]
  describe file("/etc/audit/auditd.conf") do
    its("content") { should match(/^\s*disk_full_action\s+=\s+(HALT|SYSLOG|SINGLE)\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_auditd_conf">
  <h4 class="resource-title">Resource <code>File /etc/audit/auditd.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*disk_full_action\s+=\s+(HALT|SYSLOG|SINGLE)\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*disk_full_action\s+=\s+(HALT|SYSLOG|SINGLE)\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.065292456 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-passed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238249r653922_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238249r653922_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238249r653922_rule">
  <caption>Control Table</caption>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must be configured so that audit configuration files are not write-accessible by unauthorized users.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events.

Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000171</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238249r653922_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238249r653922_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238249r653922_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238249r653922_rule" do
  title "The Ubuntu operating system must be configured so that audit configuration files are not write-accessible by unauthorized users."
  desc  "
    Vulnerability Discussion: Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events.
    
    Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000171"
  tag nist: ["NIST SP 800-53", "3", "AU-12 b"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 b"]
  command('find /etc/audit/rules.d/ -type f').stdout.split("\n").each do |file|
    describe file(file) do
      it { should_not be_executable.by('owner') }
      it { should_not be_writable.by('group') }
      it { should_not be_executable.by('group') }
      it { should_not be_readable.by('other') }
      it { should_not be_writable.by('other') }
      it { should_not be_executable.by('other') }
    end
  end
  describe file("/etc/audit/audit.rules") do
    it { should_not be_executable.by('owner') }
    it { should_not be_writable.by('group') }
    it { should_not be_executable.by('group') }
    it { should_not be_readable.by('other') }
    it { should_not be_writable.by('other') }
    it { should_not be_executable.by('other') }
  end
  describe file("/etc/audit/auditd.conf") do
    it { should_not be_executable.by('owner') }
    it { should_not be_writable.by('group') }
    it { should_not be_executable.by('group') }
    it { should_not be_readable.by('other') }
    it { should_not be_writable.by('other') }
    it { should_not be_executable.by('other') }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be executable by owner</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.007407396 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be writable by group</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000347123 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be executable by group</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000599347 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be readable by other</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000326658 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be writable by other</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00029417 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be executable by other</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000315555 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_auditd_conf">
  <h4 class="resource-title">Resource <code>File /etc/audit/auditd.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be executable by owner</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.008471969 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_auditd_conf">
  <h4 class="resource-title">Resource <code>File /etc/audit/auditd.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be writable by group</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000392068 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_auditd_conf">
  <h4 class="resource-title">Resource <code>File /etc/audit/auditd.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be executable by group</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000209236 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_auditd_conf">
  <h4 class="resource-title">Resource <code>File /etc/audit/auditd.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be readable by other</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000204982 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_auditd_conf">
  <h4 class="resource-title">Resource <code>File /etc/audit/auditd.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be writable by other</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000330982 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_auditd_conf">
  <h4 class="resource-title">Resource <code>File /etc/audit/auditd.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be executable by other</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000175161 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238250r653925_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238250r653925_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238250r653925_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must permit only authorized accounts to own the audit configuration files.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events.

Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000171</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238250r653925_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238250r653925_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238250r653925_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238250r653925_rule" do
  title "The Ubuntu operating system must permit only authorized accounts to own the audit configuration files."
  desc  "
    Vulnerability Discussion: Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events.
    
    Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000171"
  tag nist: ["NIST SP 800-53", "3", "AU-12 b"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 b"]
  command('find /etc/audit/rules.d/ -type f').stdout.split("\n").each do |file|
    describe file(file) do
      its('owner') { should eq 'root' }
    end
  end
  describe file("/etc/audit/audit.rules") do
    its('owner') { should eq 'root' }
  end
  describe file("/etc/audit/auditd.conf") do
    its('owner') { should eq 'root' }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>owner is expected to eq "root"</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>
expected: "root"
     got: nil

(compared using ==)
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000342275 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_auditd_conf">
  <h4 class="resource-title">Resource <code>File /etc/audit/auditd.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>owner is expected to eq "root"</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>
expected: "root"
     got: nil

(compared using ==)
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000228299 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238251r653928_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238251r653928_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238251r653928_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must permit only authorized groups to own the audit configuration files.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events.

Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000171</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238251r653928_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238251r653928_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238251r653928_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238251r653928_rule" do
  title "The Ubuntu operating system must permit only authorized groups to own the audit configuration files."
  desc  "
    Vulnerability Discussion: Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events.
    
    Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000171"
  tag nist: ["NIST SP 800-53", "3", "AU-12 b"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 b"]
  command('find /etc/audit/rules.d/ -type f').stdout.split("\n").each do |file|
    describe file(file) do
      its('group') { should eq 'root' }
    end
  end
  describe file("/etc/audit/audit.rules") do
    its('group') { should eq 'root' }
  end
  describe file("/etc/audit/auditd.conf") do
    its('group') { should eq 'root' }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>group is expected to eq "root"</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>
expected: "root"
     got: nil

(compared using ==)
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000272762 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_auditd_conf">
  <h4 class="resource-title">Resource <code>File /etc/audit/auditd.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>group is expected to eq "root"</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>
expected: "root"
     got: nil

(compared using ==)
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000324952 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238252r653931_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238252r653931_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238252r653931_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the su command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238252r653931_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238252r653931_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238252r653931_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238252r653931_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the su command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/bin\/su\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/bin\/su\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/bin\/su\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000301998 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238253r653934_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238253r653934_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238253r653934_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the chfn command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238253r653934_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238253r653934_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238253r653934_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238253r653934_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the chfn command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/chfn\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/chfn\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/chfn\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000305348 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238254r653937_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238254r653937_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238254r653937_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the mount command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238254r653937_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238254r653937_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238254r653937_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238254r653937_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the mount command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/mount\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/mount\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/mount\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000285152 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238255r653940_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238255r653940_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238255r653940_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the umount command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238255r653940_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238255r653940_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238255r653940_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238255r653940_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the umount command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/umount\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/umount\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/umount\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000232161 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238256r653943_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238256r653943_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238256r653943_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the ssh-agent command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238256r653943_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238256r653943_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238256r653943_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238256r653943_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the ssh-agent command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/ssh-agent\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/ssh-agent\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/ssh-agent\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000211211 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238257r653946_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238257r653946_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238257r653946_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the ssh-keysign command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238257r653946_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238257r653946_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238257r653946_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238257r653946_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the ssh-keysign command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/lib\/openssh\/ssh-keysign\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/lib\/openssh\/ssh-keysign\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/lib\/openssh\/ssh-keysign\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000207642 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238258r808474_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238258r808474_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238258r808474_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for any use of the setxattr, fsetxattr, lsetxattr, removexattr, fremovexattr, and lremovexattr system calls.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

The system call rules are loaded into a matching engine that intercepts each syscall that all programs on the system makes. Therefore, it is very important to only use syscall rules when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance is helped, though, by combining syscalls into one rule whenever possible.

Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000462-GPOS-00206

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238258r808474_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238258r808474_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238258r808474_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238258r808474_rule" do
  title "The Ubuntu operating system must generate audit records for any use of the setxattr, fsetxattr, lsetxattr, removexattr, fremovexattr, and lremovexattr system calls."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    The system call rules are loaded into a matching engine that intercepts each syscall that all programs on the system makes. Therefore, it is very important to only use syscall rules when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance is helped, though, by combining syscalls into one rule whenever possible.
    
    Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000462-GPOS-00206
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\blsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\blsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\blremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\blremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
  end
  if command('uname -i').stdout.strip == 'x86_64'
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\blsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\blsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\blremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\blremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000261601 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000278995 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\blsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\blsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000207671 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\blsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\blsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000188002 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00018127 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000182132 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000180868 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000275628 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\blremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\blremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000183192 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\blremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\blremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00023546 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000193024 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000187089 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000179179 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000169249 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\blsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\blsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000167495 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\blsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\blsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00016631 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000164977 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfsetxattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000432617 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00018413 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000172957 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\blremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\blremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000200401 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\blremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\blremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00017334 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000169329 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfremovexattr\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid=0(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000167042 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238264r808477_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238264r808477_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238264r808477_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the chown, fchown, fchownat, and lchown system calls.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

The system call rules are loaded into a matching engine that intercepts each syscall that all programs on the system makes. Therefore, it is very important to only use syscall rules when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance is helped, though, by combining syscalls into one rule whenever possible.

Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000462-GPOS-00206

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238264r808477_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238264r808477_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238264r808477_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238264r808477_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the chown, fchown, fchownat, and lchown system calls."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    The system call rules are loaded into a matching engine that intercepts each syscall that all programs on the system makes. Therefore, it is very important to only use syscall rules when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance is helped, though, by combining syscalls into one rule whenever possible.
    
    Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000462-GPOS-00206
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchownat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\blchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
  end
  if command('uname -i').stdout.strip == 'x86_64'
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchownat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\blchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000193284 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000166595 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchownat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchownat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000189001 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\blchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\blchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000193662 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000178225 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000170052 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchownat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchownat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000177359 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\blchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\blchown\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000196674 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238268r808480_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238268r808480_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238268r808480_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the chmod, fchmod, and fchmodat system calls.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

The system call rules are loaded into a matching engine that intercepts each syscall that all programs on the system makes. Therefore, it is very important to only use syscall rules when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance is helped, though, by combining syscalls into one rule whenever possible.

Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000462-GPOS-00206

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238268r808480_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238268r808480_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238268r808480_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238268r808480_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the chmod, fchmod, and fchmodat system calls."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    The system call rules are loaded into a matching engine that intercepts each syscall that all programs on the system makes. Therefore, it is very important to only use syscall rules when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance is helped, though, by combining syscalls into one rule whenever possible.
    
    Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000462-GPOS-00206
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bchmod\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchmod\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchmodat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
  end
  if command('uname -i').stdout.strip == 'x86_64'
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bchmod\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchmod\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchmodat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bchmod\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bchmod\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000177504 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchmod\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchmod\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000166717 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchmodat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchmodat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00023298 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bchmod\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bchmod\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000201514 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchmod\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchmod\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000174001 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchmodat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfchmodat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000170197 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238271r808483_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238271r808483_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238271r808483_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the creat, open, openat, open_by_handle_at, truncate, and ftruncate system calls.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

The system call rules are loaded into a matching engine that intercepts each syscall that all programs on the system makes. Therefore, it is very important to only use syscall rules when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance is helped, though, by combining syscalls into one rule whenever possible.

Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000474-GPOS-00219

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238271r808483_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238271r808483_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238271r808483_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238271r808483_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the creat, open, openat, open_by_handle_at, truncate, and ftruncate system calls."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    The system call rules are loaded into a matching engine that intercepts each syscall that all programs on the system makes. Therefore, it is very important to only use syscall rules when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance is helped, though, by combining syscalls into one rule whenever possible.
    
    Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000474-GPOS-00219
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\btruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\btruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bftruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bftruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bcreat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bcreat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopenat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopenat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen_by_handle_at\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen_by_handle_at\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
  end
  if command('uname -i').stdout.strip == 'x86_64'
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\btruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\btruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bftruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bftruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bcreat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bcreat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopenat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopenat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen_by_handle_at\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen_by_handle_at\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000184328 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.0001813 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\btruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\btruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.0001786 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\btruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\btruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000164883 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bftruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bftruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000197749 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bftruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bftruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000193906 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bcreat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bcreat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000172973 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bcreat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bcreat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000202094 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopenat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopenat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000195194 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopenat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopenat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000469416 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen_by_handle_at\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen_by_handle_at\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000204613 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen_by_handle_at\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen_by_handle_at\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000183651 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000439603 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000192668 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\btruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\btruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000176186 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\btruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\btruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000171279 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bftruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bftruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000169226 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bftruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bftruncate\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000168545 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bcreat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bcreat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000169118 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bcreat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bcreat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00016595 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopenat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopenat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000347475 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopenat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopenat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00072088 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen_by_handle_at\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen_by_handle_at\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000220953 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen_by_handle_at\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bopen_by_handle_at\b\S*\s+(?:-S\s+\S+\s+)*-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000186624 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238277r654006_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238277r654006_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238277r654006_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the sudo command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238277r654006_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238277r654006_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238277r654006_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238277r654006_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the sudo command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/sudo\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/sudo\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/sudo\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00020327 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238278r654009_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238278r654009_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238278r654009_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the sudoedit command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238278r654009_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238278r654009_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238278r654009_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238278r654009_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the sudoedit command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/sudoedit\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/sudoedit\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/sudoedit\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000203237 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238279r654012_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238279r654012_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238279r654012_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the chsh command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238279r654012_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238279r654012_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238279r654012_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238279r654012_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the chsh command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/chsh\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/chsh\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/chsh\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000206774 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238280r654015_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238280r654015_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238280r654015_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the newgrp command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238280r654015_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238280r654015_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238280r654015_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238280r654015_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the newgrp command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/newgrp\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/newgrp\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/newgrp\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000200677 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238281r654018_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238281r654018_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238281r654018_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the chcon command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238281r654018_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238281r654018_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238281r654018_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238281r654018_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the chcon command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/chcon\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/chcon\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/chcon\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00019271 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238282r654021_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238282r654021_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238282r654021_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the apparmor_parser command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238282r654021_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238282r654021_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238282r654021_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238282r654021_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the apparmor_parser command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/sbin\/apparmor_parser\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/sbin\/apparmor_parser\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/sbin\/apparmor_parser\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000210986 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238283r654024_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238283r654024_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238283r654024_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the setfacl command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238283r654024_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238283r654024_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238283r654024_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238283r654024_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the setfacl command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/setfacl\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/setfacl\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/setfacl\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000224228 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238284r654027_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238284r654027_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238284r654027_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the chacl command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238284r654027_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238284r654027_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238284r654027_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238284r654027_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the chacl command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/chacl\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/chacl\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/chacl\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000206755 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238285r654030_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238285r654030_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238285r654030_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for the use and modification of the tallylog file.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000470-GPOS-00214, SRG-OS-000473-GPOS-00218

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238285r654030_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238285r654030_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238285r654030_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238285r654030_rule" do
  title "The Ubuntu operating system must generate audit records for the use and modification of the tallylog file."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000470-GPOS-00214, SRG-OS-000473-GPOS-00218
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe.one do
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-w\s+\/var\/log\/tallylog(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/log\/tallylog\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-w\s+\/var\/log\/tallylog(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-w\s+\/var\/log\/tallylog(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000209042 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/log\/tallylog\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/log\/tallylog\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000218565 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238286r654033_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238286r654033_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238286r654033_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for the use and modification of faillog file.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000470-GPOS-00214, SRG-OS-000473-GPOS-00218

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238286r654033_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238286r654033_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238286r654033_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238286r654033_rule" do
  title "The Ubuntu operating system must generate audit records for the use and modification of faillog file."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000470-GPOS-00214, SRG-OS-000473-GPOS-00218
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe.one do
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-w\s+\/var\/log\/faillog(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/log\/faillog\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-w\s+\/var\/log\/faillog(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-w\s+\/var\/log\/faillog(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000195306 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/log\/faillog\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/log\/faillog\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000274557 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238287r654036_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238287r654036_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238287r654036_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for the use and modification of the lastlog file.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000470-GPOS-00214, SRG-OS-000473-GPOS-00218

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238287r654036_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238287r654036_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238287r654036_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238287r654036_rule" do
  title "The Ubuntu operating system must generate audit records for the use and modification of the lastlog file."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000470-GPOS-00214, SRG-OS-000473-GPOS-00218
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe.one do
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-w\s+\/var\/log\/lastlog(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/log\/lastlog\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-w\s+\/var\/log\/lastlog(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-w\s+\/var\/log\/lastlog(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000209864 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/log\/lastlog\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/log\/lastlog\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000186317 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238288r654039_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238288r654039_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238288r654039_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the passwd command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238288r654039_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238288r654039_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238288r654039_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238288r654039_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the passwd command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/passwd\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=500\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/passwd\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=500\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/passwd\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=500\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000204597 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238289r654042_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238289r654042_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238289r654042_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the unix_update command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238289r654042_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238289r654042_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238289r654042_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238289r654042_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the unix_update command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/sbin\/unix_update\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/sbin\/unix_update\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/sbin\/unix_update\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000222848 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238290r654045_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238290r654045_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238290r654045_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the gpasswd command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238290r654045_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238290r654045_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238290r654045_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238290r654045_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the gpasswd command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/gpasswd\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/gpasswd\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/gpasswd\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000198214 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238291r654048_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238291r654048_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238291r654048_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the chage command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238291r654048_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238291r654048_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238291r654048_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238291r654048_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the chage command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/chage\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/chage\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/chage\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000196847 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238292r654051_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238292r654051_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238292r654051_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the usermod command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238292r654051_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238292r654051_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238292r654051_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238292r654051_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the usermod command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/sbin\/usermod\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/sbin\/usermod\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/sbin\/usermod\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000237958 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238293r654054_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238293r654054_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238293r654054_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the crontab command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238293r654054_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238293r654054_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238293r654054_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238293r654054_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the crontab command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/crontab\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/crontab\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/bin\/crontab\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00023783 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238294r654057_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238294r654057_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238294r654057_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the pam_timestamp_check command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238294r654057_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238294r654057_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238294r654057_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238294r654057_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the pam_timestamp_check command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/sbin\/pam_timestamp_check\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/sbin\/pam_timestamp_check\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)(?:\s+-S\s+all)?\s+-F\s+path=\/usr\/sbin\/pam_timestamp_check\s+(?:-F\s+perm=[rwa]*x[rwa]*\s+)?-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000201142 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238295r808486_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238295r808486_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238295r808486_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the init_module and finit_module syscalls.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

The system call rules are loaded into a matching engine that intercepts each syscall that all programs on the system makes. Therefore, it is very important to only use syscall rules when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance is helped, though, by combining syscalls into one rule whenever possible.

Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000471-GPOS-00216

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238295r808486_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238295r808486_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238295r808486_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238295r808486_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the init_module and finit_module syscalls."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    The system call rules are loaded into a matching engine that intercepts each syscall that all programs on the system makes. Therefore, it is very important to only use syscall rules when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance is helped, though, by combining syscalls into one rule whenever possible.
    
    Satisfies: SRG-OS-000064-GPOS-00033, SRG-OS-000471-GPOS-00216
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\binit_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
  end
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfinit_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
  end
  if command('uname -i').stdout.strip == 'x86_64'
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\binit_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfinit_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\binit_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\binit_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000176113 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfinit_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfinit_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000172007 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\binit_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\binit_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000177646 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfinit_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bfinit_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset).*(-k[\s]+|-F[\s]+key=)[-\w]+[\s]*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000175491 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238297r802387_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238297r802387_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238297r802387_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the delete_module syscall.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Satisfies: SRG-OS-000477-GPOS-00222

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238297r802387_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238297r802387_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238297r802387_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238297r802387_rule" do
  title "The Ubuntu operating system must generate audit records for successful/unsuccessful uses of the delete_module syscall."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Satisfies: SRG-OS-000477-GPOS-00222
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bdelete_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bdelete_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bdelete_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bdelete_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000460717 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bdelete_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bdelete_module\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000199541 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238298r654069_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238298r654069_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238298r654069_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must produce audit records and reports containing information to establish when, where, what type, the source, and the outcome for all DoD-defined auditable events and actions in near real time.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without establishing the when, where, type, source, and outcome of events that occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.

Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit record content that may be necessary to satisfy this requirement includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.

Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.

Successful incident response and auditing relies on timely, accurate system information and analysis in order to allow the organization to identify and respond to potential incidents in a proficient manner. If the operating system does not provide the ability to centrally review the operating system logs, forensic analysis is negatively impacted.

Associating event types with detected events in the Ubuntu operating system audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured operating system.

Satisfies: SRG-OS-000122-GPOS-00063, SRG-OS-000037-GPOS-00015, SRG-OS-000038-GPOS-00016, SRG-OS-000039-GPOS-00017, SRG-OS-000040-GPOS-00018, SRG-OS-000041-GPOS-00019, SRG-OS-000042-GPOS-00020, SRG-OS-000042-GPOS-00021, SRG-OS-000051-GPOS-00024, SRG-OS-000054-GPOS-00025, SRG-OS-000062-GPOS-00031, SRG-OS-000337-GPOS-00129, SRG-OS-000348-GPOS-00136, SRG-OS-000349-GPOS-00137, SRG-OS-000350-GPOS-00138, SRG-OS-000351-GPOS-00139, SRG-OS-000352-GPOS-00140, SRG-OS-000353-GPOS-00141, SRG-OS-000354-GPOS-00142, SRG-OS-000475-GPOS-00220

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001914</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 (3)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238298r654069_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238298r654069_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238298r654069_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238298r654069_rule" do
  title "The Ubuntu operating system must produce audit records and reports containing information to establish when, where, what type, the source, and the outcome for all DoD-defined auditable events and actions in near real time."
  desc  "
    Vulnerability Discussion: Without establishing the when, where, type, source, and outcome of events that occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.
    
    Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit record content that may be necessary to satisfy this requirement includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.
    
    Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.
    
    Successful incident response and auditing relies on timely, accurate system information and analysis in order to allow the organization to identify and respond to potential incidents in a proficient manner. If the operating system does not provide the ability to centrally review the operating system logs, forensic analysis is negatively impacted.
    
    Associating event types with detected events in the Ubuntu operating system audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured operating system.
    
    Satisfies: SRG-OS-000122-GPOS-00063, SRG-OS-000037-GPOS-00015, SRG-OS-000038-GPOS-00016, SRG-OS-000039-GPOS-00017, SRG-OS-000040-GPOS-00018, SRG-OS-000041-GPOS-00019, SRG-OS-000042-GPOS-00020, SRG-OS-000042-GPOS-00021, SRG-OS-000051-GPOS-00024, SRG-OS-000054-GPOS-00025, SRG-OS-000062-GPOS-00031, SRG-OS-000337-GPOS-00129, SRG-OS-000348-GPOS-00136, SRG-OS-000349-GPOS-00137, SRG-OS-000350-GPOS-00138, SRG-OS-000351-GPOS-00139, SRG-OS-000352-GPOS-00140, SRG-OS-000353-GPOS-00141, SRG-OS-000354-GPOS-00142, SRG-OS-000475-GPOS-00220
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000130"
  tag nist: ["NIST SP 800-53", "3", "AU-3"]
  tag nist: ["NIST SP 800-53A", "1", "AU-3.1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-3"]
  tag cci: "CCI-000131"
  tag nist: ["NIST SP 800-53", "3", "AU-3"]
  tag nist: ["NIST SP 800-53A", "1", "AU-3.1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-3"]
  tag cci: "CCI-000132"
  tag nist: ["NIST SP 800-53", "3", "AU-3"]
  tag nist: ["NIST SP 800-53A", "1", "AU-3.1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-3"]
  tag cci: "CCI-000133"
  tag nist: ["NIST SP 800-53", "3", "AU-3"]
  tag nist: ["NIST SP 800-53A", "1", "AU-3.1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-3"]
  tag cci: "CCI-000134"
  tag nist: ["NIST SP 800-53", "3", "AU-3"]
  tag nist: ["NIST SP 800-53A", "1", "AU-3.1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-3"]
  tag cci: "CCI-000135"
  tag nist: ["NIST SP 800-53", "3", "AU-3 (1)"]
  tag nist: ["NIST SP 800-53A", "1", "AU-3 (1).1 (ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-3 (1)"]
  tag cci: "CCI-000154"
  tag nist: ["NIST SP 800-53", "3", "AU-6 (4)"]
  tag nist: ["NIST SP 800-53A", "1", "AU-6 (4).1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-6 (4)"]
  tag cci: "CCI-000158"
  tag nist: ["NIST SP 800-53", "3", "AU-7 (1)"]
  tag nist: ["NIST SP 800-53A", "1", "AU-7 (1).1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-7 (1)"]
  tag cci: "CCI-000169"
  tag nist: ["NIST SP 800-53", "3", "AU-12 a"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 a"]
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  tag cci: "CCI-001875"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-7 a"]
  tag cci: "CCI-001876"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-7 a"]
  tag cci: "CCI-001877"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-7 a"]
  tag cci: "CCI-001878"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-7 a"]
  tag cci: "CCI-001879"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-7 a"]
  tag cci: "CCI-001880"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-7 a"]
  tag cci: "CCI-001881"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-7 b"]
  tag cci: "CCI-001882"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-7 b"]
  tag cci: "CCI-001914"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 (3)"]
  describe package("auditd") do
    it { should be_installed }
  end
  describe service("auditd") do
    it { should be_enabled }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-System_Package_auditd">
  <h4 class="resource-title">Resource <code>System Package auditd</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to be installed</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected that `System Package auditd` is installed</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.024155739 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-Service_auditd">
  <h4 class="resource-title">Resource <code>Service auditd</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to be enabled</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected that `Service auditd` is enabled</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.116403669 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238299r654072_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238299r654072_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238299r654072_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must initiate session audits at system start-up.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: If auditing is enabled late in the start-up process, the actions of some start-up processes may not be audited. Some audit systems also maintain state information only available if auditing is enabled before a given process is created.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001464</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-14 (1)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238299r654072_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238299r654072_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238299r654072_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238299r654072_rule" do
  title "The Ubuntu operating system must initiate session audits at system start-up."
  desc  "
    Vulnerability Discussion: If auditing is enabled late in the start-up process, the actions of some start-up processes may not be audited. Some audit systems also maintain state information only available if auditing is enabled before a given process is created.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001464"
  tag nist: ["NIST SP 800-53", "3", "AU-14 (1)"]
  tag nist: ["NIST SP 800-53A", "1", "AU-14 (1).1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-14 (1)"]
  describe file("/boot/grub/grub.cfg") do
    its("content") { should match(/^\s*linux\s+(.+)$/) }
  end
  file("/boot/grub/grub.cfg").content.to_s.scan(/^\s*linux\s+(.+)$/).flatten.each do |entry|
    describe entry do
      it { should match(/\baudit=1\b/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__boot_grub_grub_cfg">
  <h4 class="resource-title">Resource <code>File /boot/grub/grub.cfg</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*linux\s+(.+)$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000593227 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-_vmlinuz_5_4_0_177_generic_root__dev_mapper_ubuntu__vg_ubuntu__lv_ro__">
  <h4 class="resource-title">Resource <code>/vmlinuz-5.4.0-177-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro  </code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to match /\baudit=1\b/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "/vmlinuz-5.4.0-177-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro  " to match /\baudit=1\b/
Diff:
@@ -1,2 +1,2 @@
-/\baudit=1\b/
+"/vmlinuz-5.4.0-177-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro  "
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000719089 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-_vmlinuz_5_4_0_177_generic_root__dev_mapper_ubuntu__vg_ubuntu__lv_ro__">
  <h4 class="resource-title">Resource <code>/vmlinuz-5.4.0-177-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro  </code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to match /\baudit=1\b/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "/vmlinuz-5.4.0-177-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro  " to match /\baudit=1\b/
Diff:
@@ -1,2 +1,2 @@
-/\baudit=1\b/
+"/vmlinuz-5.4.0-177-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro  "
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000793883 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-_vmlinuz_5_4_0_177_generic_root__dev_mapper_ubuntu__vg_ubuntu__lv_ro_recovery_nomodeset_dis_ucode_ldr_">
  <h4 class="resource-title">Resource <code>/vmlinuz-5.4.0-177-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro recovery nomodeset dis_ucode_ldr </code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to match /\baudit=1\b/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "/vmlinuz-5.4.0-177-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro recovery nomodeset dis_ucode_ldr " to match /\baudit=1\b/
Diff:
@@ -1,2 +1,2 @@
-/\baudit=1\b/
+"/vmlinuz-5.4.0-177-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro recovery nomodeset dis_ucode_ldr "
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000457417 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-_vmlinuz_5_4_0_174_generic_root__dev_mapper_ubuntu__vg_ubuntu__lv_ro__">
  <h4 class="resource-title">Resource <code>/vmlinuz-5.4.0-174-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro  </code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to match /\baudit=1\b/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "/vmlinuz-5.4.0-174-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro  " to match /\baudit=1\b/
Diff:
@@ -1,2 +1,2 @@
-/\baudit=1\b/
+"/vmlinuz-5.4.0-174-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro  "
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000499732 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-_vmlinuz_5_4_0_174_generic_root__dev_mapper_ubuntu__vg_ubuntu__lv_ro_recovery_nomodeset_dis_ucode_ldr_">
  <h4 class="resource-title">Resource <code>/vmlinuz-5.4.0-174-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro recovery nomodeset dis_ucode_ldr </code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to match /\baudit=1\b/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "/vmlinuz-5.4.0-174-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro recovery nomodeset dis_ucode_ldr " to match /\baudit=1\b/
Diff:
@@ -1,2 +1,2 @@
-/\baudit=1\b/
+"/vmlinuz-5.4.0-174-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro recovery nomodeset dis_ucode_ldr "
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000467527 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-skipped" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238300r654075_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238300r654075_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238300r654075_rule">
  <caption>Control Table</caption>
    <tr class="status status-skipped"><th>Status:</th><td><div>Skipped</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must configure audit tools with a mode of 0755 or less permissive.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit information.

Operating systems providing tools to interface with audit information will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order to make access decisions regarding the access to audit tools.

Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.

Satisfies: SRG-OS-000256-GPOS-00097, SRG-OS-000257-GPOS-00098

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001494</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-9"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238300r654075_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238300r654075_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238300r654075_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238300r654075_rule" do
  title "The Ubuntu operating system must configure audit tools with a mode of 0755 or less permissive."
  desc  "
    Vulnerability Discussion: Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit information.
    
    Operating systems providing tools to interface with audit information will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order to make access decisions regarding the access to audit tools.
    
    Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.
    
    Satisfies: SRG-OS-000256-GPOS-00097, SRG-OS-000257-GPOS-00098
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001493"
  tag nist: ["NIST SP 800-53", "3", "AU-9"]
  tag nist: ["NIST SP 800-53A", "1", "AU-9.1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-9"]
  tag cci: "CCI-001494"
  tag nist: ["NIST SP 800-53", "3", "AU-9"]
  tag nist: ["NIST SP 800-53A", "1", "AU-9.1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-9"]
  describe 'Manual steps required for this recommendation' do
    skip ('Verify the audit tools are protected from unauthorized access, deletion, or modification by checking the permissive mode.'\
           'If any of the audit tools has a mode more permissive than "0755", this is a finding.'\
           'Configure the audit tools to be protected from unauthorized access by setting the correct permissive mode using the following command:$ sudo chmod 0755 [audit_tool]'\
           'Replace "[audit_tool]" with the audit tool that does not have the correct permissive mode')
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-Manual_steps_required_for_this_recommendation">
  <h4 class="resource-title">Resource <code>Manual steps required for this recommendation</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>Verify the audit tools are protected from unauthorized access, deletion, or modification by checking the permissive mode.If any of the audit tools has a mode more permissive than "0755", this is a finding.Configure the audit tools to be protected from unauthorized access by setting the correct permissive mode using the following command:$ sudo chmod 0755 [audit_tool]Replace "[audit_tool]" with the audit tool that does not have the correct permissive mode</code></td></tr>
    <tr class="status status-skipped"><th>Status:</th><td><div>Skipped</div></td></tr>
    
    
    <tr class="skip_message"><th>Skip Message:</th><td>Verify the audit tools are protected from unauthorized access, deletion, or modification by checking the permissive mode.If any of the audit tools has a mode more permissive than "0755", this is a finding.Configure the audit tools to be protected from unauthorized access by setting the correct permissive mode using the following command:$ sudo chmod 0755 [audit_tool]Replace "[audit_tool]" with the audit tool that does not have the correct permissive mode</td></tr>
    
    <tr class="duration"><th>Duration:</th><td>2.3972e-05 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-skipped" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238301r654078_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238301r654078_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238301r654078_rule">
  <caption>Control Table</caption>
    <tr class="status status-skipped"><th>Status:</th><td><div>Skipped</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must configure audit tools to be owned by root.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit information.

Operating systems providing tools to interface with audit information will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order to make access decisions regarding the access to audit tools.

Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.

Satisfies: SRG-OS-000256-GPOS-00097, SRG-OS-000257-GPOS-00098

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001494</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-9"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238301r654078_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238301r654078_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238301r654078_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238301r654078_rule" do
  title "The Ubuntu operating system must configure audit tools to be owned by root."
  desc  "
    Vulnerability Discussion: Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit information.
    
    Operating systems providing tools to interface with audit information will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order to make access decisions regarding the access to audit tools.
    
    Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.
    
    Satisfies: SRG-OS-000256-GPOS-00097, SRG-OS-000257-GPOS-00098
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001493"
  tag nist: ["NIST SP 800-53", "3", "AU-9"]
  tag nist: ["NIST SP 800-53A", "1", "AU-9.1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-9"]
  tag cci: "CCI-001494"
  tag nist: ["NIST SP 800-53", "3", "AU-9"]
  tag nist: ["NIST SP 800-53A", "1", "AU-9.1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-9"]
  describe 'Manual steps required for this recommendation' do
    skip ('Verify the audit tools are owned by "root" to prevent any unauthorized access, deletion, or modification.'\
           'If any of the audit tools are not owned by "root", this is a finding.'\
           'Configure the audit tools to be owned by "root", by running the following command:$ sudo chown root [audit_tool]'\
           'Replace "[audit_tool]" with each audit tool not owned by "root".')
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-Manual_steps_required_for_this_recommendation">
  <h4 class="resource-title">Resource <code>Manual steps required for this recommendation</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>Verify the audit tools are owned by "root" to prevent any unauthorized access, deletion, or modification.If any of the audit tools are not owned by "root", this is a finding.Configure the audit tools to be owned by "root", by running the following command:$ sudo chown root [audit_tool]Replace "[audit_tool]" with each audit tool not owned by "root".</code></td></tr>
    <tr class="status status-skipped"><th>Status:</th><td><div>Skipped</div></td></tr>
    
    
    <tr class="skip_message"><th>Skip Message:</th><td>Verify the audit tools are owned by "root" to prevent any unauthorized access, deletion, or modification.If any of the audit tools are not owned by "root", this is a finding.Configure the audit tools to be owned by "root", by running the following command:$ sudo chown root [audit_tool]Replace "[audit_tool]" with each audit tool not owned by "root".</td></tr>
    
    <tr class="duration"><th>Duration:</th><td>8.475e-06 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-skipped" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238302r654081_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238302r654081_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238302r654081_rule">
  <caption>Control Table</caption>
    <tr class="status status-skipped"><th>Status:</th><td><div>Skipped</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must configure the audit tools to be group-owned by root.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit information.

Operating systems providing tools to interface with audit information will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order to make access decisions regarding the access to audit tools.

Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.

Satisfies: SRG-OS-000256-GPOS-00097, SRG-OS-000257-GPOS-00098

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001494</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-9"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238302r654081_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238302r654081_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238302r654081_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238302r654081_rule" do
  title "The Ubuntu operating system must configure the audit tools to be group-owned by root."
  desc  "
    Vulnerability Discussion: Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit information.
    
    Operating systems providing tools to interface with audit information will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order to make access decisions regarding the access to audit tools.
    
    Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.
    
    Satisfies: SRG-OS-000256-GPOS-00097, SRG-OS-000257-GPOS-00098
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001493"
  tag nist: ["NIST SP 800-53", "3", "AU-9"]
  tag nist: ["NIST SP 800-53A", "1", "AU-9.1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-9"]
  tag cci: "CCI-001494"
  tag nist: ["NIST SP 800-53", "3", "AU-9"]
  tag nist: ["NIST SP 800-53A", "1", "AU-9.1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-9"]
  describe 'Manual steps required for this recommendation' do
    skip ('Verify the system commands contained in the following directories are group-owned by "root" with the following command:'\
           '$ sudo find -L /bin /sbin /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin ! -group root -exec ls -l {} \;If any system commands are returned and is not owned by a required system account, this is a finding.'\
           'Run the following command, replacing "[FILE]" with any system command file not group-owned by "root" or a required system account.$ sudo chgrp root [FILE]')
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-Manual_steps_required_for_this_recommendation">
  <h4 class="resource-title">Resource <code>Manual steps required for this recommendation</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>Verify the system commands contained in the following directories are group-owned by "root" with the following command:$ sudo find -L /bin /sbin /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin ! -group root -exec ls -l {} \;If any system commands are returned and is not owned by a required system account, this is a finding.Run the following command, replacing "[FILE]" with any system command file not group-owned by "root" or a required system account.$ sudo chgrp root [FILE]</code></td></tr>
    <tr class="status status-skipped"><th>Status:</th><td><div>Skipped</div></td></tr>
    
    
    <tr class="skip_message"><th>Skip Message:</th><td>Verify the system commands contained in the following directories are group-owned by "root" with the following command:$ sudo find -L /bin /sbin /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin ! -group root -exec ls -l {} \;If any system commands are returned and is not owned by a required system account, this is a finding.Run the following command, replacing "[FILE]" with any system command file not group-owned by "root" or a required system account.$ sudo chgrp root [FILE]</td></tr>
    
    <tr class="duration"><th>Duration:</th><td>7.183e-06 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238304r654087_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238304r654087_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238304r654087_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must prevent all software from executing at higher privilege levels than users executing the software and the audit system must be configured to audit the execution of privileged functions.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: In certain situations, software applications/programs need to execute with elevated privileges to perform required functions. However, if the privileges required for execution are at a higher level than the privileges assigned to organizational users invoking such applications/programs, those users are indirectly provided with greater privileges than assigned by the organizations.

Some programs and processes are required to operate at a higher privilege level and therefore should be excluded from the organization-defined software list after review.

Satisfies: SRG-OS-000326-GPOS-00126, SRG-OS-000327-GPOS-00127

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-002234</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AC-6 (9)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238304r654087_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238304r654087_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238304r654087_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238304r654087_rule" do
  title "The Ubuntu operating system must prevent all software from executing at higher privilege levels than users executing the software and the audit system must be configured to audit the execution of privileged functions."
  desc  "
    Vulnerability Discussion: In certain situations, software applications/programs need to execute with elevated privileges to perform required functions. However, if the privileges required for execution are at a higher level than the privileges assigned to organizational users invoking such applications/programs, those users are indirectly provided with greater privileges than assigned by the organizations.
    
    Some programs and processes are required to operate at a higher privilege level and therefore should be excluded from the organization-defined software list after review.
    
    Satisfies: SRG-OS-000326-GPOS-00126, SRG-OS-000327-GPOS-00127
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-002233"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-6 (8)"]
  tag cci: "CCI-002234"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-6 (9)"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bexecve\b\S*\s+(?:-S\s+\S+\s+)*-C\s+uid!=euid\s+-F\s+euid=0(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
  describe file("/etc/audit/audit.rules") do
   its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bexecve\b\S*\s+(?:-S\s+\S+\s+)*-C\s+gid!=egid\s+-F\s+egid=0(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
  end
  if command('uname -i').stdout.strip == 'x86_64'
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bexecve\b\S*\s+(?:-S\s+\S+\s+)*-C\s+uid!=euid\s+-F\s+euid=0(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bexecve\b\S*\s+(?:-S\s+\S+\s+)*-C\s+gid!=egid\s+-F\s+egid=0(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bexecve\b\S*\s+(?:-S\s+\S+\s+)*-C\s+uid!=euid\s+-F\s+euid=0(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bexecve\b\S*\s+(?:-S\s+\S+\s+)*-C\s+uid!=euid\s+-F\s+euid=0(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000270936 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bexecve\b\S*\s+(?:-S\s+\S+\s+)*-C\s+gid!=egid\s+-F\s+egid=0(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bexecve\b\S*\s+(?:-S\s+\S+\s+)*-C\s+gid!=egid\s+-F\s+egid=0(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00024751 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bexecve\b\S*\s+(?:-S\s+\S+\s+)*-C\s+uid!=euid\s+-F\s+euid=0(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bexecve\b\S*\s+(?:-S\s+\S+\s+)*-C\s+uid!=euid\s+-F\s+euid=0(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000267518 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bexecve\b\S*\s+(?:-S\s+\S+\s+)*-C\s+gid!=egid\s+-F\s+egid=0(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bexecve\b\S*\s+(?:-S\s+\S+\s+)*-C\s+gid!=egid\s+-F\s+egid=0(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000202249 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238310r808489_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238310r808489_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238310r808489_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for any successful/unsuccessful use of unlink, unlinkat, rename, renameat, and rmdir system calls.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

The system call rules are loaded into a matching engine that intercepts each syscall that all programs on the system makes. Therefore, it is very important to only use syscall rules when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance is helped, though, by combining syscalls into one rule whenever possible.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238310r808489_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238310r808489_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238310r808489_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238310r808489_rule" do
  title "The Ubuntu operating system must generate audit records for any successful/unsuccessful use of unlink, unlinkat, rename, renameat, and rmdir system calls."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    The system call rules are loaded into a matching engine that intercepts each syscall that all programs on the system makes. Therefore, it is very important to only use syscall rules when absolutely necessary since these affect performance. The more rules, the bigger the performance hit. The performance is helped, though, by combining syscalls into one rule whenever possible.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bunlink\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
  end
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\brmdir\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
  end
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bunlinkat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
  end
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\brename\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
  end
  describe file("/etc/audit/audit.rules") do
    its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\brenameat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
  end
  if command('uname -i').stdout.strip == 'x86_64'
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bunlink\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\brmdir\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bunlinkat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\brename\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\brenameat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bunlink\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bunlink\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000536516 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\brmdir\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\brmdir\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00030665 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bunlinkat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\bunlinkat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000249147 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\brename\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\brename\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000212043 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\brenameat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b32\s+(?:-S\s+\S+\s+)*-S\s+\S*\brenameat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000223265 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bunlink\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bunlink\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000193188 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\brmdir\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\brmdir\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000195388 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bunlinkat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\bunlinkat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000188681 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\brename\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\brename\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000222939 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\brenameat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+arch=b64\s+(?:-S\s+\S+\s+)*-S\s+\S*\brenameat\b\S*\s+(?:-S\s+\S+\s+)*-F\s+auid>=1000\s+-F\s+auid!=(?:4294967295|-1|unset)(?:\s+(?:-k\s+|-F\s+key=)[-\w]+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000192714 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238315r654120_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238315r654120_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238315r654120_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for the /var/log/wtmp file.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238315r654120_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238315r654120_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238315r654120_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238315r654120_rule" do
  title "The Ubuntu operating system must generate audit records for the /var/log/wtmp file."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe.one do
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-w\s+\/var\/log\/wtmp(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/log\/wtmp\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-w\s+\/var\/log\/wtmp(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-w\s+\/var\/log\/wtmp(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000235264 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/log\/wtmp\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/log\/wtmp\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000256811 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238316r654123_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238316r654123_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238316r654123_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for the /var/run/wtmp file.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238316r654123_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238316r654123_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238316r654123_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238316r654123_rule" do
  title "The Ubuntu operating system must generate audit records for the /var/run/wtmp file."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe.one do
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-w\s+\/var\/run\/wtmp(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/run\/wtmp\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-w\s+\/var\/run\/wtmp(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-w\s+\/var\/run\/wtmp(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000201011 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/run\/wtmp\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/run\/wtmp\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000195819 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238317r654126_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238317r654126_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238317r654126_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records for the /var/log/btmp file.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238317r654126_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238317r654126_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238317r654126_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238317r654126_rule" do
  title "The Ubuntu operating system must generate audit records for the /var/log/btmp file."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe.one do
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-w\s+\/var\/log\/btmp(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/log\/btmp\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-w\s+\/var\/log\/btmp(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-w\s+\/var\/log\/btmp(?:\s+-p\s+(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*))?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000208109 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/log\/btmp\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/var\/log\/btmp\s+-F\s+perm=(?:[rx]*w[rx]*a[rx]*|[rx]*a[rx]*w[rx]*)(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000198345 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238318r654129_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238318r654129_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238318r654129_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records when successful/unsuccessful attempts to use modprobe command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238318r654129_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238318r654129_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238318r654129_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238318r654129_rule" do
  title "The Ubuntu operating system must generate audit records when successful/unsuccessful attempts to use modprobe command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe.one do
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-w\s+\/sbin\/modprobe(?:\s+-p\s+[rwa]*x[rwa]*)?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/sbin\/modprobe\s+-F\s+perm=[rwa]*x[rwa]*(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-w\s+\/sbin\/modprobe(?:\s+-p\s+[rwa]*x[rwa]*)?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-w\s+\/sbin\/modprobe(?:\s+-p\s+[rwa]*x[rwa]*)?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000195768 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/sbin\/modprobe\s+-F\s+perm=[rwa]*x[rwa]*(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/sbin\/modprobe\s+-F\s+perm=[rwa]*x[rwa]*(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000195296 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238319r654132_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238319r654132_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238319r654132_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records when successful/unsuccessful attempts to use the kmod command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238319r654132_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238319r654132_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238319r654132_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238319r654132_rule" do
  title "The Ubuntu operating system must generate audit records when successful/unsuccessful attempts to use the kmod command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe.one do
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-w\s+\/bin\/kmod(?:\s+-p\s+[rwa]*x[rwa]*)?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/bin\/kmod\s+-F\s+perm=[rwa]*x[rwa]*(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-w\s+\/bin\/kmod(?:\s+-p\s+[rwa]*x[rwa]*)?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-w\s+\/bin\/kmod(?:\s+-p\s+[rwa]*x[rwa]*)?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000196064 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/bin\/kmod\s+-F\s+perm=[rwa]*x[rwa]*(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/bin\/kmod\s+-F\s+perm=[rwa]*x[rwa]*(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000209414 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238320r654135_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238320r654135_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238320r654135_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate audit records when successful/unsuccessful attempts to use the fdisk command.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.

Audit records can be generated from various components within the information system (e.g., module or policy filter).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000172</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-12 c"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238320r654135_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238320r654135_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238320r654135_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238320r654135_rule" do
  title "The Ubuntu operating system must generate audit records when successful/unsuccessful attempts to use the fdisk command."
  desc  "
    Vulnerability Discussion: Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
    
    Audit records can be generated from various components within the information system (e.g., module or policy filter).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000172"
  tag nist: ["NIST SP 800-53", "3", "AU-12 c"]
  tag nist: ["NIST SP 800-53A", "1", "AU-12.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-12 c"]
  describe.one do
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-w\s+\/bin\/fdisk(?:\s+-p\s+[rwa]*x[rwa]*)?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
    describe file("/etc/audit/audit.rules") do
      its("content") { should match(/^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/bin\/fdisk\s+-F\s+perm=[rwa]*x[rwa]*(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/) }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-w\s+\/bin\/fdisk(?:\s+-p\s+[rwa]*x[rwa]*)?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-w\s+\/bin\/fdisk(?:\s+-p\s+[rwa]*x[rwa]*)?(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000190918 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_audit_audit_rules">
  <h4 class="resource-title">Resource <code>File /etc/audit/audit.rules</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/bin\/fdisk\s+-F\s+perm=[rwa]*x[rwa]*(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /^\s*-a\s+(?:always,exit|exit,always)\s+-F\s+path=\/bin\/fdisk\s+-F\s+perm=[rwa]*x[rwa]*(?:\s+(?:-k\s+|-F\s+key=)\S+)*\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000191044 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238323r654144_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238323r654144_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238323r654144_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must limit the number of concurrent sessions to ten for all accounts and/or account types.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: The Ubuntu operating system management includes the ability to control the number of users and user sessions that utilize an operating system. Limiting the number of allowed users and sessions per user is helpful in reducing the risks related to DoS attacks.

This requirement addresses concurrent sessions for information system accounts and does not address concurrent sessions by single users via multiple system accounts. The maximum number of concurrent sessions should be defined based upon mission needs and the operational environment for each system.

Documentable: false</td></tr> 
    <tr class="impact impact-low"><th>Impact:</th><td>0.1</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000054</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AC-10"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238323r654144_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238323r654144_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238323r654144_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238323r654144_rule" do
  title "The Ubuntu operating system must limit the number of concurrent sessions to ten for all accounts and/or account types."
  desc  "
    Vulnerability Discussion: The Ubuntu operating system management includes the ability to control the number of users and user sessions that utilize an operating system. Limiting the number of allowed users and sessions per user is helpful in reducing the risks related to DoS attacks.
    
    This requirement addresses concurrent sessions for information system accounts and does not address concurrent sessions by single users via multiple system accounts. The maximum number of concurrent sessions should be defined based upon mission needs and the operational environment for each system.
    
    Documentable: false
    
  "
  impact 0.1
  tag cci: "CCI-000054"
  tag nist: ["NIST SP 800-53", "3", "AC-10"]
  tag nist: ["NIST SP 800-53A", "1", "AC-10.1 (ii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-10"]
  describe file("/etc/security/limits.conf") do
    its("content") { should match(/^\s*\*\s+hard\s+maxlogins\s+(10|[2-9])\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_security_limits_conf">
  <h4 class="resource-title">Resource <code>File /etc/security/limits.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*\*\s+hard\s+maxlogins\s+(10|[2-9])\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "# /etc/security/limits.conf\n#\n#Each line describes a limit for a user in the form:\n#\n#<domain>  ...       -       chroot          /ftp\n\#@student        -       maxlogins       4\n\n# End of file\n" to match /^\s*\*\s+hard\s+maxlogins\s+(10|[2-9])\s*$/
Diff:
@@ -1,2 +1,57 @@
-/^\s*\*\s+hard\s+maxlogins\s+(10|[2-9])\s*$/
+# /etc/security/limits.conf
+#
+#Each line describes a limit for a user in the form:
+#
+#<domain>        <type>  <item>  <value>
+#
+#Where:
+#<domain> can be:
+#        - a user name
+#        - a group name, with @group syntax
+#        - the wildcard *, for default entry
+#        - the wildcard %, can be also used with %group syntax,
+#                 for maxlogin limit
+#        - NOTE: group and wildcard limits are not applied to root.
+#          To apply a limit to the root user, <domain> must be
+#          the literal username root.
+#
+#<type> can have the two values:
+#        - "soft" for enforcing the soft limits
+#        - "hard" for enforcing hard limits
+#
+#<item> can be one of the following:
+#        - core - limits the core file size (KB)
+#        - data - max data size (KB)
+#        - fsize - maximum filesize (KB)
+#        - memlock - max locked-in-memory address space (KB)
+#        - nofile - max number of open file descriptors
+#        - rss - max resident set size (KB)
+#        - stack - max stack size (KB)
+#        - cpu - max CPU time (MIN)
+#        - nproc - max number of processes
+#        - as - address space limit (KB)
+#        - maxlogins - max number of logins for this user
+#        - maxsyslogins - max number of logins on the system
+#        - priority - the priority to run user process with
+#        - locks - max number of file locks the user can hold
+#        - sigpending - max number of pending signals
+#        - msgqueue - max memory used by POSIX message queues (bytes)
+#        - nice - max nice priority allowed to raise to values: [-20, 19]
+#        - rtprio - max realtime priority
+#        - chroot - change root to directory (Debian-specific)
+#
+#<domain>      <type>  <item>         <value>
+#
+
+#*               soft    core            0
+#root            hard    core            100000
+#*               hard    rss             10000
+#@student        hard    nproc           20
+#@faculty        soft    nproc           20
+#@faculty        hard    nproc           50
+#ftp             hard    nproc           0
+#ftp             -       chroot          /ftp
+#@student        -       maxlogins       4
+
+# End of file
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.037246876 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-passed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238325r654150_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238325r654150_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238325r654150_rule">
  <caption>Control Table</caption>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must encrypt all stored passwords with a FIPS 140-2 approved cryptographic hashing algorithm.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000803</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-7"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238325r654150_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238325r654150_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238325r654150_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238325r654150_rule" do
  title "The Ubuntu operating system must encrypt all stored passwords with a FIPS 140-2 approved cryptographic hashing algorithm."
  desc  "
    Vulnerability Discussion: Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000803"
  tag nist: ["NIST SP 800-53", "3", "IA-7"]
  tag nist: ["NIST SP 800-53A", "1", "IA-7.1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-7"]
  describe file("/etc/login.defs") do
    its("content") { should match(/^\s*ENCRYPT_METHOD\s+(\w*)\s*$/) }
  end
  file("/etc/login.defs").content.to_s.scan(/^\s*ENCRYPT_METHOD\s+(\w*)\s*$/).flatten.each do |entry|
    describe entry do
      it { should eq "SHA512" }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_login_defs">
  <h4 class="resource-title">Resource <code>File /etc/login.defs</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*ENCRYPT_METHOD\s+(\w*)\s*$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00062916 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-SHA512">
  <h4 class="resource-title">Resource <code>SHA512</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to eq "SHA512"</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000210131 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238330r654165_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238330r654165_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238330r654165_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must disable account identifiers (individuals, groups, roles, and devices) after 35 days of inactivity.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Inactive identifiers pose a risk to systems and applications because attackers may exploit an inactive identifier and potentially obtain undetected access to the system. Owners of inactive accounts will not notice if unauthorized access to their user account has been obtained.

Operating systems need to track periods of inactivity and disable application identifiers after 35 days of inactivity.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000795</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-4 e"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238330r654165_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238330r654165_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238330r654165_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238330r654165_rule" do
  title "The Ubuntu operating system must disable account identifiers (individuals, groups, roles, and devices) after 35 days of inactivity."
  desc  "
    Vulnerability Discussion: Inactive identifiers pose a risk to systems and applications because attackers may exploit an inactive identifier and potentially obtain undetected access to the system. Owners of inactive accounts will not notice if unauthorized access to their user account has been obtained.
    
    Operating systems need to track periods of inactivity and disable application identifiers after 35 days of inactivity.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-000795"
  tag nist: ["NIST SP 800-53", "3", "IA-4 e"]
  tag nist: ["NIST SP 800-53A", "1", "IA-4.1 (iii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-4 e"]
  describe file("/etc/default/useradd") do
    its("content") { should match(/(?i)^\s*INACTIVE\s*=\s*(-?\d+)\s*$/) }
  end
  file("/etc/default/useradd").content.to_s.scan(/(?i)^\s*INACTIVE\s*=\s*(-?\d+)\s*$/).flatten.each do |entry|
    describe entry do
      it { should cmp > 0 }
    end
  end
  file("/etc/default/useradd").content.to_s.scan(/(?i)^\s*INACTIVE\s*=\s*(-?\d+)\s*$/).flatten.each do |entry|
    describe entry do
      it { should cmp <= 35 }
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_default_useradd">
  <h4 class="resource-title">Resource <code>File /etc/default/useradd</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /(?i)^\s*INACTIVE\s*=\s*(-?\d+)\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "# Default values for useradd(8)\n#\n# The SHELL variable specifies the default login shell on your\n...whether the mail spool should be created while\n# creating the account\n# CREATE_MAIL_SPOOL=yes\n\n" to match /(?i)^\s*INACTIVE\s*=\s*(-?\d+)\s*$/
Diff:
@@ -1,2 +1,37 @@
-/(?i)^\s*INACTIVE\s*=\s*(-?\d+)\s*$/
+# Default values for useradd(8)
+#
+# The SHELL variable specifies the default login shell on your
+# system.
+# Similar to DSHELL in adduser. However, we use "sh" here because
+# useradd is a low level utility and should be as general
+# as possible
+SHELL=/bin/sh
+#
+# The default group for users
+# 100=users on Debian systems
+# Same as USERS_GID in adduser
+# This argument is used when the -n flag is specified.
+# The default behavior (when -n and -g are not specified) is to create a
+# primary user group with the same name as the user being added to the
+# system.
+# GROUP=100
+#
+# The default home directory. Same as DHOME for adduser
+# HOME=/home
+#
+# The number of days after a password expires until the account 
+# is permanently disabled
+# INACTIVE=-1
+#
+# The default expire date
+# EXPIRE=
+#
+# The SKEL variable specifies the directory containing "skeletal" user
+# files; in other words, files such as a sample .profile that will be
+# copied to the new user's home directory when it is created.
+# SKEL=/etc/skel
+#
+# Defines whether the mail spool should be created while
+# creating the account
+# CREATE_MAIL_SPOOL=yes
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.001385609 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238333r654174_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238333r654174_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238333r654174_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must be configured to use TCP syncookies.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.

Managing excess capacity ensures that sufficient capacity is available to counter flooding attacks. Employing increased capacity and service redundancy may reduce the susceptibility to some DoS attacks. Managing excess capacity may include, for example, establishing selected usage priorities, quotas, or partitioning.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001095</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "SC-5 (2)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238333r654174_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238333r654174_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238333r654174_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238333r654174_rule" do
  title "The Ubuntu operating system must be configured to use TCP syncookies."
  desc  "
    Vulnerability Discussion: DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.
    
    Managing excess capacity ensures that sufficient capacity is available to counter flooding attacks. Employing increased capacity and service redundancy may reduce the susceptibility to some DoS attacks. Managing excess capacity may include, for example, establishing selected usage priorities, quotas, or partitioning.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001095"
  tag nist: ["NIST SP 800-53", "3", "SC-5 (2)"]
  tag nist: ["NIST SP 800-53A", "1", "SC-5 (2).1"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "SC-5 (2)"]
  describe kernel_parameter("net.ipv4.tcp_syncookies") do
    its("value") { should_not be_nil }
  end
  describe kernel_parameter("net.ipv4.tcp_syncookies") do
    its("value") { should eq 1 }
  end
  describe.one do
    describe file("/etc/sysctl.conf") do
      its("content") { should match(/^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/) }
    end
    command('find /etc/sysctl.d -type f -name "*.conf"').stdout.split("\n").each do |file|
      describe file(file) do
        its("content") { should match(/^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/) }
      end
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-Kernel_Parameter_net_ipv4_tcp_syncookies">
  <h4 class="resource-title">Resource <code>Kernel Parameter net.ipv4.tcp_syncookies</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>value is expected not to be nil</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.010890776 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-Kernel_Parameter_net_ipv4_tcp_syncookies">
  <h4 class="resource-title">Resource <code>Kernel Parameter net.ipv4.tcp_syncookies</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>value is expected to eq 1</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000905143 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "#\n# /etc/sysctl.conf - Configuration file for setting system variables\n# See /etc/sysctl.d/ for ad...ernel.org/doc/html/latest/admin-guide/sysrq.html\n# for what other values do\n#kernel.sysrq=438\n\n" to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
Diff:
@@ -1,2 +1,68 @@
-/^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
+#
+# /etc/sysctl.conf - Configuration file for setting system variables
+# See /etc/sysctl.d/ for additional system variables.
+# See sysctl.conf (5) for information.
+#
+
+#kernel.domainname = example.com
+
+# Uncomment the following to stop low-level messages on console
+#kernel.printk = 3 4 1 3
+
+##############################################################3
+# Functions previously found in netbase
+#
+
+# Uncomment the next two lines to enable Spoof protection (reverse-path filter)
+# Turn on Source Address Verification in all interfaces to
+# prevent some spoofing attacks
+#net.ipv4.conf.default.rp_filter=1
+#net.ipv4.conf.all.rp_filter=1
+
+# Uncomment the next line to enable TCP/IP SYN cookies
+# See http://lwn.net/Articles/277146/
+# Note: This may impact IPv6 TCP sessions too
+#net.ipv4.tcp_syncookies=1
+
+# Uncomment the next line to enable packet forwarding for IPv4
+#net.ipv4.ip_forward=1
+
+# Uncomment the next line to enable packet forwarding for IPv6
+#  Enabling this option disables Stateless Address Autoconfiguration
+#  based on Router Advertisements for this host
+#net.ipv6.conf.all.forwarding=1
+
+
+###################################################################
+# Additional settings - these settings can improve the network
+# security of the host and prevent against some network attacks
+# including spoofing attacks and man in the middle attacks through
+# redirection. Some network environments, however, require that these
+# settings are disabled so review and enable them as needed.
+#
+# Do not accept ICMP redirects (prevent MITM attacks)
+#net.ipv4.conf.all.accept_redirects = 0
+#net.ipv6.conf.all.accept_redirects = 0
+# _or_
+# Accept ICMP redirects only for gateways listed in our default
+# gateway list (enabled by default)
+# net.ipv4.conf.all.secure_redirects = 1
+#
+# Do not send ICMP redirects (we are not a router)
+#net.ipv4.conf.all.send_redirects = 0
+#
+# Do not accept IP source route packets (we are not a router)
+#net.ipv4.conf.all.accept_source_route = 0
+#net.ipv6.conf.all.accept_source_route = 0
+#
+# Log Martian Packets
+#net.ipv4.conf.all.log_martians = 1
+#
+
+###################################################################
+# Magic system request Key
+# 0=disable, 1=enable all, >1 bitmask of sysrq functions
+# See https://www.kernel.org/doc/html/latest/admin-guide/sysrq.html
+# for what other values do
+#kernel.sysrq=438
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.001885673 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_d_10_console_messages_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/10-console-messages.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "\n# the following stops low-level messages on console\nkernel.printk = 4 4 1 7\n" to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
Diff:
@@ -1,2 +1,4 @@
-/^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
+
+# the following stops low-level messages on console
+kernel.printk = 4 4 1 7
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000606262 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_d_10_network_security_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/10-network-security.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "\n# Turn on Source Address Verification in all interfaces to\n# prevent some spoofing attacks.\nnet.ipv4.conf.default.rp_filter=2\nnet.ipv4.conf.all.rp_filter=2\n\n" to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
Diff:
@@ -1,2 +1,6 @@
-/^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
+
+# Turn on Source Address Verification in all interfaces to
+# prevent some spoofing attacks.
+net.ipv4.conf.default.rp_filter=2
+net.ipv4.conf.all.rp_filter=2
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000533349 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_d_10_zeropage_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/10-zeropage.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "# Protect the zero page of memory from userspace mmap to prevent kernel\n# NULL-dereference attacks ... is reset to the secure default each time the sysctl values are loaded.\nvm.mmap_min_addr = 65536\n" to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
Diff:
@@ -1,2 +1,10 @@
-/^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
+# Protect the zero page of memory from userspace mmap to prevent kernel
+# NULL-dereference attacks against potential future kernel security
+# vulnerabilities.  (Added in kernel 2.6.23.)
+#
+# While this default is built into the Ubuntu kernel, there is no way to
+# restore the kernel default if the value is changed during runtime; for
+# example via package removal (e.g. wine, dosemu).  Therefore, this value
+# is reset to the secure default each time the sysctl values are loaded.
+vm.mmap_min_addr = 65536
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000550501 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_d_10_magic_sysrq_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/10-magic-sysrq.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "# The magic SysRq key enables certain keyboard combinations to be\n# interpreted by the kernel to he...ole logging level and\n#   debugging dumps of processes: kernel.sysrq = 10\n#\nkernel.sysrq = 176\n" to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
Diff:
@@ -1,2 +1,27 @@
-/^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
+# The magic SysRq key enables certain keyboard combinations to be
+# interpreted by the kernel to help with debugging. The kernel will respond
+# to these keys regardless of the current running applications.
+#
+# In general, the magic SysRq key is not needed for the average Ubuntu
+# system, and having it enabled by default can lead to security issues on
+# the console such as being able to dump memory or to kill arbitrary
+# processes including the running screen lock.
+#
+# Here is the list of possible values:
+#   0 - disable sysrq completely
+#   1 - enable all functions of sysrq
+#  >1 - enable certain functions by adding up the following values:
+#          2 - enable control of console logging level
+#          4 - enable control of keyboard (SAK, unraw)
+#          8 - enable debugging dumps of processes etc.
+#         16 - enable sync command
+#         32 - enable remount read-only
+#         64 - enable signalling of processes (term, kill, oom-kill)
+#        128 - allow reboot/poweroff
+#        256 - allow nicing of all RT tasks
+#
+#   For example, to enable both control of console logging level and
+#   debugging dumps of processes: kernel.sysrq = 10
+#
+kernel.sysrq = 176
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000788565 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_d_10_ipv6_privacy_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/10-ipv6-privacy.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "# IPv6 Privacy Extensions (RFC 4941)\n# ---\n# IPv6 typically uses a device's MAC address when choos...the normal addresses.\nnet.ipv6.conf.all.use_tempaddr = 2\nnet.ipv6.conf.default.use_tempaddr = 2\n" to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
Diff:
@@ -1,2 +1,13 @@
-/^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
+# IPv6 Privacy Extensions (RFC 4941)
+# ---
+# IPv6 typically uses a device's MAC address when choosing an IPv6 address
+# to use in autoconfiguration. Privacy extensions allow using a randomly
+# generated IPv6 address, which increases privacy.
+#
+# Acceptable values:
+#    0 - dont use privacy extensions.
+#    1 - generate privacy addresses
+#    2 - prefer privacy addresses and use them over the normal addresses.
+net.ipv6.conf.all.use_tempaddr = 2
+net.ipv6.conf.default.use_tempaddr = 2
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000615202 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_d_10_ptrace_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/10-ptrace.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "# The PTRACE system is used for debugging.  With it, a single user process\n# can attach to any othe... be appropriate for developers or servers with only admin accounts.\nkernel.yama.ptrace_scope = 1\n" to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
Diff:
@@ -1,2 +1,23 @@
-/^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
+# The PTRACE system is used for debugging.  With it, a single user process
+# can attach to any other dumpable process owned by the same user.  In the
+# case of malicious software, it is possible to use PTRACE to access
+# credentials that exist in memory (re-using existing SSH connections,
+# extracting GPG agent information, etc).
+#
+# A PTRACE scope of "0" is the more permissive mode.  A scope of "1" limits
+# PTRACE only to direct child processes (e.g. "gdb name-of-program" and
+# "strace -f name-of-program" work, but gdb's "attach" and "strace -fp $PID"
+# do not).  The PTRACE scope is ignored when a user has CAP_SYS_PTRACE, so
+# "sudo strace -fp $PID" will work as before.  For more details see:
+# https://wiki.ubuntu.com/SecurityTeam/Roadmap/KernelHardening#ptrace
+#
+# For applications launching crash handlers that need PTRACE, exceptions can
+# be registered by the debugee by declaring in the segfault handler
+# specifically which process will be using PTRACE on the debugee:
+#   prctl(PR_SET_PTRACER, debugger_pid, 0, 0, 0);
+#
+# In general, PTRACE is not needed for the average running Ubuntu system.
+# To that end, the default is to set the PTRACE scope to "1".  This value
+# may not be appropriate for developers or servers with only admin accounts.
+kernel.yama.ptrace_scope = 1
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000976756 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_d_10_kernel_hardening_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/10-kernel-hardening.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "# These settings are specific to hardening the kernel itself from attack\n# from userspace, rather t...imits visibility to the root user, and \"2\" blocks even the root user.\nkernel.kptr_restrict = 1\n" to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
Diff:
@@ -1,2 +1,16 @@
-/^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
+# These settings are specific to hardening the kernel itself from attack
+# from userspace, rather than protecting userspace from other malicious
+# userspace things.
+#
+#
+# When an attacker is trying to exploit the local kernel, it is often
+# helpful to be able to examine where in memory the kernel, modules,
+# and data structures live. As such, kernel addresses should be treated
+# as sensitive information.
+#
+# Many files and interfaces contain these addresses (e.g. /proc/kallsyms,
+# /proc/modules, etc), and this setting can censor the addresses. A value
+# of "0" allows all users to see the kernel addresses. A value of "1"
+# limits visibility to the root user, and "2" blocks even the root user.
+kernel.kptr_restrict = 1
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000713336 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_d_10_link_restrictions_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/10-link-restrictions.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "# These settings eliminate an entire class of security vulnerability:\n# time-of-check-time-of-use c...en as \"/tmp file race\" vulnerabilities).\nfs.protected_hardlinks = 1\nfs.protected_symlinks = 1\n" to match /^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
Diff:
@@ -1,2 +1,6 @@
-/^\s*net\.ipv4\.tcp_syncookies\s*=\s*1\s*$/
+# These settings eliminate an entire class of security vulnerability:
+# time-of-check-time-of-use cross-privilege attacks using guessable
+# filenames (generally seen as "/tmp file race" vulnerabilities).
+fs.protected_hardlinks = 1
+fs.protected_symlinks = 1
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000490485 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238337r654186_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238337r654186_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238337r654186_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must generate error messages that provide information necessary for corrective actions without revealing information that could be exploited by adversaries.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Any operating system providing too much information in error messages risks compromising the data and security of the structure, and content of error messages needs to be carefully considered by the organization.

Organizations carefully consider the structure/content of error messages. The extent to which information systems are able to identify and handle error conditions is guided by organizational policy and operational requirements. Information that could be exploited by adversaries includes, for example, erroneous logon attempts with passwords entered by mistake as the username, mission/business information that can be derived from (if not stated explicitly by) information recorded, and personal information, such as account numbers, social security numbers, and credit card numbers.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001312</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "SI-11 a"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238337r654186_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238337r654186_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238337r654186_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238337r654186_rule" do
  title "The Ubuntu operating system must generate error messages that provide information necessary for corrective actions without revealing information that could be exploited by adversaries."
  desc  "
    Vulnerability Discussion: Any operating system providing too much information in error messages risks compromising the data and security of the structure, and content of error messages needs to be carefully considered by the organization.
    
    Organizations carefully consider the structure/content of error messages. The extent to which information systems are able to identify and handle error conditions is guided by organizational policy and operational requirements. Information that could be exploited by adversaries includes, for example, erroneous logon attempts with passwords entered by mistake as the username, mission/business information that can be derived from (if not stated explicitly by) information recorded, and personal information, such as account numbers, social security numbers, and credit card numbers.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001312"
  tag nist: ["NIST SP 800-53", "3", "SI-11 b"]
  tag nist: ["NIST SP 800-53A", "1", "SI-11.1 (iii)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "SI-11 a"]
  describe command('find /var/log -perm /137 -type f -exec stat -c \"%n %a\" {} \;') do
    its("stdout") { should be_empty }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-Command___find__var_log__perm__137__type_f__exec_stat__c____n__a_________">
  <h4 class="resource-title">Resource <code>Command: `find /var/log -perm /137 -type f -exec stat -c \"%n %a\" {} \;`</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>stdout is expected to be empty</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected `"\"/var/log/dmesg.4.gz\n\"/var/log/lastlog\n\"/var/log/dmesg.1.gz\n\"/var/log/dpkg.log.2.gz\n\"/var/l...ck/discover.log\n\"/var/log/alternatives.log.1\n\"/var/log/wtmp\n\"/var/log/landscape/sysinfo.log\n".empty?` to be truthy, got false</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.089777446 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-passed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238338r654189_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238338r654189_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238338r654189_rule">
  <caption>Control Table</caption>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must configure the /var/log directory to be group-owned by syslog.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.

The structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001314</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "SI-11 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238338r654189_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238338r654189_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238338r654189_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238338r654189_rule" do
  title "The Ubuntu operating system must configure the /var/log directory to be group-owned by syslog."
  desc  "
    Vulnerability Discussion: Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.
    
    The structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001314"
  tag nist: ["NIST SP 800-53", "3", "SI-11 c"]
  tag nist: ["NIST SP 800-53A", "1", "SI-11.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "SI-11 b"]
  describe command("stat -c \"%n %G\" /var/log | awk '{print $2}'") do
    its("stdout.strip") { should match(/^syslog$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-Command___stat__c___n__G___var_log___awk___print__2___">
  <h4 class="resource-title">Resource <code>Command: `stat -c "%n %G" /var/log | awk '{print $2}'`</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>stdout.strip is expected to match /^syslog$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.053244383 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-passed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238339r654192_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238339r654192_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238339r654192_rule">
  <caption>Control Table</caption>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must configure the /var/log directory to be owned by root.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.

The structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001314</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "SI-11 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238339r654192_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238339r654192_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238339r654192_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238339r654192_rule" do
  title "The Ubuntu operating system must configure the /var/log directory to be owned by root."
  desc  "
    Vulnerability Discussion: Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.
    
    The structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001314"
  tag nist: ["NIST SP 800-53", "3", "SI-11 c"]
  tag nist: ["NIST SP 800-53A", "1", "SI-11.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "SI-11 b"]
  describe command("stat -c \"%n %U\" /var/log   | awk '{print $2}'") do
    its("stdout.strip") { should match(/^root$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-Command___stat__c___n__U___var_log_____awk___print__2___">
  <h4 class="resource-title">Resource <code>Command: `stat -c "%n %U" /var/log   | awk '{print $2}'`</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>stdout.strip is expected to match /^root$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.012183912 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238340r654195_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238340r654195_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238340r654195_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must configure the /var/log directory to have mode 0750 or less permissive.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.

The structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001314</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "SI-11 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238340r654195_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238340r654195_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238340r654195_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238340r654195_rule" do
  title "The Ubuntu operating system must configure the /var/log directory to have mode 0750 or less permissive."
  desc  "
    Vulnerability Discussion: Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.
    
    The structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001314"
  tag nist: ["NIST SP 800-53", "3", "SI-11 c"]
  tag nist: ["NIST SP 800-53A", "1", "SI-11.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "SI-11 b"]
  describe file("/var/log") do
    it { should exist }
  end
  describe file("/var/log") do
    it { should_not be_writable.by "group" }
  end
  describe file("/var/log") do
    it { should_not be_executable.by "other" }
  end
  describe file("/var/log") do
    it { should_not be_readable.by "other" }
  end
  describe file("/var/log") do
    it { should_not be_writable.by "other" }
  end
  describe file("/var/log") do
    it { should_not be_setgid }
  end
  describe file("/var/log") do
    it { should_not be_sticky }
  end
  describe file("/var/log") do
    it { should_not be_setuid }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__var_log">
  <h4 class="resource-title">Resource <code>File /var/log</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to exist</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.050453673 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__var_log">
  <h4 class="resource-title">Resource <code>File /var/log</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be writable by group</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected File /var/log not to be writable by group</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.010508943 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__var_log">
  <h4 class="resource-title">Resource <code>File /var/log</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be executable by other</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected File /var/log not to be executable by other</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00041036 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__var_log">
  <h4 class="resource-title">Resource <code>File /var/log</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be readable by other</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected File /var/log not to be readable by other</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000282929 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__var_log">
  <h4 class="resource-title">Resource <code>File /var/log</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be writable by other</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00024477 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__var_log">
  <h4 class="resource-title">Resource <code>File /var/log</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be setgid</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.017223084 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__var_log">
  <h4 class="resource-title">Resource <code>File /var/log</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be sticky</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.017458927 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__var_log">
  <h4 class="resource-title">Resource <code>File /var/log</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be setuid</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.015890484 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-passed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238341r654198_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238341r654198_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238341r654198_rule">
  <caption>Control Table</caption>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must configure the /var/log/syslog file to be group-owned by adm.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.

The structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001314</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "SI-11 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238341r654198_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238341r654198_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238341r654198_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238341r654198_rule" do
  title "The Ubuntu operating system must configure the /var/log/syslog file to be group-owned by adm."
  desc  "
    Vulnerability Discussion: Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.
    
    The structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001314"
  tag nist: ["NIST SP 800-53", "3", "SI-11 c"]
  tag nist: ["NIST SP 800-53A", "1", "SI-11.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "SI-11 b"]
  describe command("stat -c \"%n %G\" /var/log/syslog | awk '{print $2}'") do
    its("stdout.strip") { should match(/^adm$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-Command___stat__c___n__G___var_log_syslog___awk___print__2___">
  <h4 class="resource-title">Resource <code>Command: `stat -c "%n %G" /var/log/syslog | awk '{print $2}'`</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>stdout.strip is expected to match /^adm$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.013563646 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-passed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238342r654201_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238342r654201_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238342r654201_rule">
  <caption>Control Table</caption>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must configure /var/log/syslog file to be owned by syslog.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.

The structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001314</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "SI-11 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238342r654201_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238342r654201_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238342r654201_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238342r654201_rule" do
  title "The Ubuntu operating system must configure /var/log/syslog file to be owned by syslog."
  desc  "
    Vulnerability Discussion: Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.
    
    The structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001314"
  tag nist: ["NIST SP 800-53", "3", "SI-11 c"]
  tag nist: ["NIST SP 800-53A", "1", "SI-11.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "SI-11 b"]
  describe command("stat -c \"%n %U\" /var/log/syslog  | awk '{print $2}'") do
    its("stdout.strip") { should match(/^syslog$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-Command___stat__c___n__U___var_log_syslog____awk___print__2___">
  <h4 class="resource-title">Resource <code>Command: `stat -c "%n %U" /var/log/syslog  | awk '{print $2}'`</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>stdout.strip is expected to match /^syslog$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.05379361 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-passed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238343r654204_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238343r654204_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238343r654204_rule">
  <caption>Control Table</caption>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must configure /var/log/syslog file with mode 0640 or less permissive.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.

The structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001314</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "SI-11 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238343r654204_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238343r654204_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238343r654204_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238343r654204_rule" do
  title "The Ubuntu operating system must configure /var/log/syslog file with mode 0640 or less permissive."
  desc  "
    Vulnerability Discussion: Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.
    
    The structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001314"
  tag nist: ["NIST SP 800-53", "3", "SI-11 c"]
  tag nist: ["NIST SP 800-53A", "1", "SI-11.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "SI-11 b"]
  describe file("/var/log/syslog") do
    it { should exist }
  end
  describe file("/var/log/syslog") do
    it { should_not be_executable.by "group" }
  end
  describe file("/var/log/syslog") do
    it { should_not be_writable.by "group" }
  end
  describe file("/var/log/syslog") do
    it { should_not be_executable.by "other" }
  end
  describe file("/var/log/syslog") do
    it { should_not be_readable.by "other" }
  end
  describe file("/var/log/syslog") do
    it { should_not be_writable.by "other" }
  end
  describe file("/var/log/syslog") do
    it { should_not be_setgid }
  end
  describe file("/var/log/syslog") do
    it { should_not be_sticky }
  end
  describe file("/var/log/syslog") do
    it { should_not be_setuid }
  end
  describe file("/var/log/syslog") do
    it { should_not be_executable.by "owner" }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__var_log_syslog">
  <h4 class="resource-title">Resource <code>File /var/log/syslog</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to exist</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.007941315 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__var_log_syslog">
  <h4 class="resource-title">Resource <code>File /var/log/syslog</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be executable by group</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.054850068 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__var_log_syslog">
  <h4 class="resource-title">Resource <code>File /var/log/syslog</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be writable by group</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000362147 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__var_log_syslog">
  <h4 class="resource-title">Resource <code>File /var/log/syslog</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be executable by other</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.018237455 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__var_log_syslog">
  <h4 class="resource-title">Resource <code>File /var/log/syslog</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be readable by other</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000331145 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__var_log_syslog">
  <h4 class="resource-title">Resource <code>File /var/log/syslog</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be writable by other</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000238579 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__var_log_syslog">
  <h4 class="resource-title">Resource <code>File /var/log/syslog</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be setgid</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.007034356 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__var_log_syslog">
  <h4 class="resource-title">Resource <code>File /var/log/syslog</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be sticky</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.005604361 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__var_log_syslog">
  <h4 class="resource-title">Resource <code>File /var/log/syslog</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be setuid</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.008782428 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__var_log_syslog">
  <h4 class="resource-title">Resource <code>File /var/log/syslog</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be executable by owner</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000478034 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-passed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238354r654237_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238354r654237_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238354r654237_rule">
  <caption>Control Table</caption>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must have an application firewall installed in order to control remote access methods.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Remote access services, such as those providing remote access to network devices and information systems, which lack automated control capabilities, increase risk and make remote user access management difficult at best.

Remote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.

Ubuntu operating system functionality (e.g., RDP) must be capable of taking enforcement action if the audit reveals unauthorized activity. Automated control of remote access sessions allows organizations to ensure ongoing compliance with remote access policies by enforcing connection rules of remote access applications on a variety of information system components (e.g., servers, workstations, notebook computers, smartphones, and tablets).

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-002314</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AC-17 (1)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238354r654237_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238354r654237_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238354r654237_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238354r654237_rule" do
  title "The Ubuntu operating system must have an application firewall installed in order to control remote access methods."
  desc  "
    Vulnerability Discussion: Remote access services, such as those providing remote access to network devices and information systems, which lack automated control capabilities, increase risk and make remote user access management difficult at best.
    
    Remote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.
    
    Ubuntu operating system functionality (e.g., RDP) must be capable of taking enforcement action if the audit reveals unauthorized activity. Automated control of remote access sessions allows organizations to ensure ongoing compliance with remote access policies by enforcing connection rules of remote access applications on a variety of information system components (e.g., servers, workstations, notebook computers, smartphones, and tablets).
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-002314"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AC-17 (1)"]
  describe package("ufw") do
    it { should be_installed }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-System_Package_ufw">
  <h4 class="resource-title">Resource <code>System Package ufw</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to be installed</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.025582589 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238357r654246_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238357r654246_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238357r654246_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must synchronize internal information system clocks to the authoritative time source when the time difference is greater than one second.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events.

Synchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network. Organizations should consider setting time periods for different types of systems (e.g., financial, legal, or mission-critical systems).

Organizations should also consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints). This requirement is related to the comparison done every 24 hours in SRG-OS-000355 because a comparison must be done in order to determine the time difference.

Documentable: false</td></tr> 
    <tr class="impact impact-low"><th>Impact:</th><td>0.1</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-002046</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "AU-8 (1) (b)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238357r654246_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238357r654246_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238357r654246_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238357r654246_rule" do
  title "The Ubuntu operating system must synchronize internal information system clocks to the authoritative time source when the time difference is greater than one second."
  desc  "
    Vulnerability Discussion: Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events.
    
    Synchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network. Organizations should consider setting time periods for different types of systems (e.g., financial, legal, or mission-critical systems).
    
    Organizations should also consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints). This requirement is related to the comparison done every 24 hours in SRG-OS-000355 because a comparison must be done in order to determine the time difference.
    
    Documentable: false
    
  "
  impact 0.1
  tag cci: "CCI-002046"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "AU-8 (1) (b)"]
  describe file("/etc/chrony/chrony.conf") do
    its("content") { should match(/(?i)^\s*makestep\s+1\s+-1\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_chrony_chrony_conf">
  <h4 class="resource-title">Resource <code>File /etc/chrony/chrony.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /(?i)^\s*makestep\s+1\s+-1\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected nil to match /(?i)^\s*makestep\s+1\s+-1\s*$/</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.060180758 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-passed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238359r654319_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238359r654319_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238359r654319_rule">
  <caption>Control Table</caption>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system's Advance Package Tool (APT) must be configured to prevent the installation of patches, service packs, device drivers, or Ubuntu operating system components without verification they have been digitally signed using a certificate that is recognized and approved by the organization.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Changes to any software components can have significant effects on the overall security of the operating system. This requirement ensures the software has not been tampered with and that it has been provided by a trusted vendor.

Accordingly, patches, service packs, device drivers, or operating system components must be signed with a certificate recognized and approved by the organization.

Verifying the authenticity of the software prior to installation validates the integrity of the patch or upgrade received from a vendor. This ensures the software has not been tampered with and that it has been provided by a trusted vendor. Self-signed certificates are disallowed by this requirement. The operating system should not have to verify the software again. This requirement does not mandate DoD certificates for this purpose; however, the certificate used to verify the software must be from an approved CA.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001749</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "CM-5 (3)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238359r654319_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238359r654319_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238359r654319_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238359r654319_rule" do
  title "The Ubuntu operating system's Advance Package Tool (APT) must be configured to prevent the installation of patches, service packs, device drivers, or Ubuntu operating system components without verification they have been digitally signed using a certificate that is recognized and approved by the organization."
  desc  "
    Vulnerability Discussion: Changes to any software components can have significant effects on the overall security of the operating system. This requirement ensures the software has not been tampered with and that it has been provided by a trusted vendor.
    
    Accordingly, patches, service packs, device drivers, or operating system components must be signed with a certificate recognized and approved by the organization.
    
    Verifying the authenticity of the software prior to installation validates the integrity of the patch or upgrade received from a vendor. This ensures the software has not been tampered with and that it has been provided by a trusted vendor. Self-signed certificates are disallowed by this requirement. The operating system should not have to verify the software again. This requirement does not mandate DoD certificates for this purpose; however, the certificate used to verify the software must be from an approved CA.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001749"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "CM-5 (3)"]
  files = command('find /etc/apt/apt.conf.d -type f').stdout.split("\n")
  files.each do |file|
    describe.one do
      describe file(file) do
        its("content") { should_not match(/^\S+::AllowUnauthenticated\s*/) }
      end
      describe file(file) do
        its("content") { should match(/^\S+::AllowUnauthenticated\s+"false";$/) }
      end
    end
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_apt_apt_conf_d_20auto_upgrades">
  <h4 class="resource-title">Resource <code>File /etc/apt/apt.conf.d/20auto-upgrades</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\S+::AllowUnauthenticated\s*/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00028346 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_apt_apt_conf_d_15update_stamp">
  <h4 class="resource-title">Resource <code>File /etc/apt/apt.conf.d/15update-stamp</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\S+::AllowUnauthenticated\s*/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000177124 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_apt_apt_conf_d_10periodic">
  <h4 class="resource-title">Resource <code>File /etc/apt/apt.conf.d/10periodic</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\S+::AllowUnauthenticated\s*/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000172708 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_apt_apt_conf_d_20packagekit">
  <h4 class="resource-title">Resource <code>File /etc/apt/apt.conf.d/20packagekit</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\S+::AllowUnauthenticated\s*/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000159832 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_apt_apt_conf_d_20apt_esm_hook_conf">
  <h4 class="resource-title">Resource <code>File /etc/apt/apt.conf.d/20apt-esm-hook.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\S+::AllowUnauthenticated\s*/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000177285 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_apt_apt_conf_d_50unattended_upgrades">
  <h4 class="resource-title">Resource <code>File /etc/apt/apt.conf.d/50unattended-upgrades</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\S+::AllowUnauthenticated\s*/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000150148 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_apt_apt_conf_d_70debconf">
  <h4 class="resource-title">Resource <code>File /etc/apt/apt.conf.d/70debconf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\S+::AllowUnauthenticated\s*/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000129843 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_apt_apt_conf_d_01_vendor_ubuntu">
  <h4 class="resource-title">Resource <code>File /etc/apt/apt.conf.d/01-vendor-ubuntu</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\S+::AllowUnauthenticated\s*/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000158113 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_apt_apt_conf_d_20archive">
  <h4 class="resource-title">Resource <code>File /etc/apt/apt.conf.d/20archive</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\S+::AllowUnauthenticated\s*/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000132381 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_apt_apt_conf_d_01autoremove">
  <h4 class="resource-title">Resource <code>File /etc/apt/apt.conf.d/01autoremove</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\S+::AllowUnauthenticated\s*/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000132619 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_apt_apt_conf_d_20snapd_conf">
  <h4 class="resource-title">Resource <code>File /etc/apt/apt.conf.d/20snapd.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\S+::AllowUnauthenticated\s*/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000133612 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_apt_apt_conf_d_99update_notifier">
  <h4 class="resource-title">Resource <code>File /etc/apt/apt.conf.d/99update-notifier</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\S+::AllowUnauthenticated\s*/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000211483 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_apt_apt_conf_d_50command_not_found">
  <h4 class="resource-title">Resource <code>File /etc/apt/apt.conf.d/50command-not-found</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\S+::AllowUnauthenticated\s*/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000279037 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-passed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238369r654282_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238369r654282_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238369r654282_rule">
  <caption>Control Table</caption>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must implement address space layout randomization to protect its memory from unauthorized code execution.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Some adversaries launch attacks with the intent of executing code in non-executable regions of memory or in memory locations that are prohibited. Security safeguards employed to protect memory include, for example, data execution prevention and address space layout randomization. Data execution prevention safeguards can either be hardware-enforced or software-enforced with hardware providing the greater strength of mechanism.

Examples of attacks are buffer overflow attacks.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-002824</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "SI-16"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238369r654282_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238369r654282_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238369r654282_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238369r654282_rule" do
  title "The Ubuntu operating system must implement address space layout randomization to protect its memory from unauthorized code execution."
  desc  "
    Vulnerability Discussion: Some adversaries launch attacks with the intent of executing code in non-executable regions of memory or in memory locations that are prohibited. Security safeguards employed to protect memory include, for example, data execution prevention and address space layout randomization. Data execution prevention safeguards can either be hardware-enforced or software-enforced with hardware providing the greater strength of mechanism.
    
    Examples of attacks are buffer overflow attacks.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-002824"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "SI-16"]
  command('find /etc/sysctl.d/ -type f').stdout.split("\n").each do |file|
    describe file(file) do
      its("content") { should_not match(/^\s*kernel.randomize_va_space\s*=\s*(\S+)\s*$/) }
    end
  end
  describe file("/etc/sysctl.conf") do
    its("content") { should_not match(/^\s*kernel.randomize_va_space\s*=\s*(\S+)\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_sysctl_d_10_console_messages_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/10-console-messages.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\s*kernel.randomize_va_space\s*=\s*(\S+)\s*$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000242668 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_d_10_network_security_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/10-network-security.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\s*kernel.randomize_va_space\s*=\s*(\S+)\s*$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00017117 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_d_10_zeropage_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/10-zeropage.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\s*kernel.randomize_va_space\s*=\s*(\S+)\s*$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000182519 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_d_README_sysctl">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/README.sysctl</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\s*kernel.randomize_va_space\s*=\s*(\S+)\s*$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.009903449 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_d_10_magic_sysrq_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/10-magic-sysrq.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\s*kernel.randomize_va_space\s*=\s*(\S+)\s*$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000345579 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_d_10_ipv6_privacy_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/10-ipv6-privacy.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\s*kernel.randomize_va_space\s*=\s*(\S+)\s*$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000215606 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_d_10_ptrace_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/10-ptrace.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\s*kernel.randomize_va_space\s*=\s*(\S+)\s*$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000282669 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_d_10_kernel_hardening_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/10-kernel-hardening.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\s*kernel.randomize_va_space\s*=\s*(\S+)\s*$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000224872 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_d_10_link_restrictions_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.d/10-link-restrictions.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\s*kernel.randomize_va_space\s*=\s*(\S+)\s*$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00014816 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_sysctl_conf">
  <h4 class="resource-title">Resource <code>File /etc/sysctl.conf</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\s*kernel.randomize_va_space\s*=\s*(\S+)\s*$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.000299362 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238370r654285_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238370r654285_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238370r654285_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must be configured so that Advance Package Tool (APT) removes all software components after updated versions have been installed.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Previous versions of software components that are not removed from the information system after updates have been installed may be exploited by adversaries. Some information technology products may remove older versions of software automatically from the information system.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-002617</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "SI-2 (6)"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238370r654285_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238370r654285_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238370r654285_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238370r654285_rule" do
  title "The Ubuntu operating system must be configured so that Advance Package Tool (APT) removes all software components after updated versions have been installed."
  desc  "
    Vulnerability Discussion: Previous versions of software components that are not removed from the information system after updates have been installed may be exploited by adversaries. Some information technology products may remove older versions of software automatically from the information system.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-002617"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "SI-2 (6)"]
  describe file("/etc/apt/apt.conf.d/50unattended-upgrades") do
    its("content") { should match(/^\s*Unattended-Upgrade::Remove-Unused-Dependencies\s+"true"\s*;\s*$/) }
  end
  describe file("/etc/apt/apt.conf.d/50unattended-upgrades") do
    its("content") { should match(/^\s*Unattended-Upgrade::Remove-Unused-Kernel-Packages\s+"true"\s*;\s*$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_apt_apt_conf_d_50unattended_upgrades">
  <h4 class="resource-title">Resource <code>File /etc/apt/apt.conf.d/50unattended-upgrades</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*Unattended-Upgrade::Remove-Unused-Dependencies\s+"true"\s*;\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "// Automatically upgrade packages from these (origin:archive) pairs\n//\n// Note that in Ubuntu secu...package downgrade if Pin-Priority exceeds 1000\n// Unattended-Upgrade::Allow-downgrade \"false\";\n" to match /^\s*Unattended-Upgrade::Remove-Unused-Dependencies\s+"true"\s*;\s*$/
Diff:
@@ -1,2 +1,132 @@
-/^\s*Unattended-Upgrade::Remove-Unused-Dependencies\s+"true"\s*;\s*$/
+// Automatically upgrade packages from these (origin:archive) pairs
+//
+// Note that in Ubuntu security updates may pull in new dependencies
+// from non-security sources (e.g. chromium). By allowing the release
+// pocket these get automatically pulled in.
+Unattended-Upgrade::Allowed-Origins {
+	"${distro_id}:${distro_codename}";
+	"${distro_id}:${distro_codename}-security";
+	// Extended Security Maintenance; doesn't necessarily exist for
+	// every release and this system may not have it installed, but if
+	// available, the policy for updates is such that unattended-upgrades
+	// should also install from here by default.
+	"${distro_id}ESMApps:${distro_codename}-apps-security";
+	"${distro_id}ESM:${distro_codename}-infra-security";
+//	"${distro_id}:${distro_codename}-updates";
+//	"${distro_id}:${distro_codename}-proposed";
+//	"${distro_id}:${distro_codename}-backports";
+};
+
+// Python regular expressions, matching packages to exclude from upgrading
+Unattended-Upgrade::Package-Blacklist {
+    // The following matches all packages starting with linux-
+//  "linux-";
+
+    // Use $ to explicitely define the end of a package name. Without
+    // the $, "libc6" would match all of them.
+//  "libc6$";
+//  "libc6-dev$";
+//  "libc6-i686$";
+
+    // Special characters need escaping
+//  "libstdc\+\+6$";
+
+    // The following matches packages like xen-system-amd64, xen-utils-4.1,
+    // xenstore-utils and libxenstore3.0
+//  "(lib)?xen(store)?";
+
+    // For more information about Python regular expressions, see
+    // https://docs.python.org/3/howto/regex.html
+};
+
+// This option controls whether the development release of Ubuntu will be
+// upgraded automatically. Valid values are "true", "false", and "auto".
+Unattended-Upgrade::DevRelease "auto";
+
+// This option allows you to control if on a unclean dpkg exit
+// unattended-upgrades will automatically run 
+//   dpkg --force-confold --configure -a
+// The default is true, to ensure updates keep getting installed
+//Unattended-Upgrade::AutoFixInterruptedDpkg "true";
+
+// Split the upgrade into the smallest possible chunks so that
+// they can be interrupted with SIGTERM. This makes the upgrade
+// a bit slower but it has the benefit that shutdown while a upgrade
+// is running is possible (with a small delay)
+//Unattended-Upgrade::MinimalSteps "true";
+
+// Install all updates when the machine is shutting down
+// instead of doing it in the background while the machine is running.
+// This will (obviously) make shutdown slower.
+// Unattended-upgrades increases logind's InhibitDelayMaxSec to 30s.
+// This allows more time for unattended-upgrades to shut down gracefully
+// or even install a few packages in InstallOnShutdown mode, but is still a
+// big step back from the 30 minutes allowed for InstallOnShutdown previously.
+// Users enabling InstallOnShutdown mode are advised to increase
+// InhibitDelayMaxSec even further, possibly to 30 minutes.
+//Unattended-Upgrade::InstallOnShutdown "false";
+
+// Send email to this address for problems or packages upgrades
+// If empty or unset then no email is sent, make sure that you
+// have a working mail setup on your system. A package that provides
+// 'mailx' must be installed. E.g. "user@example.com"
+//Unattended-Upgrade::Mail "";
+
+// Set this value to one of:
+//    "always", "only-on-error" or "on-change"
+// If this is not set, then any legacy MailOnlyOnError (boolean) value
+// is used to chose between "only-on-error" and "on-change"
+//Unattended-Upgrade::MailReport "on-change";
+
+// Remove unused automatically installed kernel-related packages
+// (kernel images, kernel headers and kernel version locked tools).
+//Unattended-Upgrade::Remove-Unused-Kernel-Packages "true";
+
+// Do automatic removal of newly unused dependencies after the upgrade
+//Unattended-Upgrade::Remove-New-Unused-Dependencies "true";
+
+// Do automatic removal of unused packages after the upgrade
+// (equivalent to apt-get autoremove)
+//Unattended-Upgrade::Remove-Unused-Dependencies "false";
+
+// Automatically reboot *WITHOUT CONFIRMATION* if
+//  the file /var/run/reboot-required is found after the upgrade
+//Unattended-Upgrade::Automatic-Reboot "false";
+
+// Automatically reboot even if there are users currently logged in
+// when Unattended-Upgrade::Automatic-Reboot is set to true
+//Unattended-Upgrade::Automatic-Reboot-WithUsers "true";
+
+// If automatic reboot is enabled and needed, reboot at the specific
+// time instead of immediately
+//  Default: "now"
+//Unattended-Upgrade::Automatic-Reboot-Time "02:00";
+
+// Use apt bandwidth limit feature, this example limits the download
+// speed to 70kb/sec
+//Acquire::http::Dl-Limit "70";
+
+// Enable logging to syslog. Default is False
+// Unattended-Upgrade::SyslogEnable "false";
+
+// Specify syslog facility. Default is daemon
+// Unattended-Upgrade::SyslogFacility "daemon";
+
+// Download and install upgrades only on AC power
+// (i.e. skip or gracefully stop updates on battery)
+// Unattended-Upgrade::OnlyOnACPower "true";
+
+// Download and install upgrades only on non-metered connection
+// (i.e. skip or gracefully stop updates on a metered connection)
+// Unattended-Upgrade::Skip-Updates-On-Metered-Connections "true";
+
+// Verbose logging
+// Unattended-Upgrade::Verbose "false";
+
+// Print debugging information both in unattended-upgrades and
+// in unattended-upgrade-shutdown
+// Unattended-Upgrade::Debug "false";
+
+// Allow package downgrade if Pin-Priority exceeds 1000
+// Unattended-Upgrade::Allow-downgrade "false";
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.003017576 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_apt_apt_conf_d_50unattended_upgrades">
  <h4 class="resource-title">Resource <code>File /etc/apt/apt.conf.d/50unattended-upgrades</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*Unattended-Upgrade::Remove-Unused-Kernel-Packages\s+"true"\s*;\s*$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "// Automatically upgrade packages from these (origin:archive) pairs\n//\n// Note that in Ubuntu secu...package downgrade if Pin-Priority exceeds 1000\n// Unattended-Upgrade::Allow-downgrade \"false\";\n" to match /^\s*Unattended-Upgrade::Remove-Unused-Kernel-Packages\s+"true"\s*;\s*$/
Diff:
@@ -1,2 +1,132 @@
-/^\s*Unattended-Upgrade::Remove-Unused-Kernel-Packages\s+"true"\s*;\s*$/
+// Automatically upgrade packages from these (origin:archive) pairs
+//
+// Note that in Ubuntu security updates may pull in new dependencies
+// from non-security sources (e.g. chromium). By allowing the release
+// pocket these get automatically pulled in.
+Unattended-Upgrade::Allowed-Origins {
+	"${distro_id}:${distro_codename}";
+	"${distro_id}:${distro_codename}-security";
+	// Extended Security Maintenance; doesn't necessarily exist for
+	// every release and this system may not have it installed, but if
+	// available, the policy for updates is such that unattended-upgrades
+	// should also install from here by default.
+	"${distro_id}ESMApps:${distro_codename}-apps-security";
+	"${distro_id}ESM:${distro_codename}-infra-security";
+//	"${distro_id}:${distro_codename}-updates";
+//	"${distro_id}:${distro_codename}-proposed";
+//	"${distro_id}:${distro_codename}-backports";
+};
+
+// Python regular expressions, matching packages to exclude from upgrading
+Unattended-Upgrade::Package-Blacklist {
+    // The following matches all packages starting with linux-
+//  "linux-";
+
+    // Use $ to explicitely define the end of a package name. Without
+    // the $, "libc6" would match all of them.
+//  "libc6$";
+//  "libc6-dev$";
+//  "libc6-i686$";
+
+    // Special characters need escaping
+//  "libstdc\+\+6$";
+
+    // The following matches packages like xen-system-amd64, xen-utils-4.1,
+    // xenstore-utils and libxenstore3.0
+//  "(lib)?xen(store)?";
+
+    // For more information about Python regular expressions, see
+    // https://docs.python.org/3/howto/regex.html
+};
+
+// This option controls whether the development release of Ubuntu will be
+// upgraded automatically. Valid values are "true", "false", and "auto".
+Unattended-Upgrade::DevRelease "auto";
+
+// This option allows you to control if on a unclean dpkg exit
+// unattended-upgrades will automatically run 
+//   dpkg --force-confold --configure -a
+// The default is true, to ensure updates keep getting installed
+//Unattended-Upgrade::AutoFixInterruptedDpkg "true";
+
+// Split the upgrade into the smallest possible chunks so that
+// they can be interrupted with SIGTERM. This makes the upgrade
+// a bit slower but it has the benefit that shutdown while a upgrade
+// is running is possible (with a small delay)
+//Unattended-Upgrade::MinimalSteps "true";
+
+// Install all updates when the machine is shutting down
+// instead of doing it in the background while the machine is running.
+// This will (obviously) make shutdown slower.
+// Unattended-upgrades increases logind's InhibitDelayMaxSec to 30s.
+// This allows more time for unattended-upgrades to shut down gracefully
+// or even install a few packages in InstallOnShutdown mode, but is still a
+// big step back from the 30 minutes allowed for InstallOnShutdown previously.
+// Users enabling InstallOnShutdown mode are advised to increase
+// InhibitDelayMaxSec even further, possibly to 30 minutes.
+//Unattended-Upgrade::InstallOnShutdown "false";
+
+// Send email to this address for problems or packages upgrades
+// If empty or unset then no email is sent, make sure that you
+// have a working mail setup on your system. A package that provides
+// 'mailx' must be installed. E.g. "user@example.com"
+//Unattended-Upgrade::Mail "";
+
+// Set this value to one of:
+//    "always", "only-on-error" or "on-change"
+// If this is not set, then any legacy MailOnlyOnError (boolean) value
+// is used to chose between "only-on-error" and "on-change"
+//Unattended-Upgrade::MailReport "on-change";
+
+// Remove unused automatically installed kernel-related packages
+// (kernel images, kernel headers and kernel version locked tools).
+//Unattended-Upgrade::Remove-Unused-Kernel-Packages "true";
+
+// Do automatic removal of newly unused dependencies after the upgrade
+//Unattended-Upgrade::Remove-New-Unused-Dependencies "true";
+
+// Do automatic removal of unused packages after the upgrade
+// (equivalent to apt-get autoremove)
+//Unattended-Upgrade::Remove-Unused-Dependencies "false";
+
+// Automatically reboot *WITHOUT CONFIRMATION* if
+//  the file /var/run/reboot-required is found after the upgrade
+//Unattended-Upgrade::Automatic-Reboot "false";
+
+// Automatically reboot even if there are users currently logged in
+// when Unattended-Upgrade::Automatic-Reboot is set to true
+//Unattended-Upgrade::Automatic-Reboot-WithUsers "true";
+
+// If automatic reboot is enabled and needed, reboot at the specific
+// time instead of immediately
+//  Default: "now"
+//Unattended-Upgrade::Automatic-Reboot-Time "02:00";
+
+// Use apt bandwidth limit feature, this example limits the download
+// speed to 70kb/sec
+//Acquire::http::Dl-Limit "70";
+
+// Enable logging to syslog. Default is False
+// Unattended-Upgrade::SyslogEnable "false";
+
+// Specify syslog facility. Default is daemon
+// Unattended-Upgrade::SyslogFacility "daemon";
+
+// Download and install upgrades only on AC power
+// (i.e. skip or gracefully stop updates on battery)
+// Unattended-Upgrade::OnlyOnACPower "true";
+
+// Download and install upgrades only on non-metered connection
+// (i.e. skip or gracefully stop updates on a metered connection)
+// Unattended-Upgrade::Skip-Updates-On-Metered-Connections "true";
+
+// Verbose logging
+// Unattended-Upgrade::Verbose "false";
+
+// Print debugging information both in unattended-upgrades and
+// in unattended-upgrade-shutdown
+// Unattended-Upgrade::Debug "false";
+
+// Allow package downgrade if Pin-Priority exceeds 1000
+// Unattended-Upgrade::Allow-downgrade "false";
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.003313277 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238371r654288_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238371r654288_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238371r654288_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must use a file integrity tool to verify correct operation of all security functions.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without verification of the security functions, security functions may not operate correctly and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.

This requirement applies to the Ubuntu operating system performing security function verification/testing and/or systems and environments that require this functionality.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-002696</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "SI-6 a"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238371r654288_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238371r654288_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238371r654288_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238371r654288_rule" do
  title "The Ubuntu operating system must use a file integrity tool to verify correct operation of all security functions."
  desc  "
    Vulnerability Discussion: Without verification of the security functions, security functions may not operate correctly and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.
    
    This requirement applies to the Ubuntu operating system performing security function verification/testing and/or systems and environments that require this functionality.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-002696"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "SI-6 a"]
  describe package("aide") do
    it { should be_installed }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-System_Package_aide">
  <h4 class="resource-title">Resource <code>System Package aide</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected to be installed</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected that `System Package aide` is installed</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.05997905 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-238373r654294_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-238373r654294_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-238373r654294_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must display the date and time of the last successful account logon upon logon.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Configuration settings are the set of parameters that can be changed in hardware, software, or firmware components of the system that affect the security posture and/or functionality of the system. Security-related parameters are those parameters impacting the security state of the system, including the parameters required to satisfy other security control requirements. Security-related parameters include, for example: registry settings; account, file, directory permission settings; and settings for functions, ports, protocols, services, and remote connections.

Documentable: false</td></tr> 
    <tr class="impact impact-low"><th>Impact:</th><td>0.1</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-000366</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "CM-6 b"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238373r654294_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238373r654294_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-238373r654294_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-238373r654294_rule" do
  title "The Ubuntu operating system must display the date and time of the last successful account logon upon logon."
  desc  "
    Vulnerability Discussion: Configuration settings are the set of parameters that can be changed in hardware, software, or firmware components of the system that affect the security posture and/or functionality of the system. Security-related parameters are those parameters impacting the security state of the system, including the parameters required to satisfy other security control requirements. Security-related parameters include, for example: registry settings; account, file, directory permission settings; and settings for functions, ports, protocols, services, and remote connections.
    
    Documentable: false
    
  "
  impact 0.1
  tag cci: "CCI-000366"
  tag nist: ["NIST SP 800-53", "3", "CM-6 b"]
  tag nist: ["NIST SP 800-53A", "1", "CM-6.1 (iv)"]
  tag nist: ["NIST SP 800-53 Revision 4", "4", "CM-6 b"]
  describe file("/etc/pam.d/login") do
    its("content") { should match(/^\s*session\s+required\s+pam_lastlog\.so\s+(?:\w+\s+)*showfailed\b\s*(?:\w+\b\s*)*\s*(?:#.*)?$/) }
  end
  describe file("/etc/pam.d/login") do
    its("content") { should_not match(/^\s*session\s+required\s+pam_lastlog\.so\s+(?:\w+\s+)*silent\b\s*(?:\w+\b\s*)*\s*(?:#.*)?$/) }
  end
end

          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-File__etc_pam_d_login">
  <h4 class="resource-title">Resource <code>File /etc/pam.d/login</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected to match /^\s*session\s+required\s+pam_lastlog\.so\s+(?:\w+\s+)*showfailed\b\s*(?:\w+\b\s*)*\s*(?:#.*)?$/</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected "#\n# The PAM configuration file for the Shadow `login' service\n#\n\n# Enforce a minimal delay in ca...x account and session\n@include common-account\n@include common-session\n@include common-password\n" to match /^\s*session\s+required\s+pam_lastlog\.so\s+(?:\w+\s+)*showfailed\b\s*(?:\w+\b\s*)*\s*(?:#.*)?$/
Diff:
@@ -1,2 +1,101 @@
-/^\s*session\s+required\s+pam_lastlog\.so\s+(?:\w+\s+)*showfailed\b\s*(?:\w+\b\s*)*\s*(?:#.*)?$/
+#
+# The PAM configuration file for the Shadow `login' service
+#
+
+# Enforce a minimal delay in case of failure (in microseconds).
+# (Replaces the `FAIL_DELAY' setting from login.defs)
+# Note that other modules may require another minimal delay. (for example,
+# to disable any delay, you should add the nodelay option to pam_unix)
+auth       optional   pam_faildelay.so  delay=3000000
+
+# Outputs an issue file prior to each login prompt (Replaces the
+# ISSUE_FILE option from login.defs). Uncomment for use
+# auth       required   pam_issue.so issue=/etc/issue
+
+# Disallows other than root logins when /etc/nologin exists
+# (Replaces the `NOLOGINS_FILE' option from login.defs)
+auth       requisite  pam_nologin.so
+
+# SELinux needs to be the first session rule. This ensures that any
+# lingering context has been cleared. Without this it is possible
+# that a module could execute code in the wrong domain.
+# When the module is present, "required" would be sufficient (When SELinux
+# is disabled, this returns success.)
+session [success=ok ignore=ignore module_unknown=ignore default=bad] pam_selinux.so close
+
+# Sets the loginuid process attribute
+session    required     pam_loginuid.so
+
+# Prints the message of the day upon successful login.
+# (Replaces the `MOTD_FILE' option in login.defs)
+# This includes a dynamically generated part from /run/motd.dynamic
+# and a static (admin-editable) part from /etc/motd.
+session    optional   pam_motd.so motd=/run/motd.dynamic
+session    optional   pam_motd.so noupdate
+
+# SELinux needs to intervene at login time to ensure that the process
+# starts in the proper default security context. Only sessions which are
+# intended to run in the user's context should be run after this.
+# pam_selinux.so changes the SELinux context of the used TTY and configures
+# SELinux in order to transition to the user context with the next execve()
+# call.
+session [success=ok ignore=ignore module_unknown=ignore default=bad] pam_selinux.so open
+# When the module is present, "required" would be sufficient (When SELinux
+# is disabled, this returns success.)
+
+# This module parses environment configuration file(s)
+# and also allows you to use an extended config
+# file /etc/security/pam_env.conf.
+# 
+# parsing /etc/environment needs "readenv=1"
+session       required   pam_env.so readenv=1
+# locale variables are also kept into /etc/default/locale in etch
+# reading this file *in addition to /etc/environment* does not hurt
+session       required   pam_env.so readenv=1 envfile=/etc/default/locale
+
+# Standard Un*x authentication.
+@include common-auth
+
+# This allows certain extra groups to be granted to a user
+# based on things like time of day, tty, service, and user.
+# Please edit /etc/security/group.conf to fit your needs
+# (Replaces the `CONSOLE_GROUPS' option in login.defs)
+auth       optional   pam_group.so
+
+# Uncomment and edit /etc/security/time.conf if you need to set
+# time restraint on logins.
+# (Replaces the `PORTTIME_CHECKS_ENAB' option from login.defs
+# as well as /etc/porttime)
+# account    requisite  pam_time.so
+
+# Uncomment and edit /etc/security/access.conf if you need to
+# set access limits.
+# (Replaces /etc/login.access file)
+# account  required       pam_access.so
+
+# Sets up user limits according to /etc/security/limits.conf
+# (Replaces the use of /etc/limits in old login)
+session    required   pam_limits.so
+
+# Prints the last login info upon successful login
+# (Replaces the `LASTLOG_ENAB' option from login.defs)
+session    optional   pam_lastlog.so
+
+# Prints the status of the user's mailbox upon successful login
+# (Replaces the `MAIL_CHECK_ENAB' option from login.defs). 
+#
+# This also defines the MAIL environment variable
+# However, userdel also needs MAIL_DIR and MAIL_FILE variables
+# in /etc/login.defs to make sure that removing a user 
+# also removes the user's mail spool file.
+# See comments in /etc/login.defs
+session    optional   pam_mail.so standard
+
+# Create a new session keyring.
+session    optional   pam_keyinit.so force revoke
+
+# Standard Un*x account and session
+@include common-account
+@include common-session
+@include common-password
</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.016301909 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-File__etc_pam_d_login">
  <h4 class="resource-title">Resource <code>File /etc/pam.d/login</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>content is expected not to match /^\s*session\s+required\s+pam_lastlog\.so\s+(?:\w+\s+)*silent\b\s*(?:\w+\b\s*)*\s*(?:#.*)?$/</code></td></tr>
    <tr class="status status-passed"><th>Status:</th><td><div>Passed</div></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.00061177 seconds</td></tr>
  </table>
</div>

  

</div>

    
      



<div class="control control-status-failed" id="profile-stig_canonicalubuntu20_04lts_cationly-control-xccdf_mil.disa.stig_rule_SV-251505r808512_rule">

  

  <h3 class="control-title">Control <code>xccdf_mil.disa.stig_rule_SV-251505r808512_rule</code></h3>
  <table class="control-metadata info" id="profile-stig_canonicalubuntu20_04lts_cationly-control-metadata-xccdf_mil.disa.stig_rule_SV-251505r808512_rule">
  <caption>Control Table</caption>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    <tr class="title"><th>Title:</th><td>The Ubuntu operating system must disable automatic mounting of Universal Serial Bus (USB) mass storage driver.</td></tr> 
    <tr class="desc"><th>Description:</th><td>Vulnerability Discussion: Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity.

Peripherals include, but are not limited to, such devices as flash drives, external storage, and printers.

Documentable: false</td></tr> 
    <tr class="impact impact-medium"><th>Impact:</th><td>0.5</td></tr> 
    
      <tr class="tags">
        <th>Tags:</th>
        <td>
          <table class="tags">
          <caption>Tag Table</caption>
            <tr><th>Tag Name</th><th>Tag Text</th></tr>
            
              <tr><td>cci</td><td>CCI-001958</td></tr>
            
              <tr><td>nist</td><td>["NIST SP 800-53 Revision 4", "4", "IA-3"]</td></tr>
            
          </table>
        </td>
      </tr>
    
    
    <tr class="code">
      <th>Source Code:</th>
      <td>
        <input type="button" class="show-source-code" id="show-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-251505r808512_rule" value="Show Source"/>
        <input type="button" class="hide-source-code hidden" id="hide-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-251505r808512_rule" value="Hide Source"/>
        <pre class="source-code hidden" id="source-code-stig_canonicalubuntu20_04lts_cationly-xccdf_mil.disa.stig_rule_SV-251505r808512_rule">
          <code>
control "xccdf_mil.disa.stig_rule_SV-251505r808512_rule" do
  title "The Ubuntu operating system must disable automatic mounting of Universal Serial Bus (USB) mass storage driver."
  desc  "
    Vulnerability Discussion: Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity.
    
    Peripherals include, but are not limited to, such devices as flash drives, external storage, and printers.
    
    Documentable: false
    
  "
  impact 0.5
  tag cci: "CCI-001958"
  tag nist: ["NIST SP 800-53 Revision 4", "4", "IA-3"]
  files = command("find /etc/modprobe.d -type f -regex .\\*/.\\*").stdout.split
  describe files.delete_if { |f| command("file #{f} | cut -d: -f2").stdout =~ /binary|executable|archive/ || file(f).content !~ /^[ \t]*install[ \t]+usb-storage[ \t]+\/bin\/true[ \t]*$/ } do
    it { should_not be_empty }
  end
  files = command("find /etc/modprobe.d -type f -regex .\\*/.\\*").stdout.split
  describe files.delete_if { |f| command("file #{f} | cut -d: -f2").stdout =~ /binary|executable|archive/ || file(f).content !~ /^[ \t]*blacklist[ \t]+usb-storage[ \t]*$/ } do
    it { should_not be_empty }
  end
end
          </code>
        </pre>
      </td>
    </tr>
  <!-- TODO waiver data -->

  </table>

  
    
<div class="result" id="result-__">
  <h4 class="resource-title">Resource <code>[]</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be empty</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected `[].empty?` to be falsey, got true</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.007363144 seconds</td></tr>
  </table>
</div>

  
    
<div class="result" id="result-__">
  <h4 class="resource-title">Resource <code>[]</code></h4>
  <table class="result-metadata info">
  <caption>Result Information Table</caption>
    <tr class="expectation_message"><th>Test:</th><td><code>is expected not to be empty</code></td></tr>
    <tr class="status status-failed"><th>Status:</th><td><div>Failed</div></td></tr>
    
    <tr class="fail_message"><th>Failure Message:</th><td><code>expected `[].empty?` to be falsey, got true</code></td></tr>
    
    
    <tr class="duration"><th>Duration:</th><td>0.004523884 seconds</td></tr>
  </table>
</div>

  

</div>

    
  
</div>

    

    <div class="inspec-summary">
      <table id="platform" class="info">
      <caption>Platform Information</caption>
        <tr><th colspan=2><h4 id="platform-label">Platform Information</h4></th></tr>
        <tr class= "name"><th>Name:</th><td>ubuntu</td></tr>
        <tr class= "release"><th>Release:</th><td>20.04</td></tr>
        <tr class= "target"><th>Target:</th><td>ssh://chef@node1:22</td></tr>
      </table>
      <table id="statistics" class="info">
      <caption>Control Statistics</caption>
        <tr><th colspan="2"><h4 id="statistics-label">Control Statistics</h4></th></tr>
        <tr class= "passed"><th>Passed:</th><td>12</td></tr>
        <tr class= "failed"><th>Failed:</th><td>83</td></tr>
        
          <tr class= "skipped"><th>Skipped:</th><td>3</td></tr>
        
        <tr class= "duration"><th>Duration:</th><td>1.324606027 seconds</td></tr>
        <tr class= "date"><th>Time Finished:</th><td>2024-05-09 08:31:11 -0700</td></tr>
      </table>
      <span id="inspec-version">Chef InSpec version 5.22.40</span>
    </div>
    </div>
  </body>
</html>

